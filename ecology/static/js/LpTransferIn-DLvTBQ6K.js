import{d as Xe,p as Ge,r as m,a as He,c as d,an as e,I as ce,o as Ke,b as N,g as t,A as L,i as $,f as F,t as o,j as i,H as Je,n as P,w as T,ak as de,G,B as Qe,u as Ze,ao as O,a8 as M,ac as fe,a4 as pe,a0 as f,al as me,am as Me,aj as z,k as et,e as p,m as tt}from"./index-D1IDHpEr.js";import{_ as at}from"./EmptyTipsPop-BS8DZkCG.js";import{_ as lt}from"./BackIcon-BQamH_1r.js";import{N as Ie}from"./NumberKeyBoardInput-BmdRMuQP.js";import{b as st}from"./beiConstContract-LmXBgzZV.js";import{u as nt}from"./useLpData-BQWkjvjc.js";import{u as Y}from"./index-REhnXf1k.js";import"./use-placeholder-CFklVtWZ.js";/* empty css                                                                 */const ot={class:"px-3 bg-[#f2f0ef] text-[#2E2008] font-normal relative pb-[152px]"},it={class:"gap-2 pt-2 flex items-center"},ut={class:"text-sm text-black"},rt={class:"bg-white mt-2.5 pb-4 px-4 rounded-xl"},vt={class:"flex flex-col gap-1.5 items-center py-7 border-b border-solid border-[#000]/10 mb-4"},ct={class:"text-sm text-black opacity-60"},dt={key:1,class:"text-3xl font-semibold"},ft={class:"w-full pb-[17px]"},pt={class:"w-full h-[40px] bg-[#F5F5F5] rounded-[50px] p-[2px] overflow-hidden"},mt={class:"w-full h-full relative"},Mt={class:"w-full h-full flex items-center justify-center absolute left-0 top-0 gap-[4px]"},It={class:"flex items-center justify-between"},_t={class:"text-sm"},gt={class:"flex items-center text-xs"},xt={class:"opacity-60"},At={key:1},Nt={class:"bg-[#FFF8EC] rounded-xl p-2.5 mt-2 flex justify-between items-center w-full relative"},bt={class:"flex flex-shrink-0 items-center relative"},Ot=["src"],ht={class:"flex-1"},wt={class:"text-right opacity-60 text-xs"},Ct={key:0,class:"opacity-60 text-xs mt-3"},yt=["src"],Lt={key:2,class:"mt-1 text-xs text-b3 font-normal"},kt={class:"flex items-center justify-between"},Wt={class:"text-sm"},St={class:"flex items-center text-xs"},Ft={class:"opacity-60"},Yt={key:1},$t={class:"bg-[#FFF8EC] rounded-xl p-2.5 mt-2 flex justify-between items-center w-full relative"},Tt={class:"flex items-center relative flex-shrink-0"},jt=["src"],Vt={class:"flex-1"},Et={class:"text-right opacity-60 text-xs"},Pt={key:0,class:"mt-1 text-xs text-b3 font-normal"},zt={class:"bg-[#F9F9F9] px-3 py-3 pb-1 mt-3 rounded-lg"},Bt={class:"flex items-center justify-between text-sm"},Dt={class:"opacity-60"},Rt={class:"flex items-center justify-between mt-4 text-sm"},qt={class:"opacity-60"},Ut={class:"flex items-center justify-between mt-2 text-sm"},Xt={class:"opacity-60"},Gt={class:"flex items-center"},Ht={class:"flex items-center"},Kt={key:1},Jt=["src"],Qt=["src"],Zt={class:"fixed left-0 right-0 bottom-0 bg-[#F2F0EF] p-4 opacity-100"},ea={class:"w-full flex justify-between items-center gap-3"},ta={class:"text-[#2E2008] text-base font-normal"},aa={class:"text-[#2E2008] text-base"},la={class:"text-[#2E2008] text-base font-semibold"},sa=Xe({__name:"LpTransferIn",setup(na){const{pointRate:_e}=Ge(),{depositForPancake:ge,depositOnlyMc:xe,depositOnlyMai:Ae,userTotalLp:Ne,pendingLp:be}=st(),{flowValue:_,refreshFlowValue:B,lpSupply:D,flowValueLoading:Oe}=nt(),H=m(1),I=m(null),c=m(null),[he,K]=Y(!1),u=m({MAI:null,WMAI:null,MCOIN:null}),h=m({MAI:null,MCOIN:null,WMAI:null}),{t:j}=He(),[we,R]=Y(!1),J=m(j("ling-qu-cheng-gong")),Q=Ze(),l=m(1),w=m(null),s={MAI_MCOIN:1,ONLY_MCOIN:2,ONLY_MAI:3},v=m(null),r=m(null),Z=m(null),ee=m(null),Ce=d(()=>{if(l.value===s.MAI_MCOIN)return+I.value<=0||+c.value<=0;if(l.value===s.ONLY_MCOIN)return+I.value<=0;if(l.value===s.ONLY_MAI)return+c.value<=0}),q=a=>{w.value=l.value,l.value=a},ye=async()=>{K(!0),B(),setTimeout(()=>{K(!1)},800)},C=d(()=>e(u.value.MAI).plus(u.value.WMAI).toString()),Le=d(()=>{if(l.value===s.MAI_MCOIN){const a=e(v.value).div(_.value.poolWmai).gt(e(r.value).div(_.value.poolMcoin))?e(r.value).div(_.value.poolMcoin).toString():e(v.value).div(_.value.poolWmai).toString();return e(a).times(D.value).toString()}else if(l.value===s.ONLY_MCOIN){const a=e(v.value).div(_.value.poolWmai).gt(e(r.value).div(_.value.poolMcoin))?e(r.value).div(_.value.poolMcoin).toString():e(v.value).div(_.value.poolWmai).toString();return e(a).times(D.value).div(2).toString()}else if(l.value===s.ONLY_MAI){const a=e(v.value).toString(),n=7/17;return e(a).times(n).div(_.value.poolWmai).times(D.value)}}),V=d(()=>(B(),e(v.value).times(_.value.mcoinPrice).toString()));ce(()=>r.value,a=>{r.value==="0"&&(r.value="",I.value=""),Z.value.show&&(v.value=f(E.value,4)+"",c.value=E.value,I.value=a)}),ce(()=>v.value,a=>{v.value==="0"&&(v.value="",c.value=""),ee.value.show&&(r.value=f(V.value,4)+"",I.value=V.value,c.value=a)});const E=d(()=>{B();const a=e(H.value).div(_.value.mcoinPrice).toString();return e(r.value).times(a).toString()}),ke=d(()=>{if(l.value===s.MAI_MCOIN)return e(r.value).div(y.value).times(2).toString();if(l.value===s.ONLY_MCOIN)return e(r.value).div(y.value).toString();if(l.value===s.ONLY_MAI)return e(r.value).div(y.value).times(.8235294117647058).toString()}),te=d(()=>{if(l.value===s.MAI_MCOIN)return e(r.value).div(y.value).toString();if(l.value===s.ONLY_MCOIN)return e(r.value).div(y.value).toString();if(l.value===s.ONLY_MAI)return e(r.value).div(y.value).times(.8235294117647058).toString()}),ae=a=>{if(a==="WMAI"){const n=e(u.value.MAI).plus(u.value.WMAI).toString();v.value=f(n,4)+"",c.value=n,r.value=f(V.value,4)+"",I.value=V.value}else r.value=f(u.value.MCOIN,4)+"",I.value=u.value.MCOIN,v.value=f(E.value,4)+"",c.value=E.value},We=a=>{Q.push(a)},Se=async()=>{x(!0);const a=e(c.value).toFixed(18),n=e(I.value).toFixed(18);try{let b=null;l.value===s.MAI_MCOIN?b=await ge(a,n):l.value===s.ONLY_MCOIN?b=await xe(n):l.value===s.ONLY_MAI&&(b=await Ae(a)),b.success&&(J.value=j("zhiya-cheng-gong"),R(!0),r.value=null,v.value=null,setTimeout(()=>{R(!1),Q.back()},2e3)),ve()}finally{x(!1)}},U=async(a="MAI")=>{const n=await(await O(M[a])).balanceOf();u.value[a]=e(n).toString()},[le,x]=Y(!1),y=m(null),[se,ne]=Y(!1),Fe=async()=>{y.value=e(await _e()).toString()},k=d(()=>{const a=I.value;return e(h.value.MCOIN)>e(0)&&+e(h.value.MCOIN)>=+e(a??0)||e(a)<=e(0)}),W=d(()=>{if(e(u.value.WMAI)==e(0)||!v.value)return!0;const a=e(u.value.WMAI)>=e(c.value)?c.value:u.value.WMAI;return e(h.value.WMAI)>e(0)&&+e(h.value.WMAI)>=+e(a??0)||e(a)<=e(0)}),S=d(()=>{if(!v.value)return!0;const a=e(u.value.WMAI)>e(0)?e(c.value).minus(u.value.WMAI).toString():c.value;return e(h.value.MAI)>e(0)&&+e(h.value.MAI)>=+e(a??0)||e(a)<=e(0)}),A=async a=>{h.value[a]=e(await(await O(M[a]).allowance(M.bei)).result).toString()},Ye=d(()=>{if(l.value===s.MAI_MCOIN){if(e(u.value.WMAI)>e(0)&&!W.value)return"WMAI";if(!S.value)return"MAI";if(!k.value)return"MCOIN"}else if(l.value===s.ONLY_MCOIN){if(!k.value)return"MCOIN"}else if(l.value===s.ONLY_MAI){if(e(u.value.WMAI)>e(0)&&!W.value)return"WMAI";if(!S.value)return"MAI"}}),$e=async()=>{if(x(!0),l.value===s.MAI_MCOIN){if(e(u.value.WMAI)>e(0)&&!W.value){await O(M.WMAI).approve(M.bei),await A("WMAI"),x(!1);return}if(!S.value){await O(M.MAI).approve(M.bei),await A("MAI"),x(!1);return}if(!k.value){await O(M.MCOIN).approve(M.bei),await A("MCOIN"),x(!1);return}}else if(l.value===s.ONLY_MCOIN)if(k.value){x(!1);return}else{await O(M.MCOIN).approve(M.bei),await A("MCOIN"),x(!1);return}else if(l.value===s.ONLY_MAI){if(e(u.value.WMAI)>e(0)&&!W.value){await O(M.WMAI).approve(M.bei),await A("WMAI"),x(!1);return}if(!S.value){await O(M.MAI).approve(M.bei),await A("MAI"),x(!1);return}}},[Te,oe]=Y(!0),ie=m(null),je=async()=>{oe(!0);const{success:a,result:n}=await Ne();a&&(ie.value=fe(n).toString(),oe(!1))},Ve=d(()=>e(ie.value).toString()),Ee=d(()=>Pe.value||Te.value),[Pe,ue]=Y(!0),ze=m(null),Be=async()=>{ue(!0);const{success:a,result:n}=await be();a&&(ze.value=fe(n).toString(),ue(!1))},re=d(()=>{if(l.value===s.MAI_MCOIN)return W.value&&S.value&&k.value;if(l.value===s.ONLY_MCOIN)return k.value;if(l.value===s.ONLY_MAI)return W.value&&S.value}),ve=async()=>{ne(!0),je(),Be(),Fe(),await Promise.all([U(),U("WMAI"),U("MCOIN"),A("WMAI"),A("MCOIN"),A("MAI")]),ne(!1)};Ke(()=>{ve()});const De=d(()=>{if(l.value===s.MAI_MCOIN)return+u.value.MCOIN<+I.value||+C.value<+c.value;if(l.value===s.ONLY_MCOIN)return+u.value.MCOIN<+I.value;if(l.value===s.ONLY_MAI)return+C.value<+c.value}),Re=d(()=>{if(l.value===s.MAI_MCOIN)return+u.value.MCOIN<+I.value?"Mcoin":+C.value<+c.value?"Mai":"";if(l.value===s.ONLY_MCOIN)return+u.value.MCOIN<+I.value?"Mcoin":"";if(l.value===s.ONLY_MAI)return+C.value<+c.value?"Mai":""});return(a,n)=>{const b=pe,qe=pe,Ue=at,X=Qe;return p(),N("div",ot,[t("div",it,[F(lt),t("div",ut,o(a.$t("zhuan-ru"))+"LP",1)]),t("div",rt,[t("div",vt,[t("div",ct,o(a.$t("zai-cun-lp-shu-liang-0")),1),Ee.value?(p(),L(b,{key:0,color:"#000",size:"1.5rem"})):(p(),N("div",dt,o(i(f)(Ve.value,4)),1))]),t("div",ft,[t("div",pt,[t("div",mt,[t("div",{class:"selected-tab w-[calc((100%-4px*2)/3)] h-full bg-[#212121] rounded-[50px] absolute left-0 transition-all duration-300",style:Je(`left: calc((100% - 4px * 2) * ${l.value-1} / 3 + ${l.value-1} * 4px)`)},null,4),t("div",Mt,[t("div",{class:"w-1/3 h-full flex items-center justify-center overflow-hidden",onClick:n[0]||(n[0]=g=>q(1))},[t("span",{class:P(["text-sm line-clamp-1 transition-all duration-300",[l.value===s.MAI_MCOIN?"text-b6 font-semibold":"text-b3 font-normal"]])},"MAI+MC",2)]),t("div",{class:"w-1/3 h-full flex items-center justify-center overflow-hidden",onClick:n[1]||(n[1]=g=>q(2))},[t("span",{class:P(["text-sm line-clamp-1 transition-all duration-300",[l.value===s.ONLY_MCOIN?"text-b6 font-semibold":"text-b3 font-normal"]])},o(i(j)("only-mcoin")),3)]),t("div",{class:"w-1/3 h-full flex items-center justify-center overflow-hidden",onClick:n[2]||(n[2]=g=>q(3))},[t("span",{class:P(["text-sm line-clamp-1 transition-all duration-300",[l.value===s.ONLY_MAI?"text-b6 font-semibold":"text-b3 font-normal"]])},o(i(j)("only-mai")),3)])])])])]),F(de,{name:!w.value||w.value===s.MAI_MCOIN&&l.value===s.ONLY_MCOIN||w.value===s.ONLY_MCOIN&&l.value===s.MAI_MCOIN?"fade":"",mode:"out-in"},{default:T(()=>[me(t("div",null,[t("div",It,[t("div",_t,o(a.$t("zhuan-ru-mai-jin-e")),1),t("div",gt,[t("span",xt,[G(o(a.$t("yu-e"))+"： ",1),i(se)?(p(),L(b,{key:0,size:"12"})):(p(),N("span",At,o(i(f)(C.value))+" MAI&WMAI",1))]),t("div",{class:"ml-2 px-1.5 py-0.5 border-[1px] border-[#FEA021] border-solid rounded text-xs text-[#FEA021] font-medium",onClick:n[3]||(n[3]=g=>ae("WMAI"))}," MAX ")])]),t("div",Nt,[t("div",bt,[t("img",{class:"rounded-full flex-shrink-0 w-6 h-6",src:i(z)("images/tokens/MAI.png"),alt:"",srcset:""},null,8,Ot),n[10]||(n[10]=t("div",{class:"absolute top-0.5 left-7 right-0 bottom-0 font-bold"}," MAI ",-1))]),t("div",ht,[F(Ie,{ref_key:"wmaiInputRef",ref:ee,modelValue:v.value,"onUpdate:modelValue":n[4]||(n[4]=g=>v.value=g),class:"bg-[#FFF8EC] text-lg font-bold text-[#2E2008] text-right",placeholder:"0",classStyle:"text-right w-full",reg:/^\d+(\.\d{0,4})?$/,max:C.value&&i(f)(C.value,4)},null,8,["modelValue","max"]),t("div",wt," ~$"+o(i(f)(te.value)),1)])]),l.value===s.MAI_MCOIN?(p(),N("div",Ct,o(a.$t("transfer-in-lp-tips")),1)):$("",!0),l.value===s.MAI_MCOIN?(p(),N("img",{key:1,src:i(z)("images/maiPledge/add-t.svg"),class:"w-10 h-10 mx-auto mt-3 mb-5"},null,8,yt)):$("",!0),l.value===s.ONLY_MAI?(p(),N("div",Lt,o(a.$t("lpOnlyMaiTips")),1)):$("",!0)],512),[[Me,l.value===s.MAI_MCOIN||l.value===s.ONLY_MAI]])]),_:1},8,["name"]),F(de,{name:!w.value||w.value===s.MAI_MCOIN&&l.value===s.ONLY_MAI||w.value===s.ONLY_MAI&&l.value===s.MAI_MCOIN?"fade":"",mode:"out-in"},{default:T(()=>[me(t("div",null,[t("div",kt,[t("div",Wt,o(a.$t("zhuan-ru-mcoin-jin-e")),1),t("div",St,[t("span",Ft,[G(o(a.$t("balance"))+"： ",1),i(se)?(p(),L(b,{key:0,size:"12"})):(p(),N("span",Yt,o(i(f)(u.value.MCOIN))+"MCOIN",1))]),t("div",{class:"ml-2 px-1.5 py-0.5 border-[1px] border-[#FEA021] border-solid rounded text-xs text-[#FEA021] font-medium",onClick:n[5]||(n[5]=g=>ae("MCOIN"))}," MAX ")])]),t("div",$t,[t("div",Tt,[t("img",{class:"rounded-full w-6 h-6 flex-shrink-0",src:i(z)("images/tokens/MCOIN.png"),alt:"",srcset:""},null,8,jt),n[11]||(n[11]=t("span",{class:"absolute top-0.5 left-7 right-0 bottom-0 font-bold"},"Mcoin",-1))]),t("div",Vt,[F(Ie,{ref_key:"mcInputRef",ref:Z,modelValue:r.value,"onUpdate:modelValue":n[6]||(n[6]=g=>r.value=g),"class-style":"text-right w-full",class:"bg-[#FFF8EC] text-lg font-bold text-[#2E2008]",placeholder:"0",reg:/^\d+(\.\d{0,4})?$/,max:u.value.MCOIN&&i(f)(u.value.MCOIN,4)},null,8,["modelValue","max"]),t("div",Et," ~$"+o(i(f)(te.value,4)),1)])]),l.value===s.ONLY_MCOIN?(p(),N("div",Pt,o(a.$t("lpOnlyMcTips")),1)):$("",!0)],512),[[Me,l.value===s.MAI_MCOIN||l.value===s.ONLY_MCOIN]])]),_:1},8,["name"]),t("div",zt,[t("div",Bt,[t("div",Dt,o(a.$t("dang-qian-zhuan-ru-jia-zhi-cang-wei")),1),t("div",null,o(i(f)(ke.value))+"$",1)]),t("div",Rt,[t("div",qt,o(a.$t("yu-ji-lp-shu-liang")),1),t("div",null,o(i(f)(Le.value,4)),1)]),t("div",Ut,[t("div",Xt,o(a.$t("jia-ge")),1),t("div",Gt,[t("div",Ht,[G(o(H.value)+"Wmai ≈ ",1),i(Oe)?(p(),L(qe,{key:0,size:"14"})):(p(),N("span",Kt,o(i(f)(i(_).mcoinPrice,4))+"Mcoin ",1))]),t("div",{onClick:ye},[t("img",{src:i(et)("refresh.svg"),class:P(["w-4 mx-2",{"animate-spin":i(he)}]),alt:""},null,10,Jt)]),t("img",{class:"rounded-full w-[40px]",src:i(z)("images/tokens/LP.png"),alt:"",srcset:""},null,8,Qt)])])])]),i(we)?(p(),L(Ue,{key:0,text:J.value,onClose:n[7]||(n[7]=g=>i(R)(!1))},null,8,["text"])):$("",!0),n[12]||(n[12]=t("div",{class:"text-base text-center opacity-60 z-20 py-5 underline"},null,-1)),t("div",Zt,[t("div",ea,[F(X,{class:"btn white-btn bg-white w-full h-[50px]",onClick:n[8]||(n[8]=g=>We("/lp-fundDetails?type=1"))},{default:T(()=>[t("span",ta,o(a.$t("zhuan-ru-ji-lu")),1)]),_:1}),De.value?(p(),L(X,{key:0,class:"btn w-full h-[50px] opacity-100",loading:i(le),disabled:!0},{default:T(()=>[t("span",aa,o(Re.value)+o(a.$t("yuebu-zu")),1)]),_:1},8,["loading"])):(p(),L(X,{key:1,class:"btn w-full h-[50px]",loading:i(le),disabled:Ce.value,onClick:n[9]||(n[9]=g=>re.value?Se():$e())},{default:T(()=>[t("span",la,o(re.value?a.$t("que-ren-zhuan-ru"):a.$t("shou-quan")+Ye.value),1)]),_:1},8,["loading","disabled"]))])])])}}}),ma=tt(sa,[["__scopeId","data-v-fe50f02e"]]);export{ma as default};
