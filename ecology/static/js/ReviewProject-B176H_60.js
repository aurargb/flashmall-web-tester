import{d as k,p as j,u as P,a as D,s as I,r as W,c as F,o as G,b as x,e as g,f as n,w as f,g as i,y as O,z as N,F as U,h as q,A,B as E,j as c,t as J,R as K,C as M,m as H}from"./index-DqZw0EDK.js";import{L as Q}from"./index-Bzywb4Nz.js";import{_ as X}from"./search-Cs0epEsK.js";import{_ as Y}from"./CommonVanProvider.vue_vue_type_script_setup_true_lang-oA-aDWMj.js";import{S as Z,G as ee}from"./SortBox-BreH13Fx.js";import{_ as te}from"./CapItem.vue_vue_type_script_setup_true_lang-2Wz1t_cG.js";import{a as b}from"./guarantee-BZjryzuD.js";import{G as C}from"./guarantee-BhLJfceW.js";import{u as se}from"./index-BblTMty9.js";import"./index-GfLTIcC5.js";import"./use-placeholder-Bi-uQ-dr.js";import"./BackIcon-C1C-V4Fq.js";/* empty css                                                                 */import"./CommonPop.vue_vue_type_script_setup_true_lang-Bhjs6e-4.js";import"./member-wzMSw2ZB.js";const oe={class:"font-normal bg-gray1"},ae={class:"px-3 pt-3 sticky top-[50px] rounded-t-xl z-10 bg-gray1"},ne={class:"flex-1"},ie={class:"px-3 min-h-[66vh] pb-20"},re={class:"fixed left-0 right-0 m-auto w-full sm:w-[375px] justify-center flex items-center bottom-9 z-50 gap-3 px-3"},le={class:"text-black whitespace-nowrap"},de=k({name:"ReviewProject"}),ce=k({...de,setup(pe){const[L,h]=se(!1),{memberLevels:T}=j(),$=P(),{t:y}=D(),e=I({keyWord:"",page:0,size:10,finished:!1,list:[],loading:!1,total:0,sortType:1}),r=W({}),S=async s=>{if(await T()<4)return M(y("deng-ji-bu-zu"));r.value=s,h(!0)},B=F(()=>[{name:y("fa-qi-shi-jian"),asc:1,desc:2}]),z=s=>{e.sortType!==s&&(e.sortType=s,l())},l=()=>{e.page=0,e.total=0,e.finished=!1,e.loading=!0,e.list=[],v()},R=async()=>{var u;const s=JSON.parse(JSON.stringify(r.value)),t={page:1,size:1,type:2,sortType:e.sortType,title:(u=r.value)==null?void 0:u.title},{success:d,data:a}=await b(t);if(!d)return l();const p=(a==null?void 0:a.records[0])||null;r.value=p;const o=e.list.find(m=>{var _;return m.id===((_=r.value)==null?void 0:_.id)});o&&(o!=null&&o.id)?o.guaranteeList=p.guaranteeList:e.list.splice(e.list.findIndex(m=>m.id===s.id),1)},v=async()=>{e.loading=!0,e.page+=1,await V(),e.loading=!1},w=s=>{$.push(s)},V=async()=>{var d,a;const s={page:e.page,size:e.size,type:2,sortType:e.sortType,title:e.keyWord},t=await b(s);if(e.loading=!1,!t.success||!t.data||!+t.data.total){e.finished=!0;return}e.total=(d=t.data)==null?void 0:d.total,e.list=e.page===1?(a=t.data)==null?void 0:a.records:e.list.concat(t.data.records),e.list.length>=e.total&&(e.finished=!0)};return G(()=>{l()}),(s,t)=>{const d=O,a=Q,p=E;return g(),x("div",oe,[n(Y,{title:s.$t("shen-he-xiang-mu")},{default:f(()=>[i("div",ae,[i("div",ne,[n(d,{modelValue:e.keyWord,"onUpdate:modelValue":t[0]||(t[0]=o=>e.keyWord=o),placeholder:s.$t("shu-ru-sheng-tai"),class:"w-[100% - 20px] text-center iconfont rounded-full",style:{background:"#fff"},clearable:"",onKeyup:N(l,["enter"])},{"right-icon":f(()=>[i("div",{onClick:l},t[6]||(t[6]=[i("img",{src:X,class:"w-4 h-4"},null,-1)]))]),_:1},8,["modelValue","placeholder"])]),n(Z,{ref:"sortBoxRef",style:{color:"black"},color:"#b7b4b0",activeColor:"#5D5A56",list:B.value,"init-sort":e.sortType,onChange:z},null,8,["list","init-sort"])]),i("div",ie,[n(a,{loading:e.loading,"onUpdate:loading":t[1]||(t[1]=o=>e.loading=o),finished:e.finished,"finished-text":s.$t("mei-you-geng-duo-le"),"loading-text":s.$t("jia-zai-zhong"),"immediate-check":!1,onLoad:v},{default:f(()=>[(g(!0),x(U,null,q(e.list,(o,u)=>(g(),A(te,{key:u,shop:o,onHandleTo:w,onOpen:S},null,8,["shop"]))),128))]),_:1},8,["loading","finished","finished-text","loading-text"])]),i("div",re,[n(p,{round:"",color:"#FED73A",class:"w-full !h-[46px] flex items-center justify-center font-semibold border-none",onClick:t[2]||(t[2]=o=>w(`/crowdRecords?active=${c(C).CROWD_PUBLIC}`))},{default:f(()=>[i("span",le,J(s.$t("wo-shen-he-de-xiang-mu")),1)]),_:1})]),n(ee,{show:c(L),data:r.value,active:c(C).CROWD_PUBLIC,content:s.$t("que-ren-wei-xiang-mu-shen-he"),onClose:t[3]||(t[3]=o=>c(h)(!1)),onInit:t[4]||(t[4]=o=>l()),onSuccess:t[5]||(t[5]=o=>R())},null,8,["show","data","active","content"]),n(c(K),{class:"child-view"})]),_:1},8,["title"])])}}}),$e=H(ce,[["__scopeId","data-v-abe99d63"]]);export{$e as default};
