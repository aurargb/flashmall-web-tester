import{d as M,M as oe,N as ae,O as J,P as K,Q as le,S as ne,T as ie,r as ee,c as j,U as re,V as ce,f,W as de,X as Q,Y as ue,Z as W,$ as he,b as d,e as u,g as s,t as n,G as L,j as _,a0 as me,m as fe,p as pe,o as ve,i as C,J as ge,l as be,_ as _e,a1 as xe,F as ye,h as ke,K as we}from"./index-D1IDHpEr.js";import{_ as Re}from"./member-wzMSw2ZB.js";import{G as Z}from"./guarantee-BhLJfceW.js";import{u as Te}from"./use-refs-m49Wdw5d.js";const[Se,F]=ne("rate");function Ie(t,r,c,p){return t>=r?{status:"full",value:1}:t+.5>=r&&c&&!p?{status:"half",value:.5}:t+1>=r&&c&&p?{status:"half",value:Math.round((t-r+1)*1e10)/1e10}:{status:"void",value:0}}const $e={size:K,icon:J("star"),color:String,count:le(5),gutter:K,clearable:Boolean,readonly:Boolean,disabled:Boolean,voidIcon:J("star-o"),allowHalf:Boolean,voidColor:String,touchable:ae,iconPrefix:String,modelValue:oe(0),disabledColor:String};var Ee=M({name:Se,props:$e,emits:["change","update:modelValue"],setup(t,{emit:r}){const c=ie(),[p,T]=Te(),x=ee(),S=j(()=>t.readonly||t.disabled),e=j(()=>S.value||!t.touchable),h=j(()=>Array(+t.count).fill("").map((a,o)=>Ie(t.modelValue,o+1,t.allowHalf,t.readonly)));let i,v,g=Number.MAX_SAFE_INTEGER,b=Number.MIN_SAFE_INTEGER;const y=()=>{v=W(x);const a=p.value.map(W);i=[],a.forEach((o,l)=>{g=Math.min(o.top,g),b=Math.max(o.top,b),t.allowHalf?i.push({score:l+.5,left:o.left,top:o.top,height:o.height},{score:l+1,left:o.left+o.width/2,top:o.top,height:o.height}):i.push({score:l+1,left:o.left,top:o.top,height:o.height})})},k=(a,o)=>{for(let l=i.length-1;l>0;l--)if(o>=v.top&&o<=v.bottom){if(a>i[l].left&&o>=i[l].top&&o<=i[l].top+i[l].height)return i[l].score}else{const E=o<v.top?g:b;if(a>i[l].left&&i[l].top===E)return i[l].score}return t.allowHalf?.5:1},w=a=>{S.value||a===t.modelValue||(r("update:modelValue",a),r("change",a))},I=a=>{e.value||(c.start(a),y())},$=a=>{if(!e.value&&(c.move(a),c.isHorizontal()&&!c.isTap.value)){const{clientX:o,clientY:l}=a.touches[0];de(a),w(k(o,l))}},m=(a,o)=>{const{icon:l,size:E,color:A,count:z,gutter:D,voidIcon:H,disabled:R,voidColor:G,allowHalf:X,iconPrefix:Y,disabledColor:O}=t,N=o+1,V=a.status==="full",B=a.status==="void",te=X&&a.value>0&&a.value<1;let U;D&&N!==+z&&(U={paddingRight:ue(D)});const se=q=>{y();let P=X?k(q.clientX,q.clientY):N;t.clearable&&c.isTap.value&&P===t.modelValue&&(P=0),w(P)};return f("div",{key:o,ref:T(o),role:"radio",style:U,class:F("item"),tabindex:R?void 0:0,"aria-setsize":z,"aria-posinset":N,"aria-checked":!B,onClick:se},[f(Q,{size:E,name:V?l:H,class:F("icon",{disabled:R,full:V}),color:R?O:V?A:G,classPrefix:Y},null),te&&f(Q,{size:E,style:{width:a.value+"em"},name:B?H:l,class:F("icon",["half",{disabled:R,full:!B}]),color:R?O:B?G:A,classPrefix:Y},null)])};return re(()=>t.modelValue),ce("touchmove",$,{target:x}),()=>f("div",{ref:x,role:"radiogroup",class:F({readonly:t.readonly,disabled:t.disabled}),tabindex:t.disabled?void 0:0,"aria-disabled":t.disabled,"aria-readonly":t.readonly,onTouchstartPassive:I},[h.value.map(m)])}});const Be=he(Ee),Ce={class:"inline-flex items-center gap-1 px-1.5 h-[22px] text-xs font-normal rounded bg-ratio text-black-800 no-wrap"},Fe={class:"font-medium"},Ne=M({__name:"RatioBox",props:{ratio:{},tag:{}},setup(t){return(r,c)=>(u(),d("div",Ce,[s("span",null,n(r.tag||r.$t("rang-li-bi-li")),1),s("span",null,[s("span",Fe,n(_(me)(r.ratio||0)),1),c[0]||(c[0]=L("%"))])]))}}),Ve=fe(Ne,[["__scopeId","data-v-90b0c12b"]]),Pe={class:"rounded-xl mb-3 bg-white",click:"emits('click')"},je={class:"relative p-3 pb-2 w-full"},Le={class:"w-full flex items-center"},Me=["src"],Ae={class:"flex flex-col items-start justify-center min-h-[46px] flex-1 ml-2 text-sm truncate relative"},ze={class:"flex items-center justify-between w-full text-sm font-semibold"},De={class:"mr-2 text-base font-semibold truncate"},He={class:"flex-shrink-0"},Ge={class:"flex items-center justify-between w-full mt-1"},Xe={key:0,class:"text-xs flex items-center mt-2"},Ye={class:"text-b3 mr-7"},Oe={class:"flex items-center text-sm text-main"},Ue={class:"ml-2"},qe={key:1,class:"flex items-center w-full mt-2"},Je={class:"flex flex-1 items-center justify-between text-xs"},Ke={class:"text-b3"},Qe={class:"text-b2"},We={class:"flex flex-1 items-center justify-between text-xs"},Ze={class:"text-b3"},et={class:"text-b2"},tt={key:0},st={key:1},ot={key:2},at={class:"flex items-center text-xxs h-[50px] px-3 bg-[#FFF8EC] rounded-b-xl"},lt={class:"flex-shrink-0 text-xs leading-[18px] font-semibold mr-3"},nt={key:0,class:"flex items-center overflow-x-auto flex-1 line-clamp-1 gap-2.5"},it={class:"w-[30px] flex items-center justify-center bg-[#FED73A] rounded-3xl ml-2"},rt={class:"text-xs"},mt=M({__name:"ReviewStoreItem",props:{shop:{},noBtn:{type:Boolean},type:{}},emits:["handleTo","click","open"],setup(t,{emit:r}){const c=t,p=r,T=ee(0),{merchantDiscounts:x}=pe(),S=async()=>{T.value=await x(c.shop.merchant)*100};return ve(()=>{S()}),(e,h)=>{var g,b,y,k,w,I,$;const i=_e,v=Be;return u(),d("div",Pe,[s("section",je,[s("div",Le,[s("img",{src:e.shop.logo,class:"rounded flex-shrink-0 aspect-square object-cover bg-black-100 w-10 h-10",fit:"cover"},null,8,Me),s("div",Ae,[s("div",ze,[s("div",De,n(e.shop.storeName),1),s("div",He,[f(Ve,{tag:e.$t("rang-li"),ratio:e.shop.discountRatio||0},null,8,["tag","ratio"])])]),s("div",Ge,[s("div",{class:"flex items-center self-start text-main",onClick:h[0]||(h[0]=ge(m=>_(be)(e.shop.status===1?`/category?deliveryType=1&shopId=${e.shop.id}`:`/shopInfo?address=${e.shop.merchant}`),["stop"]))},[L(n(e.$t("jin-dian-cha-kan"))+" ",1),f(i,{name:"back",color:"#FF8812",class:"rotate-180",width:16,height:16})])])])]),e.type===_(Z).STORE_CLAIM&&e.shop.status===1&&!e.noBtn?(u(),d("div",Xe,[s("div",Ye,n(e.$t("dian-pu-xing-ji")),1),s("div",Oe,[f(v,{"model-value":e.shop.star,readonly:"","allow-half":"",size:12,gutter:"0",color:"#FEA021"},null,8,["model-value"]),s("span",Ue,n(e.shop.star),1)])])):C("",!0),e.type===_(Z).STORE_INACTIVE?(u(),d("div",qe,[s("div",Je,[s("div",Ke,n(e.$t("lei-ji-xiao-liang")),1),s("div",Qe,n((g=e.shop)==null?void 0:g.volume),1)]),h[2]||(h[2]=s("div",{class:"w-[1px] h-2.5 bg-b4 mx-2"},null,-1)),s("div",We,[s("div",Ze,n(e.$t("huo-yue-shi-jian")),1),s("div",et,[(b=e.shop)!=null&&b.activeTime?(u(),d("span",tt,n(_(xe)((y=e.shop)==null?void 0:y.activeTime,"Y-m-d")),1)):(k=e.shop)!=null&&k.createTime?(u(),d("span",st,n((I=(w=e.shop)==null?void 0:w.createTime)==null?void 0:I.split(" ")[0]),1)):(u(),d("span",ot,"--"))])])])):C("",!0)]),s("section",at,[s("span",lt,n(e.$t("ren-yi-can-yu",{num:e.shop.guaranteeList&&e.shop.guaranteeList.length||0})),1),e.shop.guaranteeList&&e.shop.guaranteeList.length>0?(u(),d("div",nt,[(u(!0),d(ye,null,ke(e.shop.guaranteeList.slice(0,3),m=>(u(),d("div",{key:m,class:"flex items-center ml-1"},[L(n(m.address&&_(we)(m.address,"....",3,3))+" ",1),s("div",it,[h[3]||(h[3]=s("img",{src:Re,class:"w-2.5 h-2.5"},null,-1)),s("span",rt,"v"+n(m.memberLevel),1)])]))),128))])):C("",!0),!e.noBtn&&((($=e.shop)==null?void 0:$.guaranteeList)||[]).length<3?(u(),d("div",{key:1,class:"flex-shrink-0 px-2 h-[26px] leading-[26px] ml-auto text-sm text-black bg-[#FED73A] rounded-3xl",onClick:h[1]||(h[1]=m=>p("open",e.shop))},n(e.$t("wei-ta-shen-he")),1)):C("",!0)])])}}});export{mt as _};
