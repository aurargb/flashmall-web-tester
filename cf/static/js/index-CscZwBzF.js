import{bx as B,c as C,d as j,r as f,bs as y,W as K,w as b,b4 as L,o as M,ar as O,aK as R,e as t,V,g as W,t as q,j as z,aR as m,aM as A,aw as D,s as E}from"./index-Ce_DXvk7.js";const F=Symbol(),[G,l,H]=C("list"),I=E(j({name:G,props:{error:Boolean,offset:V(300),loading:Boolean,disabled:Boolean,finished:Boolean,scroller:Object,errorText:String,direction:W("down"),loadingText:String,finishedText:String,immediateCheck:q},emits:["load","update:error","update:loading"],setup(e,{emit:c,slots:i}){const n=f(e.loading),u=f(),g=f(),d=B(F,null),x=y(u),h=K(()=>e.scroller||x.value),r=()=>{z(()=>{if(n.value||e.finished||e.disabled||e.error||(d==null?void 0:d.value)===!1)return;const{direction:o}=e,a=+e.offset,s=m(h);if(!s.height||A(u))return;let v=!1;const p=m(g);v=o==="up"?s.top-p.top<=a:p.bottom-s.bottom<=a,v&&(n.value=!0,c("update:loading",!0),c("load"))})},T=()=>{if(e.finished){const o=i.finished?i.finished():e.finishedText;if(o)return t("div",{class:l("finished-text")},[o])}},k=()=>{c("update:error",!1),r()},S=()=>{if(e.error){const o=i.error?i.error():e.errorText;if(o)return t("div",{role:"button",class:l("error-text"),tabindex:0,onClick:k},[o])}},w=()=>{if(n.value&&!e.finished&&!e.disabled)return t("div",{class:l("loading")},[i.loading?i.loading():t(D,{class:l("loading-icon")},{default:()=>[e.loadingText||H("loading")]})])};return b(()=>[e.loading,e.finished,e.error],r),d&&b(d,o=>{o&&r()}),L(()=>{n.value=e.loading}),M(()=>{e.immediateCheck&&r()}),O({check:r}),R("scroll",r,{target:h,passive:!0}),()=>{var o;const a=(o=i.default)==null?void 0:o.call(i),s=t("div",{ref:g,class:l("placeholder")},null);return t("div",{ref:u,role:"feed",class:l(),"aria-busy":n.value},[e.direction==="down"?a:s,w(),T(),S(),e.direction==="up"?a:s])}}}));export{I as L};
