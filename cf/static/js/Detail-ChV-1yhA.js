import{l as Ce,k as zt,aS as Ht,aT as Jt,e as w,m as Gt,_ as ce,K as ct,W as V,x as d,y as I,z as e,C as t,H as c,aV as Kt,A as m,D as rt,E as g,Q as $,O as re,a8 as te,v as we,a9 as ke,r as p,w as ut,o as je,ab as U,aU as le,P as Ie,F as se,G as $e,ap as Wt,N as C,Y as Zt,Z as Qt,aW as Xt,ad as Yt,J as ue,M as el,af as al,ac as X,S as tl,__tla as ll}from"./index-Ce_DXvk7.js";import{L as sl}from"./index-CscZwBzF.js";import{b as nl,e as ol,i as il,_ as dl,a as cl}from"./cf-D0X9PrTD.js";import{s as rl,I as ul,_ as ml}from"./InviteCodePop-Dn-Exw4N.js";import{u as pl}from"./useCountdown-DD4s2lb6.js";import{_ as vl}from"./DetailCard-DFTxejGZ.js";import{_ as mt}from"./TokenAmount-V2Bwu2KM.js";import{T as Te,a as q}from"./projectEnum-9kZKCKr4.js";import{u as ne}from"./index-BmORpdFZ.js";import{C as fl}from"./NumberKeyBoardInput.vue_vue_type_style_index_0_scoped_fc2dc43c_lang-BzFoGsd-.js";import{F as pt}from"./index-BwvP83fo.js";import{f as De,e as oe,__tla as bl}from"./flashMallContract-BaBlVuqw.js";import{d as Ne}from"./dark-close-SpaTsRy-.js";import{m as me,a as Oe}from"./MAI-BT7NZAfN.js";import{d as wl}from"./debounce-xklcBeXq.js";import{D as hl,__tla as gl}from"./DividendPointPop-BH8lFp7I.js";import{c as vt,__tla as xl}from"./cfContract-XFp0fv1b.js";import"./StateTimeBar-C7QRNDIm.js";import{__tla as yl}from"./contractHelper-BHednLWH.js";let ft,_l=Promise.all([(()=>{try{return ll}catch{}})(),(()=>{try{return bl}catch{}})(),(()=>{try{return gl}catch{}})(),(()=>{try{return xl}catch{}})(),(()=>{try{return yl}catch{}})()]).then(async()=>{let he,bt=Ce({},{title:"",width:"",theme:null,message:"",overlay:!0,callback:null,teleport:"body",className:"",allowHtml:!1,lockScroll:!0,transition:void 0,beforeClose:null,overlayClass:"",overlayStyle:void 0,messageAlign:"",cancelButtonText:"",cancelButtonColor:null,cancelButtonDisabled:!1,confirmButtonText:"",confirmButtonColor:null,confirmButtonDisabled:!1,showConfirmButton:!0,showCancelButton:!1,closeOnPopstate:!0,closeOnClickOverlay:!1});function wt(i){return zt?new Promise((n,x)=>{he||function(){({instance:he}=Ht({setup(){const{state:D,toggle:h}=Jt();return()=>w(rl,Gt(D,{"onUpdate:show":h}),null)}}))}(),he.open(Ce({},bt,i,{callback:T=>{(T==="confirm"?n:x)(T)}}))}):Promise.resolve(void 0)}let ie,Ee,Se,Me,Pe,Be,Le,Ve,Ue,Ae,Fe,Re,qe,ze,He,Je,Ge,Ke,We,Ze,Qe,Xe,Ye,ea,aa,ta,la,sa,na,oa,ia,da,ca,ra,ua,ma,pa,va,fa,ba,wa,ha,ga,xa,ya,_a,Ca,ka,ja,Ia,$a,Ta,Da,Na,Oa,Ea,Sa,Ma,Pa,Ba,La,Va,Ua,Aa,Fa,Ra,qa,za,Ha,Ja,Ga,Ka,Wa,Za,Qa,Xa,Ya;ie=i=>wt(Ce({showCancelButton:!0},i)),Ee={class:"bg-white rounded-xl p-3 mb-3"},Se={class:"address-time flex justify-between items-center"},Me={class:"text-b2 text-sm font-semibold"},Pe={class:"text-b3 text-sm font-normal"},Be={class:"mt-2"},Le={class:"text-orange1 text-sm font-semibold"},Ve={key:1,class:"flex justify-end items-center mt-2"},Ue={class:"text-b1 text-sm font-semibold"},Ae={class:"text-b6 text-sm font-semibold"},Fe=ce({__name:"CreatedRecordCard",props:{data:{type:Object,default:()=>{}},project:{type:Object,default:()=>{}},cancelLoading:{type:Boolean,default:!1},delLoading:{type:Boolean,default:!1}},emits:["cancelItem"],setup(i,{emit:n}){const{accountStore:x}=ct(),[T,D]=ne(!1),h=n,b=i,y={in_progress:!0,succeed:!0},z=V(()=>b.project.targetType!=Te.POINT&&(y[b.project.status]||!1)),M=V(()=>{var r,N,j;return b.project.status==q.CONFIRMED&&b.project.withdrawn===!0&&((r=x.account)==null?void 0:r.toLocaleLowerCase())===((j=(N=b.project)==null?void 0:N.creator)==null?void 0:j.toLocaleLowerCase())}),O=()=>{D(!T.value)},E=()=>{const r=b.data.address||"";h("cancelItem",r)},L=()=>{h("delItem",b.data.address)};return(r,N)=>{const j=re;return d(),I("div",Ee,[e("div",Se,[e("p",Me,t(c(Kt)(i.data.address,"...",4,4)),1),e("p",Pe,t(i.data.createTime),1)]),e("div",Be,[w(mt,{mcoin:i.data.mcoin,mai:i.data.mai,point:i.data.point,type:i.project.targetType},{default:m(()=>[e("span",Le,t(i.data.num||0)+t(r.$t("serving")),1)]),_:1},8,["mcoin","mai","point","type"])]),i.data.remark?(d(),I("div",{key:0,class:"rounded bg-gray4 p-1 mt-2 cursor-pointer",onClick:O},[e("p",{class:rt(["text-xs text-b3 font-normal",{"line-clamp-1":!c(T)}])},[e("span",null,t(r.$t("remark"))+": ",1),e("span",null,t(i.data.remark),1)],2)])):g("",!0),z.value||M.value?(d(),I("div",Ve,[z.value?(d(),$(j,{key:0,class:"kill-btn bg-main px-3 py-1.5 rounded-md",onClick:E,loading:i.cancelLoading},{default:m(()=>[e("span",Ue,t(r.$t("return")),1)]),_:1},8,["loading"])):g("",!0),M.value?(d(),$(j,{key:1,class:"del-btn px-3 py-1.5 rounded-md mr-2",onClick:L,loading:i.delLoading},{default:m(()=>[e("span",Ae,t(r.$t("delete")),1)]),_:1},8,["loading"])):g("",!0)])):g("",!0)])}}},[["__scopeId","data-v-a3e25fd4"]]),Re={class:"content relative p-4"},qe={class:"title relative mb-4"},ze={class:"text-b1 text-lg font-semibold text-center"},He={class:"flex items-center !text-b1 !font-semibold"},Je=["src"],Ge={class:"flex items-center !text-b1 !font-semibold"},Ke=["src"],We={class:"flex items-center !text-b1 !font-semibold"},Ze=["src"],Qe={class:"mt-5"},Xe={class:"text-base text-b1 font-semibold"},Ye=ce({__name:"DividendPop",props:te({dividendLoading:{type:Boolean,default:!1},selectedToken:{type:Object,default:()=>{}},project:{type:Object,default:()=>{}}},{show:{},showModifiers:{}}),emits:te(["update:show","confirm","closeDividend"],["update:show"]),setup(i,{emit:n}){const{t:x}=we(),{pointBalances:T}=De(),D=ke(i,"show"),h=n,b=i,y=p({mcoin:"",mai:"",point:""}),z=V(()=>oe(U.MAI)),M=V(()=>oe(U.MCOIN)),O=p(0),E=p(0),L=p(0),r=async()=>{try{const[u,s,S]=await Promise.all([T(),M.value.balanceOf(),z.value.balanceOf()]);O.value=le(s,2),E.value=le(S,2);const H=Number(O.value)+Number(u);L.value=le(H,2)}catch(u){console.error("\u83B7\u53D6\u4F59\u989D\u5931\u8D25:",u),O.value="0.00",E.value="0.00",L.value="0.00"}},N={1:x("dividend.mcoin"),2:x("dividend.mai"),3:x("dividend.point"),4:x("dividend.mcoin mai")},j=V(()=>`${N[b.selectedToken.id]}`);ut(D,u=>{u?r():y.value={mcoin:"",mai:"",point:""}});const k=()=>{h("closeDividend"),h("update:show",!1)},v=()=>{h("closeDividend"),h("update:show",!1)},B=wl(()=>{h("confirm",y.value)},300);return je(async()=>{await r()}),(u,s)=>{const S=pt,H=fl,G=re,K=Ie;return d(),I("div",null,[w(K,{show:D.value,"onUpdate:show":s[3]||(s[3]=A=>D.value=A),round:"",position:"bottom","close-on-click-overlay":"",onClose:v,closeable:"",onClickOverlay:k,"close-icon":c(Ne)},{default:m(()=>[e("div",Re,[e("div",qe,[e("p",ze,t(j.value),1)]),w(H,{inset:""},{default:m(()=>[i.selectedToken.id==1||i.selectedToken.id==4?(d(),$(S,{key:0,modelValue:y.value.mcoin,"onUpdate:modelValue":s[0]||(s[0]=A=>y.value.mcoin=A),placeholder:u.$t("Enter the dividend amount"),type:"number","label-width":"auto","input-align":"right"},{label:m(()=>[e("span",He,[e("span",null,t(c(x)("divident.field.mcoin")),1),s[4]||(s[4]=e("span",null,"(",-1)),e("span",null,t(u.$t("balance"))+":",1),e("img",{src:c(me),alt:"token",class:"w-4 h-4 mx-[2px]"},null,8,Je),e("span",null,t(O.value),1),s[5]||(s[5]=e("span",null,")",-1))])]),_:1},8,["modelValue","placeholder"])):g("",!0),i.selectedToken.id==2||i.selectedToken.id==4?(d(),$(S,{key:1,modelValue:y.value.mai,"onUpdate:modelValue":s[1]||(s[1]=A=>y.value.mai=A),placeholder:u.$t("Enter the dividend amount"),type:"number","label-width":"auto","input-align":"right"},{label:m(()=>[e("span",Ge,[e("span",null,t(c(x)("divident.field.mai")),1),s[6]||(s[6]=e("span",null,"(",-1)),e("span",null,t(u.$t("balance"))+":",1),e("img",{src:c(Oe),alt:"token",class:"w-4 h-4 mx-[2px]"},null,8,Ke),e("span",null,t(E.value),1),s[7]||(s[7]=e("span",null,")",-1))])]),_:1},8,["modelValue","placeholder"])):g("",!0),i.selectedToken.id==3?(d(),$(S,{key:2,modelValue:y.value.point,"onUpdate:modelValue":s[2]||(s[2]=A=>y.value.point=A),placeholder:u.$t("Enter the dividend amount"),type:"number","label-width":"auto","input-align":"right"},{label:m(()=>[e("span",We,[e("span",null,t(c(x)("divident.field.point")),1),s[8]||(s[8]=e("span",null,"(",-1)),e("span",null,t(u.$t("balance"))+":",1),e("img",{src:c(me),alt:"token",class:"w-4 h-4 mx-[2px]"},null,8,Ze),e("span",null,t(L.value),1),s[9]||(s[9]=e("span",null,")",-1))])]),_:1},8,["modelValue","placeholder"])):g("",!0)]),_:1}),e("div",Qe,[w(G,{block:"",class:"confirm-btn",onClick:c(B),loading:i.dividendLoading},{default:m(()=>[e("span",Xe,t(u.$t("Immediately issue")),1)]),_:1},8,["onClick","loading"])])])]),_:1},8,["show","close-icon"])])}}},[["__scopeId","data-v-a9f03183"]]),ea={class:"content relative safe-bottom-4 pt-4 pl-4 pr-4"},aa={class:"title relative"},ta={class:"text-b1 text-lg font-semibold text-center"},la={class:"info-detail rounded-xl bg-white mt-3"},sa={class:"text-b1 text-sm font-semibold mb-4"},na={class:"relative max-h-[50vh] overflow-y-auto"},oa={class:"flex items-center mb-3"},ia={class:"text-b1 text-sm mr-2 w-[60px] whitespace-nowrap"},da={class:"flex items-center mb-3"},ca={class:"text-b1 text-sm mr-2 w-[60px] batch-input-label"},ra={class:"flex items-center justify-between h-[36px]"},ua={class:"text-b1 text-sm mr-2 w-[90px] batch-input-label"},ma={class:"text-[#FF8812] text-sm font-semibold"},pa={class:"mt-4"},va={class:"text-base text-b1 font-semibold"},fa=ce({__name:"ManualItemPop",props:te({project:{type:Object,default:()=>{}}},{show:{},showModifiers:{}}),emits:te(["update:show"],["update:show"]),setup(i,{emit:n}){const{t:x}=we(),{manualItem:T}=vt(),D=ke(i,"show"),h=n,b=i,y=p({participants:[{address:"",num:"1"}]}),z=()=>{y.value.participants.push({address:"",num:1})},M=()=>{h("update:show",!1)},O=()=>{h("update:show",!1)};x("errorMsg.network does not support ENS");const E=p(!1),L=async()=>{if(y.value.participants.filter(v=>v.address&&v.num).length===0)return C(x("Add at least 1 participant")),!1;let r=[];r=y.value.participants.filter(v=>v.address&&v.num);const N=r.map(v=>{var B;return(B=v.address)==null?void 0:B.toLowerCase()});if([...new Set(N)].length!==N.length)return void C(x("Participant addresses cannot be repeated"));const j={id:b.project.id,addrs:r.map(v=>v.address),counts:r.map(v=>v.num)};E.value=!0;const k=await T(j);E.value=!1,k.success&&(y.value.participants=[{address:"",num:1}],C(x("Supplementary recording successful")),h("success"),h("update:show",!1))};return(r,N)=>{const j=pt,k=mt,v=re,B=Ie;return d(),I("div",null,[w(B,{show:D.value,"onUpdate:show":N[0]||(N[0]=u=>D.value=u),round:"",position:"bottom","close-on-click-overlay":"",onClose:O,closeable:"",onClickOverlay:M,"close-icon":c(Ne),class:""},{default:m(()=>[e("div",ea,[e("div",aa,[e("p",ta,t(r.$t("Supplementary recruitment of project participants")),1)]),e("div",la,[e("div",sa,t(r.$t("Project Participants")),1),e("div",na,[(d(!0),I(se,null,$e(y.value.participants,(u,s)=>(d(),I("div",{key:s,class:"participant-item mb-6"},[e("div",oa,[e("span",ia,t(r.$t("Participants"))+t(s+1),1),w(j,{modelValue:u.address,"onUpdate:modelValue":S=>u.address=S,placeholder:r.$t("Enter the participants address"),class:"flex-1 h-[36px] batch-input text-right","input-align":"right",onBlur:S=>((H,G)=>{const K=y.value.participants[G];K.address&&(K.address=K.address.trim(),Wt(K.address)||(C(x("Participants")+(G+1)+x("The address format is incorrect")),K.address=""))})(0,s)},null,8,["modelValue","onUpdate:modelValue","placeholder","onBlur"])]),e("div",da,[e("span",ca,t(r.$t("Number of participants")),1),w(j,{modelValue:u.num,"onUpdate:modelValue":S=>u.num=S,placeholder:r.$t("Number of participants"),class:"flex-1 h-[36px] batch-input","input-align":"right",type:"digit"},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),e("div",ra,[e("span",ua,t(r.$t("Estimated amount raised")),1),e("span",null,[w(k,{type:i.project.targetType,mcoin:i.project.mcoinPer*u.num,mai:i.project.maiPer*u.num,point:i.project.pointPer*u.num},null,8,["type","mcoin","mai","point"])])]),N[1]||(N[1]=e("div",{class:"border-b border-gray-200 mt-4"},null,-1))]))),128))]),e("div",{class:"add-participant flex items-center justify-center py-3 mt-4 bg-[#FFF6E5] rounded-md cursor-pointer",onClick:z},[e("span",ma,t(r.$t("Add participants")),1)])]),e("div",pa,[w(v,{block:"",class:"confirm-btn",onClick:L,loading:E.value},{default:m(()=>[e("span",va,t(r.$t("Complete Supplemental Recording")),1)]),_:1},8,["loading"])])])]),_:1},8,["show","close-icon"])])}}},[["__scopeId","data-v-2c01bae2"]]),ba={class:"flex flex-col justify-between px-4"},wa={class:"flex-1"},ha={class:"mt-[16px] font-semibold text-base text-center"},ga={class:"mt-[16px]"},xa=["onClick"],ya={class:"!font-normal flex items-center ml-2"},_a=["src"],Ca=["src"],ka={class:"ml-auto"},ja={src:"data:image/svg+xml,%3csvg%20width='40'%20height='40'%20viewBox='0%200%2040%2040'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M16.6652%2025.2855L31.9859%209.96484L34.3429%2012.3219L16.6652%2029.9995L6.05859%2019.393L8.41563%2017.036L16.6652%2025.2855Z'%20fill='%23FF8812'/%3e%3c/svg%3e",class:"w-5 h-5",alt:"\u5DF2\u9009"},Ia={class:"mt-4 text-center text-sm text-b3 font-normal"},$a={class:"py-2 pb-4 flex justify-between"},Ta={class:"text-base text-b1 font-semibold"},Da=ce({__name:"DividendTokenSelector",props:te({project:{type:Object,default:()=>{}}},{show:{},showModifiers:{}}),emits:te(["close","selected"],["update:show"]),setup(i,{emit:n}){const{pointBalances:x}=De(),{t:T}=we(),D=ke(i,"show"),h=n,b=p({}),y=V(()=>oe(U.MAI)),z=V(()=>oe(U.MCOIN)),M=p(0),O=p(0),E=p(0),L=async()=>{try{const[k,v,B]=await Promise.all([x(),z.value.balanceOf(),y.value.balanceOf()]);M.value=le(v,2),O.value=le(B,2);const u=Number(M.value)+Number(k);E.value=le(u,2)}catch(k){console.error("\u83B7\u53D6\u4F59\u989D\u5931\u8D25:",k),M.value="0.00",O.value="0.00",E.value="0.00"}},r=V(()=>[{id:1,value:`${T("dividend.mcoin")}`,balance:M.value,icon:me},{id:2,value:`${T("dividend.mai")} `,balance:O.value,icon:Oe},{id:4,value:`${T("dividend.mai and mcoin")} `,balance:M.value,balance2:O.value,icon:me,icon2:Oe},{id:3,value:`${T("dividend.point")}`,balance:E.value,icon:me}]);ut(D,k=>{k&&L()});const N=()=>{b.value={},h("close")},j=()=>{if(!b.value.id)return Xt("\u8BF7\u9009\u62E9\u5206\u7EA2\u65B9\u5F0F"),!1;h("selected",b.value)};return je(async()=>{await L()}),(k,v)=>{const B=re,u=Ie;return d(),$(u,{show:D.value,"onUpdate:show":v[0]||(v[0]=s=>D.value=s),position:"bottom",round:"",onClose:N,closeable:"","close-icon":c(Ne)},{default:m(()=>[e("div",ba,[e("div",wa,[e("div",ha,t(k.$t("select cancel order reason")),1),e("div",ga,[(d(!0),I(se,null,$e(r.value,s=>(d(),I("div",{key:s.id,class:"select-item w-full h-[52px] border-b border-[#D9D9D9] flex items-center justify-start font-normal",onClick:S=>(H=>{b.value=H})(s)},[e("div",{class:rt(["text-sm flex items-center whitespace-pre-wrap",[b.value.id==s.id?"text-[#FF8812] font-semibold":"text-b1 font-normal"]])},[e("span",null,t(s.value),1),e("span",ya,[v[1]||(v[1]=e("span",null,"(",-1)),e("span",null,t(k.$t("balance"))+":",1),e("img",{src:s.icon,alt:"token",class:"w-4 h-4 mx-[2px]"},null,8,_a),e("span",null,t(s.balance),1),s.id===4?(d(),I(se,{key:0},[e("img",{src:s.icon2,alt:"token",class:"w-4 h-4 mx-[2px]"},null,8,Ca),e("span",null,t(s.balance2),1)],64)):g("",!0),v[2]||(v[2]=e("span",null,")",-1))])],2),e("div",ka,[Zt(e("img",ja,null,512),[[Qt,b.value.id==s.id]])])],8,xa))),128))])]),e("div",Ia,t(k.$t("Dividends are distributed according to the number of shares purchased by participants")),1),e("div",$a,[w(B,{round:"",class:"w-full main-btn font-semibold text-b1 text-base h-[46px] rounded-full",onClick:j,disabled:!b.value.id},{default:m(()=>[e("span",Ta,t(k.$t("next step")),1)]),_:1},8,["disabled"])])])]),_:1},8,["show","close-icon"])}}},[["__scopeId","data-v-c116355c"]]),Na={class:"page__container bg-flash-linear relative"},Oa={class:"fixed top-0 w-full right-0 left-0"},Ea={class:"sm:w-[375px] mx-auto fixed top-[50px] h-[calc(100vh-50px)] w-full right-0 left-0 px-3 pt-2"},Sa={class:"mt-4"},Ma={class:"text-b1 text-base font-semibold"},Pa={class:"mt-3 overflow-y-scroll h-[calc(100%-238px)] pb-[120px]"},Ba={class:"w-full fixed bottom-0 left-0 right-0 pt-4 px-3 safe-bottom-4"},La={class:"text-b1 text-base font-normal"},Va={class:"text-b1 text-base font-normal"},Ua={class:"text-b1 text-base font-normal"},Aa={key:3,class:"flex justify-between gap-3"},Fa={class:"text-b1 text-base font-normal"},Ra={class:"text-b1 text-base font-semibold whitespace-nowrap"},qa={class:"text-b1 text-base font-semibold"},za={key:5,class:"flex justify-between gap-3"},Ha={class:"text-b1 text-base font-normal"},Ja={class:"text-b1 text-base font-normal whitespace-nowrap"},Ga={class:"text-b1 text-base font-normal"},Ka={class:"text-b1 text-base font-semibold"},Wa={key:6,class:"flex justify-between gap-3"},Za={class:"text-b1 text-base font-normal"},Qa={class:"text-b1 text-base font-normal whitespace-nowrap"},Xa={class:"text-b1 text-base font-normal"},Ya={class:"text-b1 text-base font-semibold"},ft=ce({__name:"Detail",setup(i){const{t:n}=we(),{pointBalances:x}=De(),{accountStore:T,reloadStore:D}=ct(),h=V(()=>y.query.type!=="managed"),b=el(),y=al(),{cancel:z,finish:M,collect:O,reward:E,cancelItem:L,manualItemRemove:r,crowdsItemList:N}=vt(),[j,k]=ne(!1),[v,B]=ne(!1),[u,s]=ne(!1),[S,H]=ne(!1),[G,K]=ne(!1),A=V(()=>oe(U.MAI)),Y=V(()=>oe(U.MCOIN)),et=p(y.query.id),o=p({}),ht=p({type:"initiated",projectId:et.value,onlyMe:!1}),ge=p(0),gt=p(20),xt=p(0),J=p(!1),pe=p(!1),ee=p([]),{remainingTimeText:yt,startCountdown:at,stopCountdown:_t}=pl({endText:n("ended"),onEnd:()=>{window.location.reload()}}),Ct=p([]),tt=p(0),de=p({}),kt=V(()=>window.location.origin+"/cf/#/detail/"+o.value.id);je(()=>{$t()}),Yt(()=>{_t()});const jt=()=>{J.value=!0,ge.value+=1,It()},It=()=>{const l={...ht.value,page:ge.value,size:gt.value};ol(l).then(a=>{if(a.code!=200||a.success===!1)return pe.value=!0,void(J.value=!1);const P=a.data||{};xt.value=P.total,ee.value=ge.value===1?ee.value=P.records:ee.value.concat(P.records),P.current>=P.pages&&(pe.value=!0)}).catch(a=>{pe.value=!0,J.value=!1}).finally(()=>{J.value=!1})},$t=async()=>{const l={id:et.value};J.value=!0;try{const a=await nl(l);if(a.code===200&&a.success){const P=a.data;o.value=P,Tt()}}catch(a){console.error("\u83B7\u53D6\u9879\u76EE\u8BE6\u60C5\u5931\u8D25:",a)}finally{J.value=!1}},Tt=()=>{const l=o.value;l.status!=q.IN_PROGRESS?l.status!=q.NOT_STARTED||at(l.startTime):at(l.endTime)},Dt=()=>{b.replace("/")},lt=()=>{b.push({path:"/dividend-detail",query:{id:o.value.id}})},st=()=>{b.push({path:"/manage-config",query:{id:o.value.id}})},F=p(!1),xe=()=>{ie({title:n("Canceling crowdfunding"),message:n("Are you sure you want to cancel crowdfunding"),confirmButtonColor:"#FED73A"}).then(async l=>{Mt()})},Nt=()=>{ie({title:n("Confirmation of crowdfunding success"),message:n("Are you sure the crowdfunding was successful"),confirmButtonColor:"#FED73A"}).then(async l=>{Pt()})},Ot=()=>{ie({title:n("Receive crowdfunding amount"),message:n("Are you sure you want to receive the crowdfunding amount"),confirmButtonColor:"#FED73A"}).then(async l=>{Bt()})},nt=p(null),ot=()=>{H(!0)},Et=l=>{nt.value=l,H(!1),St()},St=()=>{s(!0)},Mt=async()=>{const l={id:o.value.id};F.value=!0;const a=await z(l.id);F.value=!1,a.success&&(X().delCachedView({name:"Created"}),X().delCachedView({name:"Managed"}),sessionStorage.setItem("reset_created_scroll",1),sessionStorage.setItem("reset_managed_scroll",1),C(n("Crowdfunding project cancelled")),setTimeout(()=>{location.reload()},800))},Pt=async()=>{const l={id:o.value.id};F.value=!0;const a=await M(l.id);F.value=!1,a.success&&(X().delCachedView({name:"Created"}),X().delCachedView({name:"Managed"}),sessionStorage.setItem("reset_created_scroll",1),sessionStorage.setItem("reset_managed_scroll",1),C(n("Confirmed crowdfunding success")),setTimeout(()=>{location.reload()},800))},Bt=async()=>{const l={id:o.value.id};F.value=!0;const a=await O(l.id);F.value=!1,a.success&&(X().delCachedView({name:"Created"}),X().delCachedView({name:"Managed"}),sessionStorage.setItem("reset_created_scroll",1),sessionStorage.setItem("reset_managed_scroll",1),C(n("Crowdfunding amount received")),setTimeout(()=>{location.reload()},800))},ve=p(!1),ye=p(""),Lt=()=>{de.value={},ve.value=!1},Vt=async l=>{var a,P,ae;try{de.value=l,ve.value=!0;const R=Number(de.value.mcoin)||0,_=Number(de.value.mai)||0,f=Number(de.value.point)||0;if(R==0&&_==0&&f==0)return void C(n("Please enter the dividend amount"));if(R>0){const Z=await Y.value.balanceOf();if(Number(Z)<R)return void C("MCoin"+n("errorMsg.insufficient funds"));const W=await Y.value.allowance(U.crowdfunding);if(Number(W.result)<R){const Q=await Y.value.approve(U.crowdfunding);if(!Q.success)return void(((a=Q.result)==null?void 0:a.code)==="ACTION_REJECTED"&&C(n("User cancels MCoin authorization")))}}if(_>0){const Z=await A.value.balanceOf();if(Number(Z)<_)return void C("MAI"+n("errorMsg.insufficient funds"));const W=await A.value.allowance(U.crowdfunding);if(Number(W.result)<_){const Q=await A.value.approve(U.crowdfunding);if(!Q.success)return void(((P=Q.result)==null?void 0:P.code)==="ACTION_REJECTED"&&C(n("User cancels MAI authorization")))}}if(f>0){const Z=await Y.value.allowance(U.flashMall);if(Number(Z.result)<f){const dt=await Y.value.approve(U.flashMall);if(!dt.success)return void(((ae=dt.result)==null?void 0:ae.code)==="ACTION_REJECTED"&&C(n("User cancels authorization")))}const W=await Y.value.balanceOf(),Q=await x();if(Number(W)+Number(Q)<f)return void C(n("Insufficient balance unable to earn bonus points"))}const _e={id:o.value.id,mcoin:R,mai:_};if(_e.mcoin||_e.mai){if(!(await E(_e)).success)return;s(!1),C(n("Dividends have been paid"))}if(f>0){tt.value=f;const Z={projectId:o.value.id,point:f},W=await il(Z);W.success?(ye.value=W.data.id,b.push({path:"/batch-dividend",query:{projectId:o.value.id,point:f,projectBonusId:ye.value}})):C(n("Failed to record the points dividend amount please refresh and try again"))}}catch(R){console.error("\u5206\u7EA2\u64CD\u4F5C\u5931\u8D25:",R),C(n("Dividend operation failed please refresh and try again"))}finally{ve.value=!1}},Ut=()=>{},fe=p(!1),At=async l=>{const a=await cl({projectId:o.value.id,address:l});if(!a.success)return void C(n("Unable to obtain quantity details"));const P=a.data.times||0,ae=a.data.num,R=`${n("This operation will return all the project funds to the participant")}${P}${n("Total records")}${ae}${n("Crowdfunding")}`;ie({title:n("return"),message:R,confirmButtonColor:"#FED73A"}).then(async _=>{Ft(l)})},Ft=async l=>{const a={id:o.value.id,address:l};fe.value=!0,(await L(a)).success?(X().delCachedView({name:"Created"}),sessionStorage.setItem("reset_created_scroll",1),C(n("Returned")),setTimeout(()=>{fe.value=!1,location.reload()},800)):fe.value=!1},be=p(!1),it=p({}),Rt=async l=>{const a={id:o.value.id,addr:l};be.value=!0,(await r(a)).success?(be.value=!1,C(n("Deleted")),it.value[l]=!0):be.value=!1},qt=()=>{D.reload()};return(l,a)=>{const P=dl,ae=tl,R=sl,_=re;return d(),I("div",Na,[e("section",Oa,[w(P,{title:l.$t("Crowdfunding details")},{right:m(()=>[e("div",{class:"w-[22px] h-[22px]",onClick:a[0]||(a[0]=f=>c(k)(!0))},a[10]||(a[10]=[e("img",{src:ml,class:"w-[22px] h-[22px]",alt:"Share"},null,-1)]))]),_:1},8,["title"])]),e("section",Ea,[w(vl,{project:o.value,remainingTimeText:c(yt)},null,8,["project","remainingTimeText"]),e("div",Sa,[e("h2",Ma,t(l.$t("Participants")),1)]),e("div",Pa,[ee.value.length!==0||J.value?g("",!0):(d(),$(ae,{key:0,name:l.$t("No participants yet")},null,8,["name"])),w(R,{loading:J.value,"onUpdate:loading":a[1]||(a[1]=f=>J.value=f),finished:pe.value,"finished-text":ee.value.length===0?"":l.$t("no-more"),onLoad:jt},{default:m(()=>[(d(!0),I(se,null,$e(ee.value,f=>(d(),I(se,{key:f.id},[it.value[f.address]?g("",!0):(d(),$(Fe,{key:0,data:f,project:o.value,cancelLoading:fe.value,delLoading:be.value,onCancelItem:At,onDelItem:Rt},null,8,["data","project","cancelLoading","delLoading"]))],64))),128))]),_:1},8,["loading","finished","finished-text"])])]),e("section",Ba,[o.value.status==c(q).PUBLISHED||o.value.status==c(q).NOT_PUBLISHED?(d(),$(_,{key:0,class:"w-full btn main-btn rounded bg-main",onClick:xe,loading:F.value},{default:m(()=>[e("span",La,t(l.$t("Canceling crowdfunding")),1)]),_:1},8,["loading"])):g("",!0),o.value.status==c(q).IN_PROGRESS?(d(),I(se,{key:1},[o.value.targetType!=c(Te).POINT?(d(),$(_,{key:0,class:"w-full btn main-btn rounded bg-main",onClick:xe,loading:F.value},{default:m(()=>[e("span",Va,t(l.$t("Canceling crowdfunding")),1)]),_:1},8,["loading"])):g("",!0)],64)):g("",!0),o.value.status==c(q).FAILED?(d(),$(_,{key:2,class:"w-full btn main-btn rounded bg-main",onClick:Dt},{default:m(()=>[e("span",Ua,t(l.$t("If crowdfunding fails you can launch other projects")),1)]),_:1})):g("",!0),o.value.status==c(q).SUCCEED&&o.value.history===!1?(d(),I("div",Aa,[o.value.targetType!=c(Te).POINT?(d(),$(_,{key:0,class:"w-full btn square-btn rounded",onClick:xe,loading:F.value},{default:m(()=>[e("span",Fa,t(l.$t("Canceling crowdfunding")),1)]),_:1},8,["loading"])):g("",!0),w(_,{class:"w-full square-btn main-btn rounded bg-main",onClick:Nt,loading:F.value},{default:m(()=>[e("span",Ra,t(l.$t("Crowdfunding is successful click to confirm")),1)]),_:1},8,["loading"])])):g("",!0),o.value.status==c(q).CONFIRMED&&o.value.history===!1&&o.value.withdrawn===!1?(d(),$(_,{key:4,class:"w-full main-btn rounded bg-main",onClick:Ot,loading:F.value},{default:m(()=>[e("span",qa,t(l.$t("Receive crowdfunding amount")),1)]),_:1},8,["loading"])):g("",!0),o.value.status==c(q).CONFIRMED&&o.value.history===!1&&o.value.withdrawn===!0?(d(),I("div",za,[h.value?(d(),$(_,{key:0,class:"w-full square-btn rounded bg-main",onClick:st},{default:m(()=>[e("span",Ha,t(l.$t("manage")),1)]),_:1})):g("",!0),w(_,{class:"w-full square-btn rounded bg-main",onClick:lt},{default:m(()=>[e("span",Ja,t(l.$t("Dividend Details")),1)]),_:1}),h.value?(d(),$(_,{key:1,class:"w-full square-btn rounded",onClick:a[2]||(a[2]=f=>c(B)(!0))},{default:m(()=>[e("span",Ga,t(l.$t("Supplementary Recording")),1)]),_:1})):g("",!0),w(_,{class:"w-full square-btn main-btn rounded bg-main",onClick:ot},{default:m(()=>[e("span",Ka,t(l.$t("Dividends")),1)]),_:1})])):g("",!0),o.value.status==c(q).CONFIRMED&&o.value.history===!0?(d(),I("div",Wa,[h.value?(d(),$(_,{key:0,class:"w-full square-btn rounded bg-main",onClick:st},{default:m(()=>[e("span",Za,t(l.$t("manage")),1)]),_:1})):g("",!0),w(_,{class:"w-full square-btn rounded bg-main",onClick:lt},{default:m(()=>[e("span",Qa,t(l.$t("Dividend Details")),1)]),_:1}),h.value?(d(),$(_,{key:1,class:"w-full square-btn rounded",onClick:a[3]||(a[3]=f=>c(B)(!0))},{default:m(()=>[e("span",Xa,t(l.$t("Supplementary Recording")),1)]),_:1})):g("",!0),w(_,{class:"w-full square-btn main-btn rounded bg-main",onClick:ot},{default:m(()=>[e("span",Ya,t(l.$t("Dividends")),1)]),_:1})])):g("",!0)]),w(Da,{show:c(S),"onUpdate:show":a[4]||(a[4]=f=>ue(S)?S.value=f:null),project:o.value,onSelected:Et},null,8,["show","project"]),w(Ye,{show:c(u),"onUpdate:show":a[5]||(a[5]=f=>ue(u)?u.value=f:null),"dividend-loading":ve.value,selectedToken:nt.value,close:Lt,project:o.value,onConfirm:Vt},null,8,["show","dividend-loading","selectedToken","project"]),w(fa,{show:c(v),"onUpdate:show":a[6]||(a[6]=f=>ue(v)?v.value=f:null),project:o.value,onSuccess:qt},null,8,["show","project"]),w(ul,{show:c(j),"onUpdate:show":a[7]||(a[7]=f=>ue(j)?j.value=f:null),onClose:a[8]||(a[8]=f=>c(k)(!1)),url:kt.value},null,8,["show","url"]),w(hl,{show:c(G),"onUpdate:show":a[9]||(a[9]=f=>ue(G)?G.value=f:null),list:Ct.value,project:o.value,currentPoint:tt.value,projectBonusId:ye.value,onRefresh:Ut},null,8,["show","list","project","currentPoint","projectBonusId"])])}}},[["__scopeId","data-v-7308e288"]])});export{_l as __tla,ft as default};
