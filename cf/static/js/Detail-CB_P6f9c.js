import{c as ae,d as le,e as o,t as J,g as Te,s as se,T as fe,n as z,U as Xt,m as Ae,V as ie,F as we,r as P,W as j,w as Ee,X as Ea,Y as Ie,Z as Se,$ as Zt,a0 as Ht,a1 as qt,j as Ia,a2 as Sa,a3 as Ce,a4 as Ca,a5 as Pa,a6 as _a,_ as Pe,x as v,y as L,H as u,z as t,C as n,a7 as ea,E as A,a8 as ta,v as aa,K as la,M as ka,a9 as Oa,A as y,aa as K,ab as be,N as O,ac as Ma,O as sa,P as Ua,o as Ra,ad as Ba,ae as Da,Q as _,G as Fa,J as Va,af as $a,ag as ja,__tla as La}from"./index-Ce_DXvk7.js";import{s as Wa,I as Qa}from"./index-DRZPo-Ru.js";import{D as Ya,I as za,_ as Ja}from"./InviteCodePop-Dn-Exw4N.js";import{_ as Ka}from"./arrow-right-s-line-mCSGMM6G.js";import{a as p,T as W,R as G}from"./projectEnum-9kZKCKr4.js";import{a as Ga,p as Xa,b as Za,_ as Ha,c as qa}from"./cf-D0X9PrTD.js";import{_ as ia,u as el}from"./useCountdown-DD4s2lb6.js";import{F as tl}from"./index-BwvP83fo.js";import{f as al,e as na,__tla as ll}from"./flashMallContract-BaBlVuqw.js";import{c as sl,__tla as il}from"./cfContract-XFp0fv1b.js";import{S as nl}from"./StateTimeBar-C7QRNDIm.js";import{_ as ge}from"./TokenAmount-V2Bwu2KM.js";import{d as ol}from"./dark-close-SpaTsRy-.js";import{_ as oa}from"./DataRow-0sSszyJ5.js";import{u as ul}from"./index-BmORpdFZ.js";import{__tla as rl}from"./contractHelper-BHednLWH.js";import"./MAI-BT7NZAfN.js";let ua,cl=Promise.all([(()=>{try{return La}catch{}})(),(()=>{try{return ll}catch{}})(),(()=>{try{return il}catch{}})(),(()=>{try{return rl}catch{}})()]).then(async()=>{const[ra,ca]=ae("divider"),da=se(le({name:ra,props:{dashed:Boolean,hairline:J,vertical:Boolean,contentPosition:Te("center")},setup:(e,{slots:m})=>()=>{var d;return o("div",{role:"separator",class:ca({dashed:e.dashed,hairline:e.hairline,vertical:e.vertical,[`content-${e.contentPosition}`]:!!m.default&&!e.vertical})},[!e.vertical&&((d=m.default)==null?void 0:d.call(m))])}})),[ma,pa]=ae("skeleton-title");var va=se(le({name:ma,props:{round:Boolean,titleWidth:z},setup:e=>()=>o("h3",{class:pa([{round:e.round}]),style:{width:fe(e.titleWidth)}},null)}));const[fa,wa]=ae("skeleton-avatar");var ba=se(le({name:fa,props:{avatarSize:z,avatarShape:Te("round")},setup:e=>()=>o("div",{class:wa([e.avatarShape]),style:Xt(e.avatarSize)},null)}));const he="100%",ga={round:Boolean,rowWidth:{type:z,default:he}},[ha,ya]=ae("skeleton-paragraph");var xa=se(le({name:ha,props:ga,setup:e=>()=>o("div",{class:ya([{round:e.round}]),style:{width:e.rowWidth}},null)}));const[Na,_e]=ae("skeleton"),Ta=se(le({name:Na,inheritAttrs:!1,props:{row:ie(0),round:Boolean,title:Boolean,titleWidth:z,avatar:Boolean,avatarSize:z,avatarShape:Te("round"),loading:J,animate:J,rowWidth:{type:[Number,String,Array],default:he}},setup(e,{slots:m,attrs:d}){const C=()=>{if(e.avatar)return o(ba,{avatarShape:e.avatarShape,avatarSize:e.avatarSize},null)},F=()=>{if(e.title)return o(va,{round:e.round,titleWidth:e.titleWidth},null)},f=N=>{const{rowWidth:E}=e;return E===he&&N===+e.row-1?"60%":Array.isArray(E)?E[N]:E};return()=>{var N;return e.loading?o("div",Ae({class:_e({animate:e.animate,round:e.round})},d),[m.template?m.template():o(we,null,[C(),o("div",{class:_e("content")},[F(),Array(+e.row).fill("").map((E,M)=>o(xa,{key:M,round:e.round,rowWidth:fe(f(M))},null))])])]):(N=m.default)==null?void 0:N.call(m)}}})),[Aa,de]=ae("stepper"),me=(e,m)=>String(e)===String(m);let ke,Oe,Me,Ue,ye,Re,Be,De,Fe,Ve,$e,je,Le,We,Qe,Ye,ze,Je,Ke,Ge,Xe,Ze,He,qe,et,tt,at,lt,st,it,nt,ot,ut,rt,ct,dt,mt,pt,vt,ft,wt,bt,gt,ht,yt,xt,Nt,Tt,At,Et,It,St,Ct,Pt,_t,kt,Ot,Mt,Ut,Rt,Bt,Dt,Ft,Vt,$t,jt,Lt,Wt,Qt;ke=se(le({name:Aa,props:{min:ie(1),max:ie(1/0),name:ie(""),step:ie(1),theme:String,integer:Boolean,disabled:Boolean,showPlus:J,showMinus:J,showInput:J,longPress:J,autoFixed:J,allowEmpty:Boolean,modelValue:z,inputWidth:z,buttonSize:z,placeholder:String,disablePlus:Boolean,disableMinus:Boolean,disableInput:Boolean,beforeChange:Function,defaultValue:ie(1),decimalLength:z},emits:["plus","blur","minus","focus","change","overlimit","update:modelValue"],setup(e,{emit:m}){const d=(s,i=!0)=>{const{min:l,max:b,allowEmpty:I,decimalLength:x}=e;return I&&s===""||(s=(s=Ht(String(s),!e.integer))===""?0:+s,s=Number.isNaN(s)?+l:s,s=i?Math.max(Math.min(+b,s),+l):s,qt(x)&&(s=s.toFixed(+x))),s};let C;const F=P(),f=P((()=>{var s;const i=(s=e.modelValue)!=null?s:e.defaultValue,l=d(i);return me(l,e.modelValue)||m("update:modelValue",l),l})()),N=j(()=>e.disabled||e.disableMinus||+f.value<=+e.min),E=j(()=>e.disabled||e.disablePlus||+f.value>=+e.max),M=j(()=>({width:fe(e.inputWidth),height:fe(e.buttonSize)})),U=j(()=>Xt(e.buttonSize)),r=s=>{e.beforeChange?Ca(e.beforeChange,{args:[s],done(){f.value=s}}):f.value=s},w=()=>{if(C==="plus"&&E.value||C==="minus"&&N.value)return void m("overlimit",C);const s=C==="minus"?-e.step:+e.step,i=d(Pa(+f.value,s));r(i),m(C)},X=s=>{const i=s.target,{value:l}=i,{decimalLength:b}=e;let I=Ht(String(l),!e.integer);if(qt(b)&&I.includes(".")){const S=I.split(".");I=`${S[0]}.${S[1].slice(0,+b)}`}e.beforeChange?i.value=String(f.value):me(l,I)||(i.value=I);const x=I===String(+I);r(x?+I:I)},ne=s=>{var i;e.disableInput?(i=F.value)==null||i.blur():m("focus",s)},a=s=>{const i=s.target,l=d(i.value,e.autoFixed);i.value=String(l),f.value=l,Ia(()=>{m("blur",s),Sa()})};let R,Q;const V=()=>{Q=setTimeout(()=>{w(),V()},200)},Z=s=>{e.longPress&&(clearTimeout(Q),R&&Ce(s))},k=s=>{e.disableInput&&Ce(s)},H=s=>({onClick:i=>{Ce(i),C=s,w()},onTouchstartPassive:()=>{C=s,e.longPress&&(R=!1,clearTimeout(Q),Q=setTimeout(()=>{R=!0,w(),V()},_a))},onTouchend:Z,onTouchcancel:Z});return Ee(()=>[e.max,e.min,e.integer,e.decimalLength],()=>{const s=d(f.value);me(s,f.value)||(f.value=s)}),Ee(()=>e.modelValue,s=>{me(s,f.value)||(f.value=d(s))}),Ee(f,s=>{m("update:modelValue",s),m("change",s,{name:e.name})}),Ea(()=>e.modelValue),()=>o("div",{role:"group",class:de([e.theme])},[Ie(o("button",Ae({type:"button",style:U.value,class:[de("minus",{disabled:N.value}),{[Zt]:!N.value}],"aria-disabled":N.value||void 0},H("minus")),null),[[Se,e.showMinus]]),Ie(o("input",{ref:F,type:e.integer?"tel":"text",role:"spinbutton",class:de("input"),value:f.value,style:M.value,disabled:e.disabled,readonly:e.disableInput,inputmode:e.integer?"numeric":"decimal",placeholder:e.placeholder,autocomplete:"off","aria-valuemax":e.max,"aria-valuemin":e.min,"aria-valuenow":f.value,onBlur:a,onInput:X,onFocus:ne,onMousedown:k},null),[[Se,e.showInput]]),Ie(o("button",Ae({type:"button",style:U.value,class:[de("plus",{disabled:E.value}),{[Zt]:!E.value}],"aria-disabled":E.value||void 0},H("plus")),null),[[Se,e.showPlus]])])}})),Oe={key:0,class:"w-full state-tag success"},Me={key:1,class:"w-full state-tag failed"},Ue=Pe({__name:"StateTag",props:{detail:{type:Object,default:()=>{}}},setup:e=>(m,d)=>(v(),L("div",null,[e.detail.status==u(p).CONFIRMED||e.detail.status==u(p).SUCCEED?(v(),L("div",Oe,[t("span",null,n(m.$t("Project in"))+" "+n(u(ea)(e.detail.finishTime||e.detail.endTime)||"--")+" "+n(m.$t("projectStatus.succeed")),1)])):A("",!0),e.detail.status==u(p).FAILED?(v(),L("div",Me,[t("span",null,n(m.$t("Project in"))+" "+n(u(ea)(e.detail.endTime))+" "+n(m.$t("projectStatus.failed")),1)])):A("",!0)]))},[["__scopeId","data-v-3821088b"]]),ye="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAATlSURBVHgB7Zw9cBtFFMf/7w7iUGSicYChIXMUdDBRagrsNg1Omcou6Ww3MaqsFGDiRs4MPaZKidLQWpmB2s5AR4ESGgawRw4N8oz2sbsnYcfRfen29k7S/mbkkbVr3d3fb/e9ffsBOBwOh8PhKAdCyfBOLQD8JRDdAnEA5vqwKLhUtStfPXnL6nUk6z2D7x3R/b+OUCLWBeRmUMPCPytSrE/l1VfAqCEPpEXtQOAJ+tfa1Oz2YBFrAvLO29LK8BlIrOUWLRbah+c9smWZhQsYCsfb8t0SrCKtkukBNf7uoEAKE5B336lDiJZ94S5B1IZ4c5Maf3RRAMYF1H3cWy/XZTNtokoQmrR18gCGMSog77wXgM6+l2/rqCZd8JVlk9bowRD88MYqvLNDVFc8RaDukR8ubsAQRgSUN7Qt47L9Yr2rIdQ9Mlr6ng2QuwmH4lWsv0uLgX4xl4BTLd6InCJOLOBMiDcih4gTCci7i+ty6LSHWYJojbaOv0NGMguoQxXlbafBYWRBjanFldtZQ5zsXpjODmZOPIV6JhnD6oFABjIJOHT9AWaXOhZeZooRUzfh4SjjN8wDnn87bTYnvQV6/RbmBZ0ESUcqCwxTUuIA8wR7y2lSYW8gDTqfZ5HrN4E73wDvfhT+/usPwE+7wOkLWCN85k5itaQK/KXM6/mDQ9jk88NQxIso8b5dAvqnsEYKK0zuA32xDpt8eOd18RTqM1VmFV5JqhErILdqMibiNdhk1GzHcf19WMXj1aS4MN4C//UT/wPGOf09uuzPX2AVFVyrGcQY4gVUs2i2UQ5jnLNQn6ky26jp1xgSBCxhQkg5icfy//bzY9kCTsPXix/Dz8pAzV3HFkdQivetKiw+oEavO64o2gI9UeW5Dcv4S1El0QISOwHPidQiZiRCt5QbKoUqjEQuQiKIKooWkLhWln649+TVYPrje8DNT+yPRP5HGdN4optwWUnTSo1EkokLYwKUQZVGIucEUQXGVibMK07AnDgBcxInYBeOEd2oAmeBadDrsMcTIyCVuvq9UjBNIiA/hyOE8SyqKCaQdhZ4gUgtYixw0IEjxB9kF1Dnv2I6z7lBakD3e5NYoETt/pl3mJ/GFSeEMdTBvMNeO644XsCrg7b1ZlylWTlF/9rkAtJmryddeOZVm7mo1qzcftLmxeSRSIIJG6dKs3KeeJRUJd3qrK9vHJS+58061KEvjpeTaqUbCzMZ32NWeVI+cyoBwxVKc+SRidppt8lmWKE62MS8INI/a2oBdTTOmP2mLJ8xahXCOLLlA6+KPel2ZjnJ0KXGSTPLH2QSUMeFQtydyTGyeiYWiV73Mpkz0tq8Bc1if5ip6Y6YKKVPjeP9meoPVb+3dTLR3r982113FpvyG+yu4DeNdhrZ+r2L5N9wPc0i5hRPYeTQiakU0YB4CmOndvBXixvwsV35nZx6Wytt6n7cyNcZRB8kRp7aEhagmsjBgLg7ibeNopCTiyrZpFXU0Bd71OwZjWGLO/pJWyO15CXs7zV5BZkEkeP4uImhXN+OgnGHjxmCd2t1DLwNecVVFIV2EGoKwmsXLdz5JS3DzVoNC/6KTJfLHD0tGTmAkdGW1vYU/UHbdB+XfPmSCS3Tr8t39eExoLWhqMGlql39k/hIhiHPw8VPg45Jj+pwOBwOh2Oa+A8u5MgcyAHD5wAAAABJRU5ErkJggg==",Re={class:"content relative p-4"},Be={class:"title relative"},De={class:"w-full mt-4"},Fe={class:"mt-4"},Ve={class:"mt-4"},$e={class:"text-b3 text-sm font-normal"},je={key:0},Le={class:"mt-4"},We={class:"text-b1 text-sm font-semibold"},Qe={class:"text-b2 text-sm font-normal mt-3 max-h-[160px] overflow-y-auto"},Ye={class:"submit-form"},ze={class:"form-item flex flex-row justify-start items-center"},Je={class:"text-sm text-b3 whitespace-nowrap pr-2"},Ke={class:"flex justify-between items-center mt-3"},Ge={class:"text-sm text-b3 whitespace-nowrap pr-2"},Xe={class:"mt-3"},Ze={key:0,class:"text-right text-b1 text-sm font-semibold mt-3 whitespace-nowrap"},He={class:"submit__wrap mt-3"},qe={class:"text-b1 text-base font-normal"},et={class:"flex flex-col justify-center items-center"},tt=["alt"],at={class:"text-b2 text-sm font-normal text-center mt-3"},lt={class:"flex flex-col justify-center items-center"},st=["alt"],it={class:"text-b2 text-sm font-normal text-center mt-3"},nt={class:"flex flex-col justify-center items-center"},ot=["alt"],ut={class:"text-b2 text-sm font-normal text-center mt-3"},rt=Pe({__name:"ParticipationPop",props:ta({show:{type:Boolean,default:!1},detail:{type:Object,default:()=>({})},time:{type:String,default:"--"},isFMUser:{type:Boolean,default:!1}},{modelValue:{},modelModifiers:{}}),emits:ta(["update:show","success","error"],["update:modelValue"]),setup(e,{emit:m}){const{t:d}=aa(),{join:C}=sl(),{trade:F,pointBalances:f}=al(),{accountStore:N}=la(),E=ka(),M=Oa(e,"modelValue"),U=m,r=e,w=P({projectId:"",remark:"",count:1,txId:""}),X=P({hasPaid:!1,totalMai:"",totalMcoin:"",totalPoint:""}),ne=j(()=>new K(r.detail.pointPer||0).times(w.value.count).times(1).toString()),a=j(()=>new K(r.detail.pointPer||0).times(w.value.count).times(5).toString()),R=P(!1),Q=()=>{R.value=!1,E.replace("/participated")},V=P(!1),Z=()=>{V.value=!1},k=P(!1),H=()=>{k.value=!1},s=P(!1),i=j(()=>na(be.MAI)),l=j(()=>na(be.MCOIN)),b=j(()=>{const c=new K(w.value.count),g=new K(r.detail.mcoinPer||0),q=new K(r.detail.maiPer||0),oe=new K(r.detail.pointPer||0);return{mcoin:c.times(g),mai:c.times(q),point:c.times(oe)}}),I=async()=>{var ee;if(!r.isFMUser&&r.detail.targetType!==W.POINT)return void(k.value=!0);const c=await Ga({projectId:r.detail.id,address:N.account}),g=Number((ee=c.data)==null?void 0:ee.num)||0,q=Number(r.detail.maxNumPerUser)||0,oe=Number(r.detail.collectedNum)||0,xe=Number(r.detail.targetNum)||0,pe=Number(w.value.count)||0,Ne=r.detail.allowExceed||!1;if(g+pe>q){const h=q-g;O(`${d("Purchased")}${g}${d("You can buy up to")}${h}${d("serving")}`)}else{if(!Ne){const h=xe-oe;if(h<pe)return void O(`${d("you can purchase at most")}${h}${d("serving")}`)}try{if(s.value=!0,!await(async()=>{var Yt,zt,Jt,Kt,Gt;const T=be.crowdfunding,Y=be.flashMall,te=Number(w.value.count)||1,ve=Number(r.detail.maiPer)*te,$=Number(r.detail.mcoinPer)*te,re=Number(r.detail.pointPer)*te;if(r.detail.targetType===W.MAI){const B=await i.value.allowance(T);if(Number(B.result)===0||Number(B.result)<ve){const D=await i.value.approve(T);if(!D.success)return((Yt=D.result)==null?void 0:Yt.code)=="ACTION_REJECTED"&&O(d("User cancels authorization")),!1}}else if(r.detail.targetType===W.MCOIN){const B=await l.value.allowance(T);if(Number(B.result)===0||Number(B.result)<$){const D=await l.value.approve(T);if(!D.success)return((zt=D.result)==null?void 0:zt.code)=="ACTION_REJECTED"&&O(d("User cancels authorization")),!1}}else if(r.detail.targetType===W.MCOIN_MAI){const B=await i.value.allowance(T),D=await l.value.allowance(T);if(Number(B.result)===0||Number(B.result)<ve){const ce=await i.value.approve(T);if(!ce.success)return((Jt=ce.result)==null?void 0:Jt.code)=="ACTION_REJECTED"&&O(d("User cancels authorization")),!1}if(Number(D.result)===0||Number(D.result)<$){const ce=await l.value.approve(T);if(!ce.success)return((Kt=ce.result)==null?void 0:Kt.code)=="ACTION_REJECTED"&&O(d("User cancels authorization")),!1}}else if(r.detail.targetType===W.POINT){const B=await l.value.allowance(Y);if(Number(B.result)===0||Number(B.result)<re){const D=await l.value.approve(Y);if(!D.success)return((Gt=D.result)==null?void 0:Gt.code)=="ACTION_REJECTED"&&O(d("User cancels authorization")),!1}}return!0})()||!await(async()=>{const T=Number(w.value.count)||1,Y=Number(r.detail.maiPer)*T,te=Number(r.detail.mcoinPer)*T,ve=Number(r.detail.pointPer)*T;if(r.detail.targetType===W.MAI){const $=await i.value.balanceOf();if(Number($)<Y)return k.value=!0,!1}else if(r.detail.targetType===W.MCOIN){const $=await l.value.balanceOf();if(Number($)<te)return k.value=!0,!1}else if(r.detail.targetType===W.MCOIN_MAI){const $=await i.value.balanceOf(),re=await l.value.balanceOf();if(Number($)<Y||Number(re)<te)return k.value=!0,!1}else if(r.detail.targetType===W.POINT){const $=await l.value.balanceOf(),re=await f();if(Number($)+Number(re)<ve)return k.value=!0,!1}return!0})())return;let ue=null;if(r.detail.targetType==W.POINT){if(!r.isFMUser)return void O(d("Only available to registered users"));const T=new K(r.detail.pointPer).times(w.value.count).toString();ue=await F(N.account,T,r.detail.creator)}else ue=await C({id:r.detail.id,count:w.value.count});if(ue.success){const T={projectId:r.detail.id,txId:ue.result.hash,remark:w.value.remark};Xa(T).then(Y=>{Y.code===200&&(V.value=!0,S("success"),Ma().delCachedView({name:"Participated"}),sessionStorage.setItem("reset_participated_scroll",1),setTimeout(()=>{E.replace("/participated")},800))}).catch(Y=>{O(Y.message),S("error")}).finally(()=>{s.value=!1})}else ue.result.code==="ACTION_REJECTED"&&O(d("User cancels the operation"))}catch{O(d("please try again later")),S("error")}finally{s.value=!1}}},x=()=>{U("update:show",!1)},S=(c="default")=>{U("update:show",!1),c==="success"?(X.value={hasPaid:!1,totalMai:"",totalMcoin:"",totalPoint:""},U("success")):c==="error"&&U("error")};return(c,g)=>{const q=da,oe=tl,xe=ke,pe=sa,Ne=Ua,ee=Ya;return v(),L("div",null,[o(Ne,{show:M.value,"onUpdate:show":g[2]||(g[2]=h=>M.value=h),round:"",position:"bottom","close-on-click-overlay":"",onClose:S,closeable:"",onClickOverlay:x,"close-icon":u(ol)},{default:y(()=>[t("div",Re,[t("div",Be,[t("p",{class:"text-b1 text-lg font-semibold text-center",onClickCapture:x},n(c.$t("Participation in projects")),33)]),t("div",De,[o(nl,{time:e.time,data:e.detail,status:e.detail.status},null,8,["time","data","status"])]),t("div",Fe,[o(ia,{class:"mt-1",progress:e.detail.progress,count:e.detail.collectedNum,total:e.detail.targetNum,status:e.detail.status},null,8,["progress","count","total","status"])]),t("div",Ve,[o(ge,{title:c.$t("Per Serving"),mcoin:e.detail.mcoinPer,mai:e.detail.maiPer,point:e.detail.pointPer,type:e.detail.targetType,"point-text":c.$t("Give points")},{default:y(()=>[t("p",$e,[t("span",null,n(c.$t("Per Serving")),1),e.detail.maxNumPerUser?(v(),L("span",je,"("+n(c.$t("Limit per person"))+n(e.detail.maxNumPerUser)+n(c.$t("serving"))+")",1)):A("",!0)])]),_:1},8,["title","mcoin","mai","point","type","point-text"])]),t("div",Le,[t("p",We,n(c.$t("Expected Return")),1),t("div",Qe,[t("p",null,n(e.detail.content),1)])]),o(q,{style:{margin:"12px 0"}}),t("div",Ye,[t("div",ze,[t("p",Je,n(c.$t("Remarks")),1),o(oe,{modelValue:w.value.remark,"onUpdate:modelValue":g[0]||(g[0]=h=>w.value.remark=h),placeholder:c.$t("Enter remarks"),maxlength:"20",class:"remark-input bg-[#d63838] rounded-md ml-auto"},null,8,["modelValue","placeholder"])]),t("div",Ke,[t("p",Ge,n(c.$t("Participants Number")),1),o(xe,{modelValue:w.value.count,"onUpdate:modelValue":g[1]||(g[1]=h=>w.value.count=h),class:"ml-auto",integer:"",min:1,"disable-input":"",max:e.detail.maxNumPerUser||e.detail.targetNum},null,8,["modelValue","max"])]),t("div",Xe,[o(ge,{title:c.$t("total"),mcoin:b.value.mcoin,mai:b.value.mai,point:b.value.point,type:e.detail.targetType,"point-text":c.$t("Give points")},null,8,["title","mcoin","mai","point","type","point-text"])]),e.detail.targetType===4?(v(),L("div",Ze,[t("span",null,n(c.$t("You will receive")),1),t("span",null,n(ne.value),1),t("span",null,n(c.$t("Points the sponsor will receive")),1),t("span",null,n(a.value),1),t("span",null,n(c.$t("integral")),1)])):A("",!0)]),t("div",He,[o(pe,{class:"w-full btn main-btn rounded bg-main",onClick:I,loading:s.value,disabled:s.value},{default:y(()=>[t("span",qe,n(c.$t("participate-now")),1)]),_:1},8,["loading","disabled"])])])]),_:1},8,["show","close-icon"]),o(ee,{"class-name":"notice-dialog",show:R.value,"onUpdate:show":g[3]||(g[3]=h=>R.value=h),onClick:Q,"show-confirm-button":!1,"close-on-click-overlay":""},{default:y(()=>[t("div",et,[t("img",{src:ye,class:"w-10 h-10",alt:c.$t("warn")},null,8,tt),t("p",at,n(c.$t("You cant participate in your own project")),1)])]),_:1},8,["show"]),o(ee,{"class-name":"notice-dialog",show:k.value,"onUpdate:show":g[4]||(g[4]=h=>k.value=h),onClick:H,"show-confirm-button":!1,"close-on-click-overlay":""},{default:y(()=>[t("div",lt,[t("img",{src:ye,class:"w-10 h-10",alt:c.$t("warn")},null,8,st),t("p",it,n(c.$t("errorMsg.insufficient funds")),1)])]),_:1},8,["show"]),o(ee,{"class-name":"notice-dialog",show:V.value,"onUpdate:show":g[5]||(g[5]=h=>V.value=h),onClick:Z,"show-confirm-button":!1,"close-on-click-overlay":""},{default:y(()=>[t("div",nt,[t("img",{src:"/cf/static/png/success-_H-swI1n.png",class:"w-10 h-10",alt:c.$t("success")},null,8,ot),t("p",ut,n(c.$t("Participate in success")),1)])]),_:1},8,["show"])])}}},[["__scopeId","data-v-0e64b317"]]),ct={class:"page__container bg-white all-white-bg"},dt={class:"fixed top-0 w-full right-0 left-0 bg-white z-10"},mt={class:"mt-[44px] pb-[78px] bg-white"},pt={class:"py-4 px-3"},vt={class:"w-full h-[52px] bg-white py-4 px-3"},ft={class:"rich-text w-full min-h-[100px] bg-white py-4"},wt={class:"project-title px-3"},bt={class:"content w-full mt-4 px-3"},gt={class:"py-4 px-3"},ht={class:"w-full"},yt={class:"text-b1 text-lg font-semibold line-clamp-2"},xt={class:"w-full"},Nt={class:"mt-4"},Tt={class:"mt-4"},At={class:"text-b1 text-sm font-semibold"},Et={class:"ml-1"},It={class:"text-b1 text-sm font-semibold"},St={class:"w-full h-[52px] bg-white py-4 px-3"},Ct={class:"text-b1 text-sm font-normal"},Pt={class:"rich-text w-full min-h-[100px] bg-white py-4"},_t={class:"project-title px-3"},kt={class:"text-b1 text-sm font-normal"},Ot={class:"content w-full mt-4"},Mt={class:"text-b1 text-sm font-normal px-3"},Ut={class:"mt-4"},Rt={class:"w-full fixed bottom-0 left-0 right-0 py-4 px-3 flex justify-between gap-3"},Bt={class:"text-b2 text-base font-semibold"},Dt={class:"text-b1 text-base font-normal"},Ft={class:"text-white text-base font-normal"},Vt={class:"text-white text-base font-normal"},$t={class:"text-b1 text-base font-normal"},jt={class:"text-b1 text-base font-normal"},Lt={class:"text-b1 text-base font-normal"},Wt={class:"text-b1 text-base font-normal"},Qt={class:"text-b1 text-base font-normal"},ua=Pe({__name:"Detail",setup(e){const{accountStore:m}=la(),[d,C]=ul(!1),{t:F}=aa(),f=$a(),N=P(f.params.id);N.value||router.replace("/404");const E=j(()=>window.location.origin+"/cf/#/detail/"+a.value.id),M=P(!1),U=P(!1),{remainingTimeText:r,endFlag:w,startCountdown:X,stopCountdown:ne}=el({endText:F("ended"),onEnd:()=>{V()}}),a=P({id:null,title:null,address:null,startTime:null,endTime:null,createTime:null,targetType:null,targetNum:null,collectedNum:null,status:null,targetMcoin:null,targetMai:null,targetPoint:null,collectedMcoin:null,collectedMai:null,collectedPoint:null,progress:null,participantNum:null,groupType:null,groupUrl:null,content:null,imageIds:null,relatedType:null}),R=P(!1),Q=P(0),V=async()=>{if(Q.value++,Q.value>5)return void console.warn("\u5237\u65B0\u9875\u9762\uFF0C\u65E0\u6CD5\u7EE7\u7EED\u83B7\u53D6\u9879\u76EE\u8BE6\u60C5");const i={id:N.value};U.value=!0;try{const l=await Za(i);if(l.code===200&&l.success){const b=l.data;a.value=b,U.value=!1,Z()}}catch(l){console.error("\u83B7\u53D6\u9879\u76EE\u8BE6\u60C5\u5931\u8D25:",l)}},Z=()=>{a.value.status!=p.IN_PROGRESS?a.value.status!=p.NOT_STARTED||X(a.value.startTime):X(a.value.endTime)},k=()=>{M.value=!0},H=()=>{const i=a.value.groupType,l=a.value.groupUrl;i===0&&l?(ja(l,F("Discussion link copied")),setTimeout(()=>{window.open(l,"_blank")},600)):i===1&&l?s():O(F("Initiator not discussion link"))},s=()=>{const i=a.value.groupUrl||"";Wa([i])};return Ra(()=>{(async()=>{const i=m.account;qa({address:i}).then(l=>{l.success?R.value=l.data==1||l.data==2:R.value=!1})})(),V()}),Ba(()=>{ne()}),(i,l)=>{const b=Ta,I=Qa,x=sa;return v(),L("div",ct,[t("section",dt,[o(Ha,{title:i.$t("launch-detail")},Da({_:2},[a.value.id?{name:"right",fn:y(()=>[t("div",{class:"w-[22px] h-[22px]",onClick:l[0]||(l[0]=S=>u(C)(!0))},l[4]||(l[4]=[t("img",{src:Ja,class:"w-[22px] h-[22px]",alt:"Share"},null,-1)]))]),key:"0"}:void 0]),1032,["title"])]),t("section",mt,[U.value?(v(),L(we,{key:0},[t("div",pt,[o(b,{title:"",row:1,class:"mb-4"}),o(b,{title:"",row:1,class:"mb-4"}),o(b,{title:"",row:1,class:"mb-4"}),o(b,{title:"",row:3,class:"mb-4"})]),l[5]||(l[5]=t("div",{class:"divider h-2 w-full bg-[#F2F0EF]"},null,-1)),t("div",vt,[o(b,{title:"",row:1})]),l[6]||(l[6]=t("div",{class:"divider h-2 w-full bg-[#F2F0EF]"},null,-1)),t("div",ft,[t("div",wt,[o(b,{title:"",row:1})]),t("div",bt,[o(b,{title:"",row:4}),o(b,{title:"",row:1,class:"mt-4"})])])],64)):(v(),L(we,{key:1},[t("div",gt,[t("div",ht,[t("p",yt,n(a.value.title),1)]),t("div",xt,[o(Ue,{detail:a.value,class:"mt-4"},null,8,["detail"])]),t("div",Nt,[o(ia,{class:"mt-1",progress:a.value.progress,count:a.value.collectedNum,total:a.value.targetNum,status:a.value.status},null,8,["progress","count","total","status"])]),t("div",Tt,[a.value.status==u(p).IN_PROGRESS||a.value.status==u(p).SUCCEED||a.value.status==u(p).CONFIRMED||a.value.status==u(p).FAILED?(v(),_(ge,{key:0,title:i.$t("collected"),mcoin:a.value.collectedMcoin,mai:a.value.collectedMai,point:a.value.collectedPoint,type:a.value.targetType},null,8,["title","mcoin","mai","point","type"])):A("",!0),o(ge,{title:i.$t("target"),mcoin:a.value.targetMcoin,mai:a.value.targetMai,point:a.value.targetPoint,type:a.value.targetType,class:"mt-2"},null,8,["title","mcoin","mai","point","type"]),a.value.status==u(p).IN_PROGRESS||a.value.status==u(p).SUCCEED||a.value.status==u(p).CONFIRMED||a.value.status==u(p).FAILED?(v(),_(oa,{key:1,title:i.$t("participants"),class:"mt-2"},{right:y(()=>[t("span",At,n(a.value.participantNum),1),t("span",Et,n(i.$t("person")),1)]),_:1},8,["title"])):A("",!0),a.value.status==u(p).IN_PROGRESS?(v(),_(oa,{key:2,title:i.$t("remaining-time"),class:"mt-2"},{right:y(()=>[t("span",It,n(u(r)),1)]),_:1},8,["title"])):A("",!0)])]),l[8]||(l[8]=t("div",{class:"divider h-2 w-full bg-[#F2F0EF]"},null,-1)),t("div",St,[t("div",{class:"cell flex justify-between items-center",onClick:H},[t("p",Ct,n(i.$t("project-discussion")),1),l[7]||(l[7]=t("p",null,[t("img",{class:"w-5 h-5",src:Ka,alt:""})],-1))])]),l[9]||(l[9]=t("div",{class:"divider h-2 w-full bg-[#F2F0EF]"},null,-1)),t("div",Pt,[t("div",_t,[t("span",kt,n(i.$t("project-detail")),1)]),t("div",Ot,[t("section",Mt,n(a.value.content),1),t("section",Ut,[(v(!0),L(we,null,Fa(a.value.imageIds,(S,c)=>(v(),_(I,{key:c,width:"100%",src:S,"show-loading":"","show-error":""},null,8,["src"]))),128))])])])],64))]),t("section",Rt,[a.value.status==u(p).NOT_STARTED?(v(),_(x,{key:0,class:"w-full btn not-started-btn rounded"},{default:y(()=>[t("span",Bt,n(u(r))+n(u(w)?"":"\u540E\u5F00\u59CB"),1)]),_:1})):A("",!0),a.value.status==u(p).IN_PROGRESS?(v(),_(x,{key:1,class:"w-full btn main-btn rounded bg-main",onClick:k},{default:y(()=>[t("span",Dt,n(i.$t("participate-now")),1)]),_:1})):A("",!0),a.value.status==u(p).SUCCEED&&a.value.relatedType==u(G).MY?(v(),_(x,{key:2,class:"w-full btn my-success-btn rounded"},{default:y(()=>[t("span",Ft,n(i.$t("crowdfunding-success-owner")),1)]),_:1})):A("",!0),a.value.status==u(p).CONFIRMED&&a.value.relatedType==u(G).MY?(v(),_(x,{key:3,class:"w-full btn my-success-btn rounded"},{default:y(()=>[t("span",Vt,n(i.$t("crowdfunding-success-owner-2")),1)]),_:1})):A("",!0),a.value.status!=u(p).CONFIRMED&&a.value.status!=u(p).SUCCEED||a.value.relatedType!=u(G).JOIN?A("",!0):(v(),_(x,{key:4,class:"w-full btn others-success-btn rounded"},{default:y(()=>[t("span",$t,n(i.$t("crowdfunding-success-participant")),1)]),_:1})),a.value.status!=u(p).CONFIRMED&&a.value.status!=u(p).SUCCEED||a.value.relatedType!=u(G).OTHERS?A("",!0):(v(),_(x,{key:5,class:"w-full btn confirm-btn rounded"},{default:y(()=>[t("span",jt,n(i.$t("crowdfunding-success-others")),1)]),_:1})),a.value.status==u(p).FAILED&&a.value.relatedType==u(G).MY?(v(),_(x,{key:6,class:"w-full btn my-fail-btn rounded bg-main"},{default:y(()=>[t("span",Lt,n(i.$t("crowdfunding-failed-owner")),1)]),_:1})):A("",!0),a.value.status==u(p).FAILED&&a.value.relatedType==u(G).JOIN?(v(),_(x,{key:7,class:"w-full btn fail-btn rounded bg-main"},{default:y(()=>[t("span",Wt,n(i.$t("crowdfunding-failed-participant")),1)]),_:1})):A("",!0),a.value.status==u(p).FAILED&&a.value.relatedType==u(G).OTHERS?(v(),_(x,{key:8,class:"w-full btn fail-btn rounded"},{default:y(()=>[t("span",Qt,n(i.$t("crowdfunding-failed-others")),1)]),_:1})):A("",!0)]),o(rt,{modelValue:M.value,"onUpdate:modelValue":l[1]||(l[1]=S=>M.value=S),detail:a.value,time:u(r),isFMUser:R.value},null,8,["modelValue","detail","time","isFMUser"]),o(za,{show:u(d),"onUpdate:show":l[2]||(l[2]=S=>Va(d)?d.value=S:null),url:E.value,onClose:l[3]||(l[3]=S=>u(C)(!1))},null,8,["show","url"])])}}},[["__scopeId","data-v-820736a8"]])});export{cl as __tla,ua as default};
