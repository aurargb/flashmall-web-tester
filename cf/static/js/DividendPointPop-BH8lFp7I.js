import{_ as se,a8 as S,v as ae,K as ne,a9 as ie,w as oe,W as le,r as B,x as o,y as l,e as T,A,z as a,C as s,F as G,G as de,H as L,aV as re,E as p,aj as ue,ab as ce,aa as U,aU as ve,N as u,O as me,P as pe,__tla as fe}from"./index-Ce_DXvk7.js";import{d as be}from"./dark-close-SpaTsRy-.js";import{f as he,e as we,__tla as ye}from"./flashMallContract-BaBlVuqw.js";import{c as xe,l as _e}from"./cf-D0X9PrTD.js";let z,ge=Promise.all([(()=>{try{return fe}catch{}})(),(()=>{try{return ye}catch{}})()]).then(async()=>{let _,g,j,I,N,P,k,M,$,C,D,F,O;_={class:"content relative p-4"},g={class:"title relative"},j={class:"text-b1 text-lg font-semibold text-center"},I={class:"info-detail rounded-xl mt-3"},N={class:"relative max-h-[70vh] overflow-y-auto"},P={class:"flex items-center justify-between"},k={class:"text-b1 text-sm font-semibold"},M={class:"flex items-center justify-between mt-2"},$={class:"text-[#FF8812] text-sm font-semibold"},C={class:"text-b1 text-sm font-semibold flex items-center justify-end gap-1"},D={key:0},F={key:1},O={key:2},z=se({__name:"DividendPointPop",props:S({project:{type:Object,default:()=>{}},list:{type:Array,default:()=>[]},currentPoint:{type:[Number,String],default:0},projectBonusId:{type:[String,Number],default:""}},{show:{},showModifiers:{}}),emits:S(["update:show","refresh"],["update:show"]),setup(f,{emit:E}){const{t:c}=ae(),{accountStore:H}=ne(),{trade:K,pointBalances:V}=he(),b=ie(f,"show"),v=E,d=f;oe(b,t=>{t||(m.value={},n.value=!1)});const W=le(()=>we(ce.MCOIN)),n=B(!1),m=B({}),q=t=>{const r=new U(t.num).times(d.currentPoint).times(5).div(d.project.collectedNum);return ve(r,4)},J=async(t,r)=>{const h={projectId:d.project.id,txId:t,address:r,projectBonusId:d.projectBonusId};(await _e(h)).success?(u(c("Dividend Success")),n.value=!1,v("refresh")):(v("refresh"),n.value=!1)},Q=()=>{v("update:show",!1)},R=()=>{setTimeout(()=>{m.value={}},200),v("update:show",!1)};return(t,r)=>{const h=me,X=pe;return o(),l("div",null,[T(X,{show:b.value,"onUpdate:show":r[0]||(r[0]=e=>b.value=e),round:"",position:"bottom","close-on-click-overlay":"",onClose:R,closeable:"",onClickOverlay:Q,"close-icon":L(be)},{default:A(()=>[a("div",_,[a("div",g,[a("p",j,s(t.$t("Participant List")),1)]),a("div",I,[a("div",N,[(o(!0),l(G,null,de(f.list,(e,Y)=>(o(),l("div",{key:Y,class:"w-full p-3 bg-white rounded-xl mb-4"},[a("div",P,[a("p",k,s(L(re)(e.address,"...",4,4)),1),T(h,{class:"btn main-btn flex justify-center items-center text-sm text-b1 font-semibold",role:"button",loading:e.loading,disabled:e.hasIssued||m.value[e.address]||n.value,onClick:je=>(async i=>{if(!i.address)return void u(c("Invalid participant address"));const w=new U(i.num).times(d.currentPoint).div(d.project.collectedNum).toFixed(8).toString();if(!w)return void u(c("Dividend amount is empty"));n.value=!0;const y=await xe({address:i.address});if(y.success){if(y.data!=1&&y.data!=2)return n.value=!1,void u(c("The participant is not registered in FlashMall and cannot receive bonus points"))}else n.value=!1;i.loading=!0;const Z=await W.value.balanceOf(),ee=await V();if(Number(Z)+Number(ee)<Number(w))return u(c("Insufficient balance no dividends can be distributed")),n.value=!1,void(i.loading=!1);const x=await K(H.account,w,i.address);if(x.success){n.value=!1,i.loading=!1;const te=x.result.hash;J(te,i.address),m.value[i.address]=!0,v("refresh")}else u(x.result.reason),n.value=!1,i.loading=!1})(e)},{default:A(()=>[a("span",null,s(e.hasIssued||m.value[e.address]?t.$t("Dividends paid"):t.$t("Dividends")),1)]),_:2},1032,["loading","disabled","onClick"])]),a("div",M,[a("p",$,s(t.$t("Total Crowdfunding"))+s(e.num||0)+s(t.$t("serving")),1),a("p",C,[Number(e.bonusPoint)?(o(),l("span",D,s(e.bonusPoint)+s(t.$t("integral")),1)):p("",!0),Number(e.bonusMcoin)?(o(),l("span",F,s(e.bonusMcoin)+"Mc ",1)):p("",!0),Number(e.bonusMai)?(o(),l("span",O,s(e.bonusMai)+"Mai ",1)):p("",!0),e.hasIssued?p("",!0):(o(),l(G,{key:3},[ue(s(t.$t("total"))+s(q(e))+s(t.$t("Give points")),1)],64))])])]))),128))])])])]),_:1},8,["show","close-icon"])])}}},[["__scopeId","data-v-3d59f28b"]])});export{z as D,ge as __tla};
