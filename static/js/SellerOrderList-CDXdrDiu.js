import{_ as Be,y as Re,l as wt,x as Ae,w as Je,bO as bt,E as O,F as i,G as r,H as o,X as $,a3 as Kt,Q as n,P as u,I as re,a4 as ge,J as Te,R as Ie,Y as ot,K as P,O as T,N as I,a1 as W,T as A,Z as $t,$ as kt,r as y,be as Ke,z as Ue,bf as zt,bg as ht,D as Ct,bc as ve,bd as he,bP as Ut,t as Yt,o as Wt,B as Ne,a0 as Jt,n as Qt,a2 as Zt,bQ as Xt}from"./vendor-BlU_hoYl.js";import{_ as At}from"./avatarRing-DtI_kRg6.js";import{_ as es}from"./address-BcVTHe5T.js";import{G as ts}from"./GoodsItem-DRa0dkv6.js";import{_ as ss}from"./CountdownLabel-CPOIew63.js";import{e as Ye,o as dt,b as at,l as te,u as Tt,R as os,C as as,bx as It,a4 as ns,d as xt}from"./index-Wb-6_0W_.js";import{u as _t,f as rs}from"./useOrderStatus-D1Cw0BRr.js";import{c as nt,n as rt,l as We,v as ls,w as is,x as ds,y as cs,z as us,a as ms}from"./order-pJoL_MtT.js";import{P as lt}from"./flashSale-DDyqLyYN.js";import{g as ze}from"./orderTime-9DqOwNpF.js";import{h as it,e as fs}from"./excel-B8sCVOEn.js";import{a as yt}from"./useRefund-CagomE1G.js";import{a as St}from"./useOrderActionButtons-CwgowcAa.js";import{S as ps,M as vs}from"./MerchantRefund-snWOFwKo.js";import{_ as Rt}from"./selected-icon-CfPkLSlb.js";import{_ as hs}from"./credit-0laLclE7.js";import{_ as xs}from"./MCOIN-BOqZVkND.js";import{B as ys}from"./BackIcon-8hcEjDKb.js";import{C as gs}from"./ChangeRegion-ChbrxILE.js";import ws from"./SellerOneSaleOrder-B6VBmUwJ.js";import"./mcoin-logo-1-CkjdfX51.js";import"./useShipTemplate-C35bKCd2.js";import"./enums-DlE-aiss.js";import"./copy-w-Dr8nkqKW.js";import"./UnfreezePop-Bc69tqDd.js";import"./ApproveButton-DAXiGeM3.js";import"./refund-B5IEjYwn.js";import"./category-DR69a6kO.js";import"./ChangeRegionPop-C_1haUWL.js";import"./DeliveredItem-B8U7tSqt.js";import"./GoodsItem-B-J9wBXs.js";import"./luckyShopContract-xvKlnytq.js";const bs="/static/images/mark-Dmikp-39.svg",Qe=t=>($t("data-v-7956aba1"),t=t(),kt(),t),$s={class:"gap-2 flex-center-bw"},ks=Qe(()=>o("div",{class:"w-8 h-8"},[o("img",{src:At,class:"w-full h-full rounded-md",alt:"",fit:"cover"})],-1)),Cs={class:"flex flex-col justify-center flex-1 h-8 text-default"},As={class:"text-sm font-semibold flex flex-row justify-start items-center align-middle"},Ts={key:0,class:"flex flex-row justify-start items-center"},Is={class:"text-primary ml-auto text-sm leading-[20px] align-middle"},_s={key:0},Ss={key:0},Rs={key:1},Ns={key:2},Bs={class:"text-xs leading-[18px] opacity-60"},Ls={key:0},Os={key:1},Ps={key:2},Es=Qe(()=>o("span",null,"...",-1)),Ds=[Es],Fs={class:"mt-4 pt-4 break-all flex flex-row justify-start items-start border-t-[1px] border-[#e0e0e0] border-solid"},Vs=Qe(()=>o("div",{class:"min-w-[20px]"},[o("img",{src:es,class:"inline-block w-[20px]"})],-1)),Hs={class:"ml-1"},js={key:0,class:"text-sm text-[#585654] font-semibold"},Gs={key:1,class:"mt-1 text-sm text-[#a6a6a6] font-normal"},Ms={key:1,class:"mt-2 break-all flex flex-row justify-start items-start"},qs=Qe(()=>o("div",{class:"min-w-[20px]"},[o("img",{src:bs,class:"inline-block w-[20px]"})],-1)),Ks={class:"ml-1"},zs={class:"text-sm text-[#a6a6a6] font-normal line-clamp-2"},Us={key:2,class:"pt-2.5 text-xs text-[#B9B9B9]"},Ys={class:"items-center inline"},Ws={class:"block"},Js={class:"colon"},Qs={class:"block"},Zs={class:"colon"},Xs={class:"block"},eo={class:"colon"},to={class:"block"},so={class:"colon"},oo={key:1,class:"text-right"},ao={key:3,class:"flex justify-end mt-3 gap-2"},no=Re({props:{order:null,isService:{type:Boolean},nowTime:null,tab:null},emits:["open"],setup(t,{emit:H}){const v=t,{accountStore:e}=Ye(),{clerkStore:f}=Ye(),k=wt(),R=Ae(()=>{const d=v.order||{};return St(d)}),E=Ae(()=>(v.order.orderGoods||[]).some(z=>z.buyFlag)),_=Ae(()=>{var d,C;return((C=(d=v.order)==null?void 0:d.orderLabelList)==null?void 0:C.filter(z=>z==null?void 0:z.id))||[]}),S=_t(v.order),{t:q}=Je(),h=d=>{v.isService||k.push(d)},g=()=>{v.isService||k.push(`/sellerOrderDetail?id=${v.order.id}`)},J=()=>{if(e.isOnlyView)return A(q("order.Requires merchant account operation"));k.push(`/sellerDelivery?id=${v.order.id}`)},le=()=>{if(e.isOnlyView)return A(q("order.Requires merchant account operation"));k.push({name:"SellerOrderDetail",query:{id:v.order.id},params:{quick:"quackChange"}})},D=()=>{location.reload()},se=bt("openBatchReceiptPop",null),{merchantConfirm:N}=dt(),F=async d=>{if(e.isOnlyView)return A(q("order.Requires merchant account operation"));if(f.isClerk&&!f.clerkAuth)return A(q("order.Requires merchant account operation"));if(se){se(d);return}d.loading=!0;try{const z=(await nt({orderIds:d.id})).data.ordIds,B=await N(z);if(!B.success)return;if(d.payType!==lt.STORE_CARD){if(!(await rt({ordIds:z,hash:B.result.hash})).success)return;d.merchantsConfirm=1,A.success(q("order.confirmSuccess")),k.replace({path:"/sellerOrderList",query:{active:3,type:1}})}}finally{d.loading=!1}},K=d=>{if(e.isOnlyView)return A(q("order.Requires merchant account operation"));H("open",d)},oe=d=>{if(e.isOnlyView)return A(q("order.Requires merchant account operation"));const C=d.userAddress.address;at(d.userAddress.address,"...",5,5),k.push(`/sellerOrderList-orderHistory?address=${C}&source=merchants`)};return(d,C)=>{var m,w;const z=O("van-count-down"),B=O("VanButton");return r(),i("div",{class:"px-3 mt-3 bg-white rounded-xl py-3",onClick:g},[o("div",$s,[ks,o("div",Cs,[o("div",As,[t.order.userAddress&&t.order.userAddress.address?(r(),i("div",Ts,[o("p",null,n(u(at)(t.order.userAddress.address,"...",5,5)),1)])):$("",!0),o("div",Is,[u(yt)(t.order).available?(r(),i("span",_s,n(u(yt)(t.order).label),1)):(r(),i(re,{key:1},[t.order.status==-1?(r(),i("span",Ss,n(d.$t("order.canceled")),1)):t.order.status===0&&t.order.hash?(r(),i("span",Rs,n(d.$t("order.wait block chain")),1)):(r(),i("span",Ns,n(u(S)[t.order.status+""]),1))],64))])]),o("div",Bs,[t.order.status==4?(r(),i("span",Ls,n(u(te)(t.order.finishTime))+" "+n(d.$t("common.finish")),1)):t.order.status==2?(r(),i("span",Os,n(u(te)(t.order.expressTime))+" "+n(d.$t("order.Ship")),1)):(r(),i("span",Ps,n(u(te)(t.order.createTime))+" "+n(d.$t("order.buied")),1))])])]),u(_).length?(r(),i("ul",{key:0,class:"w-full flex justify-start items-center mt-[16px] text-white overflow-x-scroll",onClick:C[1]||(C[1]=ge(p=>K(t.order),["stop"]))},[u(_).length>0?(r(),i(re,{key:0},[(r(!0),i(re,null,Te(u(_).slice(0,5),p=>(r(),i("li",{style:ot({backgroundColor:u(it)(p==null?void 0:p.colorHex,.12),color:p==null?void 0:p.colorHex}),class:Ie(["text-xxs h-[22px] rounded-[4px] px-[8px] py-1 mr-1 flex justify-center items-center font-normal whitespace-nowrap",{"w-[22px]":!(p!=null&&p.content)}]),key:p==null?void 0:p.id},n(p==null?void 0:p.content),7))),128)),u(_).length>5?(r(),i("li",{key:0,class:"bg-[#f5f5f5] text-default text-xxs w-[25px] h-[22px] rounded-[4px] py-1 mr-1 flex justify-center items-center",onClick:C[0]||(C[0]=ge(p=>K(t.order),["stop"]))},Ds)):$("",!0)],64)):$("",!0)])):$("",!0),(r(!0),i(re,null,Te(t.order.orderGoods,p=>(r(),P(ts,{class:"goods-item",creditFlag:t.order.creditFlag,payType:t.order.payType,key:p.goodsName,goods:p,storeCard:t.order.fmStoredCard,refundInfo:t.order.refundInfo,onHandleTo:h,tab:v.tab},null,8,["creditFlag","payType","goods","storeCard","refundInfo","tab"]))),128)),o("div",Fs,[Vs,o("div",Hs,[t.order.userAddress?(r(),i("div",js,n(t.order.userAddress.provinceName??"")+n(t.order.userAddress.cityName??"")+n(t.order.userAddress.countyName??"")+n(t.order.userAddress.detailInfo??""),1)):$("",!0),t.order.userAddress?(r(),i("div",Gs,n(t.order.userAddress.userName)+" "+n(t.order.userAddress.telNumber),1)):$("",!0)])]),(m=t.order.userAddress)!=null&&m.postscript?(r(),i("div",Ms,[qs,o("div",Ks,[o("div",zs,n(((w=t.order.userAddress)==null?void 0:w.postscript)||d.$t("order.noRemark")),1)])])):$("",!0),t.order.status===2?(r(),i("div",Us,[u(ze)(t.order.expressTime,t.order.confirmLimit,t.nowTime)>0?(r(),i(re,{key:0},[o("div",null,n(d.$t("order.observeTip")),1),o("div",Ys,[T(z,{class:"order-time",time:u(ze)(t.order.expressTime,t.order.confirmLimit,t.nowTime)},{default:I(p=>[o("span",Ws,n(p.days),1),o("span",Js,n(d.$t("common.day")),1),o("span",Qs,n(p.hours),1),o("span",Zs,n(d.$t("common.hours")),1),o("span",Xs,n(p.minutes),1),o("span",eo,n(d.$t("common.minutes")),1),o("span",to,n(p.seconds),1),o("span",so,n(d.$t("common.seconds")),1)]),_:1},8,["time"]),o("span",null,n(d.$t("order.sellConfirmTip")),1)])],64)):t.order.payType===u(lt).WITHDRAW_POINTS&&!t.order.merchantsConfirm?(r(),i("div",oo,n(d.$t("order.sellConfirm")),1)):$("",!0)])):$("",!0),t.isService?$("",!0):(r(),i("div",ao,[!u(e).isOnlyView&&u(E)?(r(),P(B,{key:0,class:"bg-[#f5f5f5] rounded-md h-[32px] px-3 text-[#585654] text-sm font-normal",onClick:C[2]||(C[2]=ge(p=>oe(t.order),["stop"]))},{default:I(()=>[W(n(d.$t("order.orderHistoryBuy")),1)]),_:1})):$("",!0),u(e).isOnlyView?$("",!0):(r(),P(B,{key:1,class:"bg-[#f5f5f5] rounded-md h-[32px] px-3 text-[#585654] text-sm font-normal",onClick:C[3]||(C[3]=ge(p=>K(t.order),["stop"]))},{default:I(()=>[W(n(d.$t("order.orderAddTag")),1)]),_:1})),!u(e).isOnlyView&&t.order.status===1?(r(),P(B,{key:2,class:"bg-btnOrBg rounded-md h-[32px] px-3 text-default text-sm font-normal",onClick:ge(J,["stop"])},{default:I(()=>[W(n(d.$t("order.Ship")),1)]),_:1},8,["onClick"])):$("",!0),!u(e).isOnlyView&&t.order.status===0&&!t.order.hash?(r(),P(B,{key:3,class:"bg-btnOrBg rounded-md h-[32px] px-3 text-default text-sm font-normal",onClick:ge(le,["stop"])},{default:I(()=>[W(n(d.$t("order.modifyPrice")),1),T(ss,{class:"inline-block ml-1 whitespace-nowrap",startTime:t.order.createTime,duration:15,durationType:"minutes",showZero:!1,onTimeDone:D},null,8,["startTime"])]),_:1},8,["onClick"])):$("",!0),u(R)?(r(),P(B,{key:4,class:Ie(["bg-btnOrBg rounded-md min-w-[80px] h-[32px] px-3 text-default text-sm font-semibold",{"opacity-50":!!u(e).isOnlyView}]),disabled:u(ze)(t.order.expressTime,t.order.confirmLimit,t.nowTime)>0,loading:t.order.loading,onClick:C[4]||(C[4]=ge(p=>F(t.order),["stop"]))},{default:I(()=>[W(n(d.$t("order.confirmGeted")),1)]),_:1},8,["class","disabled","loading"])):$("",!0)])),Kt(d.$slots,"default",{},void 0,!0)])}}}),ro=Be(no,[["__scopeId","data-v-7956aba1"]]),lo={class:"bg-[#f2f0ef]"},io={class:"px-[20px] pt-[18px] pb-[15px] flex justify-between bg-white z-40 text-[14px] items-center absolute top-0 left-0 right-0"},co={class:"text-[#222221] text-[16px]"},uo={class:"tagForm"},mo={class:"text-[#222221] mb-[10px]"},fo={class:"mt-[30px]"},po={key:0,class:"text-center mt-[150px]"},vo={class:"h-[96px] p-[16px] flex flex-col justify-center items-center fixed bottom-0 left-0 right-0 bg-white"},ho={class:"mt-[8px] text-[#5D5A56] text-[12px] leading-none"},xo={class:"p-[16px] flex justify-center fixed bottom-0 left-0 right-0 bg-white"},yo=Re({props:{value:null},setup(t,{expose:H}){const{value:v}=t,{t:e}=Je(),f=y(null),{getCurrentStoreId:k}=Tt(),{getMerchantDhKey:R,decryptAddressKey:E,decryptKey:_,cryptoAESWithSearch:S}=os(),[q,h]=Ke(!1),g=y(0);Ue(()=>v,a=>{g.value=a},{immediate:!0});const J=zt({refundTabList:[{id:1,name:e("order.applying")},{id:2,name:e("order.refund block confirmation")},{id:3,name:e("order.refund completed")},{id:4,name:e("order.refund rejection")},{id:5,name:e("order.cancellation refund")},{id:10,name:e("order.platform intervention")},{id:11,name:e("order.platforms step in to support buyers")},{id:12,name:e("order.platform intervention to support sellers")},{id:13,name:e("order.freeze thawed")},{id:14,name:e("order.user forced liquidation")},{id:20,name:e("order.Long time no delivery")},{id:30,name:e("refund.refund success tips")}],statusTabList:[{id:0,name:e("order.waitPay")},{id:1,name:e("order.wait")},{id:2,name:e("order.already")},{id:3,name:e("order.fail")},{id:4,name:e("order.trade success")},{id:5,name:e("order.trade close")},{id:6,name:e("order.trade close")},{id:7,name:e("order.platform intervention")},{id:8,name:e("order.canceled")},{id:-1,name:e("order.canceled")}]}),le=Ae(()=>[{id:0,name:e("order.waitPay")},{id:1,name:e("order.wait")},{id:2,name:e("order.already")},{id:4,name:e("order.completed")},{id:-1,name:e("order.all")}]),D=rs(),se=a=>a.fmRefundReason?a.fmRefundReason[D]:"",N=y(""),F=y([]),K=y(!1),oe=y(!1),d=y(1),C=y(30),z=y(0),B=y({}),m=y(!1),w=y(0),p=async()=>{d.value+=1,await be(B.value)},Y=y([]),we=async a=>{oe.value=!1,F.value=[],d.value=1,await be(a)},_e=()=>{if(N.value&&N.value.length<2)return A(e("common.Please enter at least two keywords"));we(B.value)},be=a=>new Promise(async c=>{var fe,M,ne,Se,ke,x,L,ee,s,qe,Ee,De,Fe,Ve,He,je,Ge,Me,U;K.value&&c(),B.value=Object.keys(a).length>0?a:B.value;let G=null;m.value&&(G=Math.ceil((w.value+1)/C.value)),K.value=!0;let ye=g.value,ie=null;N.value&&(ie=await S(N.value));const X={page:G||d.value,size:C.value,status:le.value[g.value].id,type:1,keyword:ie,keywordPlain:N.value,storeId:(fe=await k())==null?void 0:fe.id,...a};(a.waitBuyerReceive||a.waitSellerReceive)&&(console.log("有过滤收货状态"),X.status=2);const V=await We(X);if(!V.success){oe.value=!0;return}if(!V.data||!V.total){oe.value=!0,K.value=!1;return}if(ye!==g.value)return;(V==null?void 0:V.total)===0&&(F.value=[]),z.value=V.total;const ae=[];for(let de=0;de<V.data.length;de++){let pe="";const l=V.data[de];if(l.userAddress&&(l.userAddress.postscript=l.postscript),l.userAddress&&((M=l.userAddress)!=null&&M.encryptFlag)){const Ce=await R(l.address,l.submitUserPubKey);Ce&&(l.userAddress=E(l.userAddress,Ce),(ne=l.userAddress)!=null&&ne.success&&!l.merchantEns&&(pe+=((Se=l.userAddress)==null?void 0:Se.userName)+((ke=l.userAddress)==null?void 0:ke.telNumber)+(((x=l.userAddress)==null?void 0:x.postalCode)??"")+((L=l.userAddress)==null?void 0:L.provinceName)+((ee=l.userAddress)==null?void 0:ee.cityName)+((s=l.userAddress)==null?void 0:s.countyName)+((qe=l.userAddress)==null?void 0:qe.detailInfo)+((Ee=l.userAddress)==null?void 0:Ee.postscript)))}else l.merchantEns||(pe+=((De=l.userAddress)==null?void 0:De.userName)+((Fe=l.userAddress)==null?void 0:Fe.telNumber)+(((Ve=l.userAddress)==null?void 0:Ve.postalCode)??"")+((He=l.userAddress)==null?void 0:He.provinceName)+((je=l.userAddress)==null?void 0:je.cityName)+((Ge=l.userAddress)==null?void 0:Ge.countyName)+((Me=l.userAddress)==null?void 0:Me.detailInfo)+((U=l.userAddress)==null?void 0:U.postscript));if(l.shippingHash){const Ce=await R(l.address,l.shippingUserPubKey);if(Ce){const vt=_(l.expressNo,Ce);vt.hash===l.shippingHash&&(l.expressNo=vt.decrypt,l.expressCompany=_(l.expressCompany,Ce).decrypt,l.merchantEns||(pe+=(l==null?void 0:l.expressNo)+(l==null?void 0:l.expressCompany)))}}else l.merchantEns||(pe+=(l==null?void 0:l.expressNo)+(l==null?void 0:l.expressCompany));if(l.merchantEns||(pe+=(l==null?void 0:l.hash)+(l==null?void 0:l.address)),pe)try{ae.push({id:l.id,merchantEns:await S(pe)})}catch(Ce){console.log(Ce)}}const b=ae.filter(de=>de.merchantEns);b.length>0&&ls({enInfoList:b}),Y.value=V.data,m.value?(F.value.splice((G-1)*C.value,C.value,...Y.value),m.value=!1):F.value=d.value===1?Y.value:F.value.concat(Y.value),F.value.length>=z.value&&(oe.value=!0),K.value=!1,c()}),Le=async a=>{f.value.handleReset(!1),It.replace({path:"sellerOrderList",query:{type:1,active:a}}),g.value=a,K.value=!1,jt()},Nt=async a=>{var L,ee;const c=navigator.userAgent.toLowerCase(),G=/mobile|android|iphone|ipad|phone/i.test(c),ye=/tablet|ipad/i.test(c),ie=/webview|wv/i.test(c),X=/fbav|instagram|line|twitter|whatsapp/i.test(c),V=/metamask/i.test(c),ae=/tokenpocket/i.test(c),b=(window==null?void 0:window.$onekey)||!1;if(Yt.isConnected()){h(!0);return}if(b){h(!0);return}if((G||ye)&&(ie||X||V||ae||b)&&!window.chrome&&!window.safari){h(!0);return}let fe=null;N.value&&(fe=await S(N.value));const M={page:1,size:99999,status:le.value[g.value].id,type:1,keyword:fe,keywordPlain:N.value,storeId:(L=await k())==null?void 0:L.id,...a};(a.waitBuyerReceive||a.waitSellerReceive)&&(console.log("导出-有过滤收货状态"),M.status=2),A.loading({duration:0,message:e("common.loading")});const ne=await We(M);if(!ne.success||!ne.data||ne.data.length===0){A.clear(),A(e("common.No data download"));return}const Se=ne.data.map(s=>new Promise(async qe=>{var Ee,De,Fe,Ve,He,je,Ge,Me;if(s!=null&&s.userAddress&&(s.userAddress.postscript=s.postscript),s!=null&&s.userAddress&&((Ee=s==null?void 0:s.userAddress)!=null&&Ee.encryptFlag)){const U=await R(s.address,s==null?void 0:s.submitUserPubKey);U&&(s.userAddress=E(s.userAddress,U))}if(s!=null&&s.shippingHash){const U=await R(s.address,s==null?void 0:s.shippingUserPubKey);if(U){const de=_(s.expressNo,U);de.hash===s.shippingHash&&(s.expressNo=de.decrypt,s.expressCompany=_(s.expressCompany,U).decrypt)}}qe([{text:s.id},{text:s.address},{text:s.hash||""},{text:s.orderGoods&&s.orderGoods.length?Oe(s.orderGoods,"goodsName"):""},{text:s.orderGoods&&s.orderGoods.length?Oe(s.orderGoods,"goodsId"):""},{text:s.orderGoods&&s.orderGoods.length?Oe(s.orderGoods,"number"):0},{text:s.orderGoods&&s.orderGoods.length?Oe(s.orderGoods,"price"):0},{text:((De=J.statusTabList.find(U=>U.id==s.status))==null?void 0:De.name)||""},{text:s.totalAmountOriginal||0},{text:s.merchantAdjustAmount||0},{text:s.activityReduceAmount||0},{text:s.voucherAmount||0},{text:Bt(s)},{text:s.orderGoods&&s.orderGoods.length?Oe(s.orderGoods,"discountRatio","%"):"0%"},{text:s.createTime?te(s.createTime):""},{text:s.chainCreateTime?te(s.chainCreateTime):""},{text:s.expressTime?te(s.expressTime):""},{text:s.finishTime?te(s.finishTime):""},{text:s.userAddress.postscript||""},{text:`${s.userAddress.provinceName??""}${s.userAddress.cityName??""}${s.userAddress.countyName??""}${s.userAddress.detailInfo??""} ${s.userAddress.userName??""} ${s.userAddress.telNumber??""}`},{text:s.creditFlag?e("common.yes"):e("common.no")},{text:s.merchantsConfirm?e("common.yes"):e("common.no")},{text:s.orderLabelList.map(U=>U.content).join(",")},{text:s.expressCompany||""},{text:s.expressNo||""},{text:se(s)},{text:J.refundTabList.find(U=>{var de,pe;return U.id==((pe=(de=s.refundInfo)==null?void 0:de.reason)==null?void 0:pe.jtName)})||""},{text:(Fe=s.refundInfo)!=null&&Fe.refundTime?te((Ve=s.refundInfo)==null?void 0:Ve.refundTime):""},{text:(He=s.refundInfo)!=null&&He.successTime?te((je=s.refundInfo)==null?void 0:je.successTime):""},{text:(Ge=s.refundInfo)!=null&&Ge.cancelTime?te((Me=s.refundInfo)==null?void 0:Me.cancelTime):""}])})),ke=await Promise.all(Se);if(!ke||ke.length===0){A.clear(),A(e("common.No data download"));return}const x=[{text:e("order.export.orderId")},{text:e("order.export.buyerAddress")},{text:e("order.export.transactionHash")},{text:e("order.export.goodsName")+"("+e("order.export.goodsName-tips")+")"},{text:e("order.export.goodsId")+"("+e("order.export.goodsId-tips")+")"},{text:e("order.export.goodsNumber")+"("+e("order.export.goodsName-tips")+")"},{text:e("order.goodsPrice")+"("+e("order.export.goodsName-tips")+")"},{text:e("order.orderStatus")},{text:e("order.export.goodsPrice total")},{text:e("order.merchant modify price total")},{text:e("order.export.activityReduceAmount total")},{text:e("voucher.voucher_deduction total")},{text:e("order.export.actualAmount total")},{text:e("common.ratio")},{text:e("order.createTime")},{text:e("order.export.paymentTime")},{text:e("order.Shipping time")},{text:e("order.Complete time")},{text:e("order.remark")},{text:e("order.receive address")},{text:e("order.export.isCreditReceive")},{text:e("order.export.merchantsConfirm")},{text:e("order.export.orderLabelList")},{text:e("order.deliveryCompany")},{text:e("order.deliveryId")},{text:e("refund.RefundReason")},{text:e("refund.refundStatus")},{text:e("refund.refundTime")},{text:e("refund.refundSuccessTime")},{text:e("refund.refundCancelTime")}];try{const s=((ee=await k())==null?void 0:ee.storeName)+"_"+Wt().format("YYYY-MM-DD HH:mm:ss");fs([x,...ke],{excelName:s,worksheet:"sheet"}),A.clear()}catch{A.clear()}},ct=()=>{h(!1)},Bt=a=>{const c=new Ne(a.totalAmountOriginal).plus(new Ne(a.merchantAdjustAmount||0)).minus(new Ne(a.activityReduceAmount||0)).minus(new Ne(a.voucherAmount||0)).toNumber();return Lt(c)},Lt=a=>Number.isInteger(a)?a.toString():a.toFixed(4).replace(/\.?0+$/,""),Oe=(a,c,G)=>a.map(ie=>{let X=ie[c];return G&&(X=X+G),X}).join(","),Pe=y(!1),xe=y(!1),j=y(!1),ce=y(null),Q=y([]),$e=y(""),Ze=y([]),ue=y([]),me=y(null),Xe=y(null),Z=y({content:"",colorHex:"",id:null,shopId:null}),ut=y(null),mt=y([{id:null,content:"",colorHex:"#D4380D"},{id:null,content:"",colorHex:"#E58312"},{id:null,content:"",colorHex:"#DEAD0E"},{id:null,content:"",colorHex:"#389E0D"},{id:null,content:"",colorHex:"#0958D9"},{id:null,content:"",colorHex:"#531DAB"}]),Ot=(a,c)=>{w.value=c,Pe.value=!0,ut.value=a.id,Xe.value=a.stores.id,a.orderLabelList&&(Q.value=a.orderLabelList.map(G=>G.id)),tt()},Pt=a=>{j.value=!0,a.id&&(me.value=a.id,ce.value=a.content,Z.value.id=a.id,Z.value.colorHex=a.colorHex,$e.value=a.colorHex,Ze.value=Q.value)},Et=()=>{j.value=!0,me.value=null,ce.value=null,Z.value.id=null,Z.value.colorHex=null,$e.value="",Ze.value=Q.value},Dt=a=>{Q.value&&Q.value.length>=5&&Q.value.findIndex(c=>c===ue.value[a].id)===-1&&A(e("common.tag select num valid",{num:5}))},et=()=>{j.value=!1,Q.value=Ze.value,me.value=null,ue.value.length=0,ce.value=null,$e.value="",tt()},ft=()=>{Pe.value=!1,me.value=null,Q.value=[],f.value.onLoadTagList()},tt=()=>{ue.value=[],is({page:1,size:300,shopId:Xe.value}).then(a=>{a==null||a.data.forEach(c=>{ue.value.push({id:c.id,content:c.content,colorHex:c.colorHex})})})},Ft=()=>{var a;if(!xe.value){if(((a=$e.value)==null?void 0:a.length)===0){A.fail(e("order.Please select a color"));return}else Z.value.colorHex=$e.value,Z.value.id=me.value,Z.value.content=ce.value,Z.value.shopId=Xe.value;Z.value.content&&(Z.value.content=Z.value.content.trim()),me.value||delete Z.value.id,xe.value=!0,ds(Z.value).then(c=>{c.msg==="SUCCESS"&&(j.value=!1,ue.value=[],$e.value="",ce.value=null,tt(),m.value=!0,be(B.value),A(e("order.Save success")))}).finally(()=>{xe.value=!1})}},Vt=()=>{xe.value||(xe.value=!0,cs({id:me.value}).then(a=>{a.msg==="SUCCESS"?(A(e("order.Delete success")),m.value=!0,be(B.value),et()):A(e("order.Delete failed"))}).finally(()=>{xe.value=!1}))},Ht=async()=>{xe.value||(Q.value=Q.value.filter(a=>!!ue.value.find(c=>a==c.id)),xe.value=!0,await us({orderId:ut.value,orderLabelIds:Q.value.join(",")}).then(a=>{if((a==null?void 0:a.msg)==="SUCCESS")Pe.value=!1,j.value=!1,ce.value="",A(e("order.Save success")),m.value=!0,be(B.value);else{A(e("order.Save failed"));return}}).finally(()=>{xe.value=!1}))},jt=()=>{oe.value=!1,d.value=1,F.value=[],be({})},st=y(new Date().getTime()/1e3),pt=async()=>{st.value=await ns()};ht(()=>{st.value+=1},1e3),ht(()=>{pt()},6e4);const Gt=y(null),Mt=async()=>{var c,G,ye,ie,X,V,ae;const a=sessionStorage.getItem("modifiedOrderId");if(a)try{const b=await ms({id:a});if(b.success&&b.data){if((c=b.data)!=null&&c.userAddress&&(b.data.userAddress.postscript=b.data.postscript),(G=b.data)!=null&&G.userAddress&&((ie=(ye=b.data)==null?void 0:ye.userAddress)!=null&&ie.encryptFlag)){const M=await R(b.data.address,(X=b.data)==null?void 0:X.submitUserPubKey);M&&(b.data.userAddress=E(b.data.userAddress,M))}if((V=b.data)!=null&&V.shippingHash){const M=await R(b.data.address,(ae=b.data)==null?void 0:ae.shippingUserPubKey);if(M){const ne=_(b.data.expressNo,M);ne.hash===b.data.shippingHash&&(b.data.expressNo=ne.decrypt,b.data.expressCompany=_(b.data.expressCompany,M).decrypt)}}const fe=F.value.findIndex(M=>M.id===parseInt(a));fe!==-1?Object.assign(F.value[fe],b.data):console.log("未找到要更新的订单，ID:",a)}}catch{}finally{sessionStorage.removeItem("modifiedOrderId")}},qt=async()=>{F.value.length>0&&await Mt()};return Ct(async()=>{var a;pt(),be({}),Gt.value=(a=await k())==null?void 0:a.merchant}),H({handleChangeTab:Le,active:g,updateModifiedOrders:qt}),(a,c)=>{const G=O("Empty"),ye=O("VanList"),ie=O("VanTab"),X=O("VanTabs"),V=O("van-field"),ae=O("van-icon"),b=O("van-radio"),fe=O("van-radio-group"),M=O("van-checkbox"),ne=O("van-checkbox-group"),Se=O("van-button"),ke=O("van-action-sheet");return r(),i(re,null,[T(X,{active:g.value,"onUpdate:active":c[2]||(c[2]=x=>g.value=x),onChange:Le,background:"#f2f0ef",sticky:"","offset-top":"44"},{"nav-bottom":I(()=>[o("div",lo,[T(ps,{modelValue:N.value,"onUpdate:modelValue":c[0]||(c[0]=x=>N.value=x),onOnSubmit:_e,onGetList:we,noType:!0,ref:(x,L)=>{L.searchBox=x,f.value=x},active:g.value,onOnExport:Nt},null,8,["modelValue","active"])])]),default:I(()=>[(r(!0),i(re,null,Te(u(le),x=>(r(),P(ie,{title:x.name,key:x.id},{default:I(()=>[F.value.length===0&&!K.value?(r(),P(G,{key:0,name:"没有订单",class:"py-6"})):$("",!0),T(ye,{loading:K.value,"onUpdate:loading":c[1]||(c[1]=L=>K.value=L),finished:oe.value,"finished-text":a.$t("common.noMore"),"loading-text":a.$t("common.loading"),onLoad:p},{default:I(()=>[(r(!0),i(re,null,Te(F.value,(L,ee)=>(r(),P(ro,{key:L.id,order:L,onOpen:s=>Ot(s,ee),nowTime:st.value,tab:x},null,8,["order","onOpen","nowTime","tab"]))),128))]),_:2},1032,["loading","finished","finished-text","loading-text"])]),_:2},1032,["title"]))),128))]),_:1},8,["active"]),T(ke,{show:Pe.value,"onUpdate:show":c[8]||(c[8]=x=>Pe.value=x),closeable:!1,class:"h-[70vh] font-Puhui",onCancel:et,onClose:ft},{default:I(()=>[o("div",io,[ve(o("div",{class:"text-[#5D5A56] w-[60px]",onClick:et},n(a.$t("common.closed")),513),[[he,j.value]]),ve(o("div",{class:"text-[#5D5A56] w-[30px]",onClick:ft},n(a.$t("common.closed")),513),[[he,!j.value]]),o("div",co,n(me.value?a.$t("common.editTag"):a.$t("common.addTag")),1),ve(o("div",{class:"text-[#A45E00] w-[30px]",onClick:Et},n(a.$t("piggy.add")),513),[[he,!j.value]]),ve(o("div",{class:"text-[#A45E00] w-[30px]",onClick:Ft},n(a.$t("common.save")),513),[[he,j.value]])]),o("div",{class:Ie(["mt-[53px] px-[20px]",j.value&&me.value?"pb-[96px]":"pb-[72px]"])},[T(Ut,{name:"van-slide-up"},{default:I(()=>[ve(o("div",uo,[o("div",mo,n(a.$t("common.NameOptional")),1),T(V,{modelValue:ce.value,"onUpdate:modelValue":c[3]||(c[3]=x=>ce.value=x),maxlength:"5",placeholder:a.$t("common.pleaseEnter")},null,8,["modelValue","placeholder"]),o("div",fo,n(a.$t("common.color")),1)],512),[[he,j.value]])]),_:1}),ve(T(fe,{modelValue:$e.value,"onUpdate:modelValue":c[4]||(c[4]=x=>$e.value=x),max:1},{default:I(()=>[(r(!0),i(re,null,Te(mt.value,(x,L)=>(r(),P(b,{name:x.colorHex,key:L,class:"relative flex checkedList"},{icon:I(ee=>[ee.checked?(r(),P(ae,{key:0,name:"success",color:"white",class:"tag-icon absolute right-[23px] border-0 top-[1px] bg-transparent",size:"30"})):$("",!0)]),default:I(()=>[o("div",{style:ot({backgroundColor:u(it)(x.colorHex,.12),color:x.colorHex}),class:Ie(["mr-[10px] rounded-[6px] min-h-[40px] p-[10px] text-white",L<mt.value.length-1?"mb-[16px]":""])},n(x.content||ce.value),7)]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue"]),[[he,j.value]]),!j.value&&ue.value.length==0?(r(),i("div",po,n(a.$t("common.NoLabels")),1)):$("",!0),ve(T(ne,{modelValue:Q.value,"onUpdate:modelValue":c[5]||(c[5]=x=>Q.value=x),max:5},{default:I(()=>[(r(!0),i(re,null,Te(ue.value,(x,L)=>(r(),P(M,{name:x.id,key:L,class:"relative flex radioList",onClick:ee=>Dt(L)},{icon:I(ee=>[ee.checked?(r(),P(ae,{key:0,name:"success",color:"white",class:"tag-icon absolute right-[40px] border-0 top-[1px] bg-transparent",size:"30"})):$("",!0)]),default:I(()=>[o("div",{style:ot({backgroundColor:u(it)(x.colorHex,.12),color:x.colorHex}),class:Ie(["mr-[10px] rounded-[6px] min-h-[40px] p-[10px] text-white",L<ue.value.length-1?"mb-[16px]":""])},n(x.content||ce.value),7),o("div",null,[T(ae,{name:"edit",class:"absolute right-[1px] top-[1px]",color:"#543E3E",size:"30",onClick:ge(ee=>Pt(x),["stop"])},null,8,["onClick"])])]),_:2},1032,["name","onClick"]))),128))]),_:1},8,["modelValue"]),[[he,!j.value]]),ve(o("div",vo,[T(Se,{color:"linear-gradient(to right, #FED53A, #FFA122)",class:"shrink-0 w-[180px] my-0 h-[40px] rounded-[20px]",onClick:c[6]||(c[6]=x=>Vt()),block:""},{default:I(()=>[W(n(a.$t("common.RemoveTag")),1)]),_:1}),o("div",ho,[T(ae,{name:"question-o",size:"12",class:"mr-[8px]"}),W(n(a.$t("common.AllOrderLabelsCannotBeViewedAfterRemoval")),1)])],512),[[he,j.value&&me.value]])],2),ve(o("div",xo,[T(Se,{color:"linear-gradient(to right, #FED53A, #FFA122)",class:"w-[180px] my-0 h-[40px] rounded-[20px]",onClick:c[7]||(c[7]=x=>Ht()),block:""},{default:I(()=>[W(n(a.$t("common.ConfirmSelection")),1)]),_:1})],512),[[he,!j.value&&ue.value.length>0]])]),_:1},8,["show"]),T(as,{show:u(q),title:"导出账单",content:"请在PC端操作账单导出",showConfirm:!0,showReject:!1,confirmText:"我知道了",rejectText:"拒绝",onClose:ct,onConfirm:ct},null,8,["show"])],64)}}}),go=Be(yo,[["__scopeId","data-v-c04ed978"]]),wo={},bo={class:"dot w-[8px] h-[8px] rounded-full bg-[red] absolute top-0 right-[-10px]"};function $o(t,H){return r(),i("div",bo)}const ko=Be(wo,[["render",$o]]),Co={class:"py-[20px] flex-start gap-2"},Ao={class:"w-20 h-20"},To={class:"flex flex-col justify-between flex-1 h-20 gap-2"},Io={class:"flex-1 text-sm text-default"},_o={class:"w-full flex flex-row justify-start items-center gap-2 line-clamp-1"},So={class:"max-w-[150px] font-semibold line-clamp-1"},Ro={key:0,class:"flex-shrink-0 flex items-center text-xs text-[#34C2A9]"},No=o("img",{src:hs,class:"w-5 h-5"},null,-1),Bo={class:"ml-auto text-sm text-default opacity-60 whitespace-nowrap"},Lo={class:"mt-0 text-sm font-normal text-[#a6a6a6]"},Oo={class:"flex flex-row justify-end"},Po={class:"text-sm text-[#a6a6a6] font-normal mr-1"},Eo={key:0,class:"text-newOrigin text-sm flex-start gap-[2px]"},Do=["src"],Fo={class:"font-semibold"},Vo={class:"text-sm font-normal"},Ho={key:1,class:"text-primary text-sm flex-start gap-[2px]"},jo=o("img",{src:xs,class:"w-4 h-4 mr-[3px]",alt:"MCOIN"},null,-1),Go={class:"font-semibold"},Mo=Re({props:{payType:null,goods:null,storeCard:null,creditFlag:{default:0}},setup(t){const H=e=>{const f=e.number??1,k=e.cardPrice??0,R=e.goodsActivityReduceAmount??0,E=new Ne(k*f-R).toNumber();return xt(E)},v=e=>{const f=new Ne(e.price).times(e.number).minus(e.goodsActivityReduceAmount||0).plus(e.goodsAdjustChangeAmount||0).toNumber();return xt(f||0)};return(e,f)=>{var R,E,_;const k=O("VanImage");return r(),i("div",Co,[o("div",Ao,[T(k,{src:(t.goods.icons||"").split(",")[0],radius:"10",class:"w-full h-full",alt:"",fit:"cover"},null,8,["src"])]),o("div",To,[o("div",Io,[o("div",null,[o("div",_o,[o("div",So,n(t.goods.goodsName),1),t.creditFlag?(r(),i("div",Ro,[No,W(" "+n(e.$t("order.Credit Collection")),1)])):$("",!0),o("div",Bo,[o("span",null,n(t.goods.price)+" Mcoin",1)])])]),o("div",Lo,n(e.$t("order.quantity",{number:t.goods.number})),1)]),o("div",Oo,[o("div",Po,n(e.$t("order.actual payment")),1),t.payType===u(lt).STORE_CARD?(r(),i("div",Eo,[(R=t.storeCard)!=null&&R.symbolLogo?(r(),i("img",{key:0,src:(E=t.storeCard)==null?void 0:E.symbolLogo,class:"w-3 h-3",alt:""},null,8,Do)):$("",!0),o("span",Fo,n(H(t.goods)),1),o("span",Vo,n((_=t.storeCard)==null?void 0:_.symbol),1)])):(r(),i("div",Ho,[jo,o("span",Go,n(v(t.goods)),1)]))])])])}}}),qo=t=>($t("data-v-0bb2cd72"),t=t(),kt(),t),Ko={class:"gap-2 flex-center-bw"},zo={key:0,class:"w-4 h-4",src:Rt,alt:""},Uo={key:1,class:"w-4 h-4 border border-solid rounded-full border-[#000]/40"},Yo=qo(()=>o("div",{class:"w-8 h-8"},[o("img",{src:At,class:"w-full h-full rounded-md",alt:"",fit:"cover"})],-1)),Wo={class:"flex flex-col justify-center flex-1 h-8 text-default"},Jo={class:"text-sm font-normal flex-center-bw"},Qo={key:0},Zo={class:"text-primary"},Xo={class:"text-xs font-normal opacity-60"},ea={key:0},ta={key:1},sa={key:2},oa=Re({props:{order:null,isService:{type:Boolean},nowTime:null,selectIds:null},emits:["select"],setup(t,{emit:H}){const v=t;Ye();const e=wt(),f=_t(v.order),{t:k}=Je(),R=S=>{v.isService||e.push(S)},E=()=>{if(v.isService){const S=v.order;_(S)}else e.push(`/sellerOrderDetail?id=${v.order.id}`)};bt("openBatchReceiptPop",null),dt();const _=S=>{H("select",S)};return(S,q)=>(r(),i("div",{class:Ie(["p-3 mt-3 bg-white rounded-xl box-border default-border",{"border-orange":t.selectIds&&t.selectIds.includes(t.order.id)}]),onClick:E},[o("div",Ko,[o("div",null,[t.selectIds&&t.selectIds.includes(t.order.id)?(r(),i("img",zo)):(r(),i("div",Uo))]),Yo,o("div",Wo,[o("div",Jo,[t.order.userAddress&&t.order.userAddress.address?(r(),i("div",Qo,n(u(at)(t.order.userAddress.address,"...",5,5)),1)):$("",!0),o("div",Zo,n(u(f)[t.order.status+""]),1)]),o("div",Xo,[t.order.status==4?(r(),i("span",ea,n(u(te)(t.order.finishTime))+" "+n(S.$t("common.finish")),1)):t.order.status==2?(r(),i("span",ta,n(u(te)(t.order.expressTime))+" "+n(S.$t("order.Ship")),1)):(r(),i("span",sa,n(u(te)(t.order.createTime))+" "+n(S.$t("order.buied")),1))])])]),(r(!0),i(re,null,Te(t.order.orderGoods,h=>(r(),P(Mo,{class:"goods-item",creditFlag:t.order.creditFlag,payType:t.order.payType,key:h.goodsName,goods:h,storeCard:t.order.fmStoredCard,onHandleTo:R},null,8,["creditFlag","payType","goods","storeCard"]))),128))],2))}}),gt=Be(oa,[["__scopeId","data-v-0bb2cd72"]]),aa={class:"px-3 text-base"},na={class:"flex justify-center items-center h-[44px]"},ra={class:"flex items-center font-bold"},la={class:"overflow-y-scroll max-h-[70vh] pb-[100px]"},ia={class:"mt-3 text-sm font-normal"},da={class:"text-primary font-semibold"},ca={class:"text-primary font-semibold"},ua={class:"flex flex-col"},ma={class:"receipt__wrap flex flex-col items-center justify-center gap-3 py-5 px-6 fixed bottom-0 left-0 right-0"},fa={class:"text-sm font-normal text-black"},pa={class:"w-full flex flex-row justify-between items-center"},va={class:"flex items-center justify-center"},ha={key:0,class:"w-4 h-4",src:Rt,alt:""},xa={key:1,class:"w-4 h-4 border border-solid rounded-full border-[#000]/40"},ya={key:0,class:"text-default"},ga=Re({props:{show:{type:Boolean},list:null,currentId:null,loading:{type:Boolean}},emits:["close","receipt","update:show"],setup(t,{emit:H}){const v=t,e=Ae({get:()=>v.show,set:h=>H("update:show",h)}),f=y([]),k=Ae(()=>v.list&&v.currentId?v.list.filter(h=>+h.id!=+v.currentId):[]),R=Ae(()=>{const h=[v.currentId,...k.value.map(g=>g.id)];return f.value.length===h.length&&h.every(g=>f.value.includes(g))}),E=()=>{if(R.value)f.value=[];else{const h=[v.currentId,...k.value.map(g=>g.id)];f.value=h}};Ue(()=>v.show,h=>{if(h){const g=document.getElementById("container");Qt(()=>{g&&g.scrollIntoView()}),f.value=[],f.value.push(v.currentId)}},{deep:!0});const _=h=>{const g=h.id;f.value.includes(g)?f.value=f.value.filter(J=>J!==g):f.value.push(g)},S=()=>{H("receipt",f.value)},q=Ae(()=>v.list&&v.currentId?v.list.find(h=>+h.id==+v.currentId):[]);return(h,g)=>{const J=O("van-icon"),le=O("VanButton"),D=O("van-popup");return r(),P(D,{show:u(e),"onUpdate:show":g[1]||(g[1]=se=>Jt(e)?e.value=se:null),round:"",class:"bg-[#F3F3F3]",position:"bottom",onClose:g[2]||(g[2]=se=>H("close")),"safe-area-inset-bottom":"","stop-propagation":!1},{default:I(()=>[o("div",aa,[o("div",na,[o("div",ra,n(h.$t("order.you_have_other_pending_orders")),1),T(J,{class:"absolute right-2.5",name:"cross",size:"20",color:"#000",onClick:g[0]||(g[0]=ge(()=>H("close"),["stop"]))})]),o("div",la,[u(q)?(r(),P(gt,{key:0,id:"container",onSelect:_,selectIds:f.value,order:u(q),isService:""},null,8,["selectIds","order"])):$("",!0),o("div",ia,[W(n(h.$t("order.there are"))+" ",1),o("span",da,n(u(k).length),1),W(" "+n(h.$t("order.order merchant"))+" ",1),o("span",ca,n(h.$t("order.already")),1),W(" "+n(h.$t("order.can confirm receipt in batches")),1)]),o("div",ua,[(r(!0),i(re,null,Te(u(k),se=>(r(),i("div",{key:se.id},[T(gt,{onSelect:_,selectIds:f.value,order:se,isService:""},null,8,["selectIds","order"])]))),128))]),o("div",ma,[o("div",fa,n(h.$t("order.follow orders")),1),o("div",pa,[o("div",{class:"flex flex-col items-center justify-center cursor-pointer",onClick:E},[o("div",va,[u(R)?(r(),i("img",ha)):(r(),i("div",xa))])]),T(le,{loading:t.loading,round:"",disabled:!f.value||f.value&&f.value.length<=0,class:"ml-2 h-10 text-default min-w-[calc(100%-32px)] bg-btnOrBg rounded-[60px] font-semibold",onClick:S},{default:I(()=>[W(n(h.$t("order.oneKeyConfirmGeted")),1),f.value.length?(r(),i("span",ya,n(h.$t("order.selected count num",{count:f.value.length||0})),1)):$("",!0)]),_:1},8,["loading","disabled"])])])])])]),_:1},8,["show"])}}}),wa=Be(ga,[["__scopeId","data-v-5dc12824"]]),ba={class:"relative"},$a={class:"px-3 bg-[#f2f0ef] pb-1 parent-view"},ka={class:"gap-2 pt-2 flex-start bg-[#f2f0ef] sticky top-0 z-10"},Ca=Re({name:"SellerOrderList"});function Aa(t){const{t:H}=Je(),{getCurrentStoreId:v}=Tt(),e=y(0),f=y(1),{clerkStore:k}=Ye(),[R,E]=Ke(!1),[_,S]=Ke(!1),[q,h]=Ke(!1),g=y(null),J=y([]),le=y([]),D=y(null),se=y(new Date().getTime()/1e3),N=Zt();N.query.active&&(e.value=Number(N.query.active)),N.query.type&&(f.value=Number(N.query.type));const F=m=>{console.log("changeType",m),f.value=m,It.replace({path:"sellerOrderList",query:{type:m}})},{merchantConfirm:K}=dt(),oe=async()=>{var w;const m=await We({page:1,size:999,status:2,type:1,storeId:(w=await v())==null?void 0:w.id});m.success&&(le.value=m.data)},d=async m=>{g.value=m.id,le.value.length===0&&(m.loading=!0,await oe(),m.loading=!1),J.value=le.value.filter(w=>{if(St(w)&&!(ze(w.expressTime,w.confirmLimit,se.value)>0))return!0}),J.value.length<=1?C(m):S(!0)},C=async m=>{m.loading=!0;try{const p=(await nt({orderIds:m.id.toString()})).data.ordIds,Y=await K(p);if(!Y.success||!(await rt({ordIds:p,hash:Y.result.hash})).success)return;m.merchantsConfirm=1,A.success(H("order.confirmSuccess")),setTimeout(()=>{var _e;D.value?(_e=D.value)==null||_e.handleChangeTab(3):location.reload()},1e3)}finally{m.loading=!1}},z=async m=>{var w;h(!0);try{const p=m.map(String).join(),we=(await nt({orderIds:p})).data.ordIds,_e=await K(we);if(!_e.success||!(await rt({ordIds:we,hash:_e.result.hash})).success)return;J.value.forEach(Le=>{m.includes(Le.id)&&(Le.merchantsConfirm=1)}),S(!1),A.success(H("order.confirmSuccess")),await oe(),D.value?(w=D.value)==null||w.handleChangeTab(3):location.reload()}finally{h(!1)}},B=async()=>{var p;const{success:m,total:w}=await We({page:1,size:3,status:-1,refundStatus:1,type:1,tab:2,storeId:(p=await v())==null?void 0:p.id});m&&w>0?E(!0):E(!1)};return Xt("openBatchReceiptPop",d),Ue(()=>N.query.active,m=>{var w;+m&&D.value&&D.value.active&&N.path==="/sellerOrderList"&&((w=D.value)==null?void 0:w.active)!==+m&&D.value.handleChangeTab(+m)},{immediate:!1,deep:!0}),Ue(()=>N.path,(m,w)=>{m==="/sellerOrderList"&&w!=="/sellerOrderList"&&(console.log("从子页面返回，刷新订单列表"),D.value&&sessionStorage.getItem("modifiedOrderId")&&D.value.updateModifiedOrders())},{immediate:!1}),Ct(()=>{B(),oe(),k.checkClerkAuth()}),(m,w)=>{const p=O("router-view");return r(),i("div",ba,[o("div",$a,[o("div",ka,[T(ys),o("div",{class:Ie(["text",{"active-text":f.value==1}]),onClick:w[0]||(w[0]=Y=>F(1))},n(m.$t("order.order")),3),o("div",{class:Ie(["relative ml-2 text",{"active-text":f.value==2}]),onClick:w[1]||(w[1]=Y=>F(2))},[W(n(m.$t("order.Refund/After-sale"))+" ",1),ve(T(ko,null,null,512),[[he,u(R)]])],2),T(gs,{showIcon:!0,showDownIcon:!1,class:"ml-auto bg-gray1 px-2 rounded-[20px] border-2 border-solid border-white",style:{"box-shadow":"0px 0px 15px 0px rgba(51, 47, 42, 0.3) inset"}})]),f.value==1?(r(),P(go,{key:0,ref:(Y,we)=>{we.sellOrderRef=Y,D.value=Y},value:e.value},null,8,["value"])):f.value==2?(r(),P(vs,{key:1,onRecompute:B})):f.value==3?(r(),P(ws,{key:2})):$("",!0)]),T(p,{class:"child-view bg-[#f2f0ef]"}),T(wa,{show:u(_),list:J.value,currentId:g.value,loading:u(q),onClose:w[2]||(w[2]=Y=>u(S)(!1)),onReceipt:z},null,8,["show","list","currentId","loading"])])}}const Ta=Re({...Ca,setup:Aa}),nn=Be(Ta,[["__scopeId","data-v-7d5b27d6"]]);export{nn as default};
