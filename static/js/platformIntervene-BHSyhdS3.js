import{_ as ee,y as te,l as pe,w as se,x as he,bO as ve,F as r,G as i,H as e,a3 as ge,X as y,Q as l,P as c,I as g,J as $,K as k,Z as ne,$ as oe,be as X,bf as _e,a2 as xe,N as f,E as x,O as h,R as Z,a0 as ye,a1 as S,a4 as L,T as W,bs as we}from"./vendor-BlU_hoYl.js";import{C as be}from"./CommonVanProvider-CDfGVWR4.js";import{_ as $e}from"./avatarRing-DtI_kRg6.js";import{G as ke}from"./GoodsItem-DamooujM.js";import{e as ie,o as Be,b as ae,l as N}from"./index-UgIL2Smv.js";import{g as Ce,a as Y,d as Ee}from"./useRefund-CagomE1G.js";import{u as Ie}from"./useOrderStatus-D1Cw0BRr.js";import{l as De}from"./order-ClP3Ze4h.js";import{p as Fe}from"./refund-DM6xdaIZ.js";import{n as Se}from"./useOrderActionButtons-BOt9swVU.js";import{_ as Ae}from"./RegionBox-ExMr1J4R.js";import"./BackIcon-8hcEjDKb.js";import"./credit-0laLclE7.js";import"./mcoin-logo-1-CkjdfX51.js";import"./flashSale-DDyqLyYN.js";import"./useShipTemplate-C35bKCd2.js";import"./enums-DlE-aiss.js";import"./orderTime-CrHWsAnM.js";const Te="/static/images/tips-gray-Co4UgnyA.svg",Pe="/static/images/check-line-Dp9rGNee.svg",Re="/static/images/close-line-B7uAHjtB.svg",je=o=>(ne("data-v-7e1d66ac"),o=o(),oe(),o),Le={class:"gap-2 flex-center-bw"},Ne=je(()=>e("div",{class:"w-8 h-8"},[e("img",{src:$e,class:"w-full h-full rounded-md",alt:"",fit:"cover"})],-1)),Ve={class:"flex flex-col justify-center flex-1 h-8 text-default"},Ge={class:"text-sm font-semibold flex-center-bw"},Oe={key:0},ze={class:"text-primary line-clamp-1 ml-2"},He={key:0},Je={key:1},qe={key:2},Me={class:"text-xs opacity-60"},Ue={key:0},Ke={key:1},Qe={key:2},Xe=te({props:{order:null,isService:{type:Boolean},nowTime:null},emits:["open"],setup(o,{emit:V}){const p=o;ie();const v=pe(),C=Ie(p.order),{t:a}=se(),_=he(()=>Ce(p.order)),A=m=>{p.isService||v.push(m)},T=()=>{p.isService||v.push(`/sellerOrderDetail?id=${p.order.id}`)};return ve("openBatchReceiptPop",null),Be(),(m,P)=>(i(),r("div",{class:"px-3 mt-3 bg-white rounded-xl py-4",onClick:T},[e("div",Le,[Ne,e("div",Ve,[e("div",Ge,[o.order.userAddress&&o.order.userAddress.address?(i(),r("div",Oe,l(c(ae)(o.order.userAddress.address,"...",5,5)),1)):y("",!0),e("div",ze,[c(Y)(o.order).available?(i(),r(g,{key:0},[e("span",null,l(c(_)?"买家发起":"商家发起"),1),e("span",null,l(c(Y)(o.order).label),1)],64)):(i(),r(g,{key:1},[o.order.status==-1?(i(),r("span",He,l(m.$t("order.canceled")),1)):o.order.status===0&&o.order.hash?(i(),r("span",Je,l(m.$t("order.wait block chain")),1)):(i(),r("span",qe,l(c(C)[o.order.status+""]),1))],64))])]),e("div",Me,[o.order.status==4?(i(),r("span",Ue,l(c(N)(o.order.finishTime))+" "+l(m.$t("common.finish")),1)):o.order.status==2?(i(),r("span",Ke,l(c(N)(o.order.expressTime))+" "+l(m.$t("order.Ship")),1)):(i(),r("span",Qe,l(c(N)(o.order.createTime))+" "+l(m.$t("order.buied")),1))])])]),(i(!0),r(g,null,$(o.order.orderGoods,E=>(i(),k(ke,{creditFlag:o.order.creditFlag,payType:o.order.payType,key:E.goodsName,goods:E,storeCard:o.order.fmStoredCard,showBuyFlag:!1,onHandleTo:A,class:"!py-0 mt-[20px]"},null,8,["creditFlag","payType","goods","storeCard"]))),128)),ge(m.$slots,"default",{},void 0,!0)]))}}),Ze=ee(Xe,[["__scopeId","data-v-7e1d66ac"]]),B=o=>(ne("data-v-3f48b007"),o=o(),oe(),o),We={class:"flex justify-between mt-3 text-sm text-[#2E2008]"},Ye={class:"text-b3 font-normal"},et={class:"test-sm font-semibold"},tt={class:"flex items-center justify-between"},st=B(()=>e("p",null,"补充凭证",-1)),nt=["onClick"],ot={key:0},it={key:0,class:"mt-2"},at=B(()=>e("div",{class:"w-full h-[1px] bg-[#D9D9D9]"},null,-1)),rt={class:"text-b3 font-sm font-normal mt-2"},lt={class:"text-b2 font-normal"},dt={class:"flex flex-wrap gap-2 mt-2"},ct={key:1,class:"mt-2"},ut=B(()=>e("div",{class:"w-full h-[1px] bg-[#D9D9D9]"},null,-1)),mt={class:"text-b3 font-sm font-normal mt-2"},ft={class:"text-b2 font-normal"},pt={class:"flex flex-wrap gap-2 mt-2"},ht={class:"w-full bg-[#F5F5F5] rounded-lg mt-3 p-2"},vt={class:"flex items-center justify-start"},gt=B(()=>e("p",null,"审核进度",-1)),_t={class:"p-2"},xt={class:"flex items-center text-xxs gap-1.5 text-primary"},yt=B(()=>e("img",{class:"w-[16px] h-[16px] ml-[2px]",src:Te},null,-1)),wt=[yt],bt={key:0,class:"mt-2 flex flex-col gap-2.5"},$t={class:"font-semibold text-[#FF8812] mx-1"},kt={key:0,src:Pe,class:"w-[20px] h-[20px] ml-auto"},Bt={key:1,src:Re,class:"w-[20px] h-[20px] ml-auto"},Ct={key:0,class:"flex justify-end gap-3 mt-3"},Et=te({setup(o){const{accountStore:V}=ie(),{t:p}=se(),[v,C]=X(!1),a=_e({active:1,page:0,size:10,finished:!1,list:[],loading:!1,total:0}),[_,A]=X(!1),T=n=>Ee(n,!0),m=n=>Se(n),P=n=>{const t=V.account.toLowerCase(),d=n.refundInfo.interventions||[];if(!d.length||!t)return!1;let w=!1;return w=d.some(R=>R.address.toLowerCase()===t),w},E=(n,t)=>{n.showExtContent=t||!1},re=n=>{let t=n.refundInfo.refundType==1?"退款":"退货退款";return`${p("common.agree")}${t}`},le=n=>{let t=n.refundInfo.refundType==1?"退款":"退货退款";return`${p("common.reject")}${t}`},I=n=>{const t=n.refundInfo||{};let d={};return d=t.buyerEvidence?JSON.parse(t.buyerEvidence):{},d.imgs&&typeof d.imgs=="string"&&(d.imgs=d.imgs.split(",")||[]),d},D=n=>{const t=n.refundInfo||{};let d={};return d=t.merchantEvidence?JSON.parse(t.merchantEvidence):{},d.imgs&&typeof d.imgs=="string"&&(d.imgs=d.imgs.split(",")||[]),d},G=xe();G.query.active&&(a.active=Number(G.query.active));const O=async(n,t)=>{if(!t){W.fail("缺少支持对象，请重试");return}try{C(!0);const{success:d}=await Fe({orderId:n.id,status:t});d&&de()}finally{C(!1)}},de=()=>{a.page=0,a.finished=!1,a.list=[],z()},z=async()=>{a.loading=!0,a.page+=1,await ce(),a.loading=!1},ce=async()=>{const n={page:a.page,size:a.size,type:4},t=await De(n);if(a.loading=!1,!t.success){a.finished=!0;return}if(!t.data||!t.total){a.finished=!0;return}a.total=t.total,a.list=a.page===1?t.data:a.list.concat(t.data),a.list.length>=a.total&&(a.finished=!0)},H=(n,t)=>{if(!Array.isArray(n)){W.fail("不支持预览的图片来源");return}we({images:n,startPosition:t})};return(n,t)=>{const d=x("van-icon"),w=x("van-image"),R=x("van-popover"),ue=x("i18n-t"),J=x("VanButton"),me=x("VanList");return i(),k(be,{title:n.$t("order.Platform intervention"),class:"bg-gray1 font-Puhui font-normal relative shopGoodsPage h-full px-3","theme-vars":{"field-placeholder-text-color":"#A6A6A6"},ref:(s,F)=>{F.shopGoodsRef=s}},{right:f(()=>[h(Ae)]),default:f(()=>[h(me,{class:"mt-2.5",loading:c(a).loading,"onUpdate:loading":t[2]||(t[2]=s=>c(a).loading=s),finished:c(a).finished,"finished-text":n.$t("common.noMore"),"loading-text":n.$t("common.loading"),onLoad:z},{default:f(()=>[(i(!0),r(g,null,$(c(a).list,s=>(i(),k(Ze,{key:s.id,order:s,isService:!0},{default:f(()=>{var F,q,M,U,K,Q;return[e("div",We,[e("div",Ye,l(n.$t("refund.reasonforreturn")),1),e("div",et,l(T(s)),1)]),e("div",{class:Z(["min-h-[36px] w-full bg-[#F5F5F5] rounded-lg mt-3 p-2",{"h-auto":s.showExtContent}])},[e("div",tt,[st,e("div",{onClick:u=>E(s,!s.showExtContent)},[h(d,{name:"arrow-down",color:"#585654",class:Z({"rotate-180":s.showExtContent})},null,8,["class"])],8,nt)]),s.showExtContent?(i(),r("div",ot,[(F=I(s))!=null&&F.content?(i(),r("div",it,[at,e("div",rt," 买家于 "+l(s.refundInfo.interveneSubmitTime)+" 发起申请 ",1),e("div",null,[e("p",lt,l(((q=I(s))==null?void 0:q.content)||"--"),1)]),e("div",dt,[(i(!0),r(g,null,$((M=I(s))==null?void 0:M.imgs,(u,j)=>(i(),k(w,{key:u,src:u,width:"72",height:"72",class:"w-[72px] h-[72px] rounded-md overflow-hidden bg-[#d9d9d9]",onClick:fe=>{var b;return H((b=I(s))==null?void 0:b.imgs,j)}},null,8,["src","onClick"]))),128))])])):y("",!0),(U=D(s))!=null&&U.content?(i(),r("div",ct,[ut,e("div",mt," 商家于 "+l(s.refundInfo.interveneSubmitTime)+" 发起申请 ",1),e("div",null,[e("p",ft,l(((K=D(s))==null?void 0:K.content)||"--"),1)]),e("div",pt,[(i(!0),r(g,null,$((Q=D(s))==null?void 0:Q.imgs,(u,j)=>(i(),k(w,{key:u,src:u,width:"72",height:"72",class:"w-[72px] h-[72px] rounded-md overflow-hidden bg-[#d9d9d9]",onClick:fe=>{var b;return H((b=D(s))==null?void 0:b.imgs,j)}},null,8,["src","onClick"]))),128))])])):y("",!0)])):y("",!0)],2),e("div",ht,[e("div",vt,[gt,h(R,{show:c(_),"onUpdate:show":t[1]||(t[1]=u=>ye(_)?_.value=u:null),placement:"top-start"},{reference:f(()=>[e("div",{onClick:t[0]||(t[0]=L(u=>c(A)(!c(_)),["stop"]))},wt)]),default:f(()=>[e("div",_t,[e("div",xt,[h(d,{name:"warning",color:"#FEA021",size:"14"}),S(" "+l(n.$t("order.saleAuth")),1)])])]),_:1},8,["show"])]),s.refundInfo.interventions&&s.refundInfo.interventions.length>0?(i(),r("div",bt,[(i(!0),r(g,null,$(s.refundInfo.interventions,u=>(i(),r("div",{class:"flex items-center text-sm font-normal font-Puhui text-b2",key:u.id},[h(ue,{keypath:"order.saleAuthRes",tag:"span"},{address:f(()=>[e("span",$t,l(c(ae)(u.address,"....",5,4)),1)]),res:f(()=>[S(l(u.status===1?n.$t("common.agree"):n.$t("common.reject")),1)]),_:2},1024),u.status===1?(i(),r("img",kt)):(i(),r("img",Bt))]))),128))])):y("",!0)]),m?(i(),r("div",Ct,[h(J,{class:"handle-btn-green whitespace-nowrap text-sm font-normal text-white min-w-[80px]",onClick:L(u=>O(s,1),["stop"]),loading:c(v),disabled:P(s)||c(v)},{default:f(()=>[S(l(re(s)),1)]),_:2},1032,["onClick","loading","disabled"]),h(J,{class:"handle-btn-red whitespace-nowrap text-sm font-normal text-white min-w-[80px]",onClick:L(u=>O(s,2),["stop"]),loading:c(v),disabled:P(s)||c(v)},{default:f(()=>[S(l(le(s)),1)]),_:2},1032,["onClick","loading","disabled"])])):y("",!0)]}),_:2},1032,["order"]))),128))]),_:1},8,["loading","finished","finished-text","loading-text"])]),_:1},8,["title"])}}}),Mt=ee(Et,[["__scopeId","data-v-3f48b007"]]);export{Mt as default};
