import{y as Q,F as d,G as a,H as t,Q as y,l as le,r as _,D as ie,O as R,P as e,_ as F,w as te,N as it,Z as H,$ as G,T as _e,x as C,z as ct,R as K,I as J,J as he,a9 as Ee,E as ae,K as W,a1 as nt,bc as we,bd as xe,a3 as Ct,Y as P,X as ee,n as ve,a4 as Bt,be as E,bf as Ut,bg as at,bh as Pt,bi as zt,t as lt}from"./vendor-BlU_hoYl.js";import{L as At,I as Nt}from"./LevelPop-DxkQgwHj.js";import{_ as Et,a as Ft,E as Dt,H as Ot}from"./EditUserNamePop-g8CuMLTQ.js";import{_ as Mt}from"./avatarRing-CLGxkH-F.js";import{U as Wt}from"./UserAsset-BnLcZmc5.js";import{u as Fe,f as be,a as rt,b as ut,p as ge,c as jt,d as j,e as ce,h as Ht,g as Gt,m as qt,i as Vt,j as Qt,o as Zt,k as Yt,l as Xt,n as M,q as Jt}from"./index-Clz0Qna-.js";import{_ as Kt}from"./information-BXOyO4i9.js";import{_ as es}from"./mcoin-logo-1-Deho8IWN.js";import{u as dt}from"./usePointRelase-BglfB9Fl.js";import{L as Ne}from"./Lottie_v2-CXH4aUEt.js";import{I as ts,W as ss}from"./WithdrawPop-DkXrQVa_.js";import{a as os}from"./activityContract-DsNYbmYi.js";import{q as ns,u as as}from"./user-ssxe-KiY.js";import{b as ls}from"./browser-DFlSdkZC.js";import"./close-BkqxFSX4.js";import"./PopHeader-CndzkqJ4.js";import"./TokenBalance-BY2ZrYo2.js";import"./level-CS7nu5Dm.js";import"./ChangeRegionPop-CQAokX6U.js";import"./arrow-C-JiYSPQ.js";import"./arrow-bottom-D85vJawE.js";import"./ApproveButton-1R_lVfZi.js";import"./MCOIN-Bodfn-v1.js";const is=""+new URL("../images/edit-D2b4Y7Fs.svg",import.meta.url).href,cs={class:"flex items-center justify-start text-lg mt-1"},rs={class:"truncate text-sm text-b1 font-semibold line-clamp-1"},us=t("img",{src:is,class:"w-4 h-4"},null,-1),ds=[us],ms=Q({props:{userName:null},emits:["handleToEditName"],setup(o,{emit:v}){return(r,u)=>(a(),d("div",cs,[t("div",rs,y(o.userName),1),t("div",{class:"ml-1 text-primary",onClick:u[0]||(u[0]=l=>v("handleToEditName"))},ds)]))}}),ps={class:"relative pt-3 px-3 pb-1"},fs={class:"avatar-wrap flex flex-row justify-start items-center"},hs={class:"relative flex-shrink-0"},vs=t("img",{class:"w-[32px] h-[32px] relative m-auto",src:Mt},null,-1),gs={class:"text-xs font-Puhui text-center px-1"},_s={class:"nickname-wrap h-[36px]"},ws=Q({props:{info:null,vsageUserInfo:null,isTag:{type:Boolean},tokens:null},emits:["setEditNameShow","setLevelShow"],setup(o,{emit:v}){const{getCurrentAccount:r}=Fe(),u=le(),{memberLevels:l}=be(),{changeUserInfo:i,userInfo:$}=rt(),m=_(($==null?void 0:$.storeMemberLevel)||0),x=async()=>{m.value=await l(),i({...$,storeMemberLevel:m.value})},S=f=>{u.push(f)},p=()=>{v("setEditNameShow")};return ie(()=>{x()}),(f,c)=>{var k;return a(),d("div",ps,[t("div",fs,[t("div",hs,[vs,t("div",{class:"bg-white rounded-xl flex text-center absolute right-[-14px] bottom-[-4px] min-w-max",onClick:c[0]||(c[0]=g=>v("setLevelShow"))},[t("p",gs," V"+y(m.value||0),1)])]),R(Wt,{tokens:o.tokens,onHandleTo:S,class:"w-full ml-6"},null,8,["tokens"])]),t("div",_s,[R(ms,{class:"min-w-max","user-name":((k=o.vsageUserInfo)==null?void 0:k.nickName)||e(ut)(e(r)()||"-","...",5,4),onHandleToEditName:p},null,8,["user-name"])])])}}}),xs=""+new URL("../images/tools-scan-C28Ke7ai.png",import.meta.url).href,bs=""+new URL("../images/tools-trans-Ck2uxaL4.png",import.meta.url).href,ys=""+new URL("../images/tools-share-Dmjj9UlR.png",import.meta.url).href,$s=""+new URL("../images/tools-i18n-cOjffy46.png",import.meta.url).href,ye=o=>(H("data-v-74f1ba01"),o=o(),G(),o),Ss={class:"flex flex-col justify-start items-center absolute right-3 top-[54px]"},Is=ye(()=>t("img",{src:xs,alt:"扫码"},null,-1)),ks=[Is],Ts=ye(()=>t("img",{src:bs,alt:"转账"},null,-1)),Rs=[Ts],Ls=ye(()=>t("img",{src:ys,alt:"分享"},null,-1)),Cs=[Ls],Bs={class:"tool-item"},Us=ye(()=>t("img",{src:$s,alt:"语言"},null,-1)),Ps={emits:["handleTo","scan","invite"],setup(o,{emit:v}){const{t:r}=te(),{members:u}=be(),l=()=>{v("scan")},i=()=>{v("handleTo","/collect")},$=async()=>{if(!await u())return _e(r("home.inviteTip"));v("invite")};return(m,x)=>(a(),d("div",Ss,[t("div",{class:"tool-item",onClick:l},ks),t("div",{class:"tool-item",onClick:i},Rs),t("div",{class:"tool-item",onClick:$},Cs),t("div",Bs,[R(Et,{position:"right"},{icon:it(()=>[Us]),_:1})])]))}},zs=F(Ps,[["__scopeId","data-v-74f1ba01"]]),De=o=>(H("data-v-a99e19b8"),o=o(),G(),o),As={class:"point-days rounded-lg"},Ns={class:"relative w-full"},Es=De(()=>t("img",{src:Ft,class:"absolute top-0 right-0 -z-1"},null,-1)),Fs={key:0,class:"z-10"},Ds={key:0,class:"text-[#000] font-semibold text-2xl flex items-end z-10"},Os={class:"time-text-shadow"},Ms={class:"text-xs"},Ws={key:1,class:"text-[#000] font-semibold text-2xl flex items-end z-10"},js={class:"time-text-shadow"},Hs={class:"text-xs text-[#000] font-semibold"},Gs={key:2,class:"text-[#000] font-semibold text-2xl flex items-end z-10"},qs={class:"time-text-shadow"},Vs={class:"text-xs text-[#000] font-semibold"},Qs={key:3,class:"text-[#000] font-semibold text-2xl flex items-end z-10"},Zs={class:"time-text-shadow"},Ys={class:"text-xs text-[#000] font-semibold"},Xs={key:1,class:"text-[#000] font-semibold text-3xl flex items-center z-10"},Js=De(()=>t("span",{class:"time-text-shadow text-3xl font-WorkSans"}," ∞ ",-1)),Ks={class:"ml-1 text-xs pt-3 pl-1"},eo={class:"text-b2 font-normal text-xxs"},to={class:"text-xxs font-bold text-b2"},so=De(()=>t("img",{class:"w-3 h-3 ml-[2px]",src:Kt},null,-1)),oo=Q({props:{contributes:{default:0},coinPoint:{default:0},userActiveStatus:{default:0},userActiveTime:{default:null}},emits:["handleOpen"],setup(o,{emit:v}){const r=o,{t:u}=te(),l=C(()=>r.userActiveStatus===1?r.userActiveStatus:r.contributes<=1e4?1:0),i=_(0),$=_(0),m=_(0),x=_(0),S=_(0),p=C(()=>($.value=Math.floor(i.value/3600/24)<=0?0:Math.floor(i.value/3600/24),x.value=Math.floor(i.value/3600)<=0?0:Math.floor(i.value/3600),m.value=Math.floor(i.value/60)<=0?0:Math.floor(i.value/60),S.value=Math.floor(i.value)<=0?0:Math.floor(i.value),[$.value,x.value,m.value,S.value]));let f=null;return ct(()=>{var c;return(c=r.userActiveTime)==null?void 0:c.cutdownTimestamp},c=>{c&&(i.value=(c-new Date().getTime())/1e3,f&&clearInterval(f),f=setInterval(()=>{i.value>0?i.value--:clearInterval(f)},1e3))},{immediate:!0,deep:!0}),(c,k)=>(a(),d("div",As,[t("div",Ns,[t("div",{class:K(["flex items-end justify-center relative rounded-t-lg p-2 min-w-[80px] overflow-hidden h-[46px]",e(l)?" bg-[#FED73A]":"bg-[#E9E4DE]"])},[Es,o.contributes>=1e4?(a(),d("div",Fs,[e(p)[0]>0?(a(),d("div",Ds,[(a(!0),d(J,null,he(e(ge)(e(p)[0],2),(g,T)=>(a(),d("div",{class:"bg-white w-[23px] h-[30px] rounded-lg mr-1 px-1",key:T},[t("span",Os,y(g),1)]))),128)),t("div",Ms,y(c.$t("common.days")),1)])):e(p)[1]>0?(a(),d("div",Ws,[(a(!0),d(J,null,he(e(ge)(e(p)[1],2),(g,T)=>(a(),d("div",{class:"bg-white w-[23px] h-[30px] rounded-lg mr-1 px-1 overflow-hidden text-center",key:T},[t("span",js,y(g),1)]))),128)),t("div",Hs,y(c.$t("common.hours")),1)])):e(p)[2]>0?(a(),d("div",Gs,[(a(!0),d(J,null,he(e(ge)(e(p)[2],2),(g,T)=>(a(),d("div",{class:"bg-white w-[23px] h-[30px] rounded-lg mr-1 px-1 overflow-hidden text-center",key:T},[t("span",qs,y(g),1)]))),128)),t("div",Vs,y(c.$t("common.minutes")),1)])):(a(),d("div",Qs,[(a(!0),d(J,null,he(e(ge)(e(p)[3],2),(g,T)=>(a(),d("div",{class:"bg-white w-[23px] h-[30px] rounded-lg mr-1 px-1 overflow-hidden text-center",key:T},[t("span",Zs,y(g),1)]))),128)),t("div",Ys,y(c.$t("common.seconds")),1)]))])):(a(),d("div",Xs,[Js,t("div",Ks,y(c.$t("common.days")),1)]))],2),t("div",{onClick:k[0]||(k[0]=g=>v("handleOpen")),class:K(["font-normal pl-4 text-center rounded-b-[4px] pr-2 flex items-center justify-center w-full py-[1px] h-[15px]",e(l)?"bg-[#FFE0B6]":"bg-[#FFF0D9]"])},[t("span",eo,y(e(jt)(e(j)(o.coinPoint,0))),1),t("span",to,y(c.$t("common.credit")),1),so],2)])]))}}),no=F(oo,[["__scopeId","data-v-a99e19b8"]]),ao=""+new URL("../images/go-tr-C6OxuTpH.png",import.meta.url).href,lo=""+new URL("../images/go-tr-icon-D6nG65Ok.png",import.meta.url).href,io=""+new URL("../images/go-tr-arrow-BxXIWQWF.png",import.meta.url).href,Oe=o=>(H("data-v-41206486"),o=o(),G(),o),co=Oe(()=>t("div",{class:"tr-img"},[t("img",{src:ao})],-1)),ro=Oe(()=>t("img",{src:lo,alt:"token right icon",class:"absolute top-[-6px] left-[6px] w-[40px] h-[40px]"},null,-1)),uo={class:"absolute right-[4px] top-0 h-full flex justify-end items-center -translate-y-[2px]"},mo={class:"text-sm font-semibold font-Puhui text-b6"},po=Oe(()=>t("img",{src:io,class:"w-[16px] h-[16px] ml-[2px]"},null,-1)),fo={setup(o){const v=()=>{var u;const r=`${(u=window.location)==null?void 0:u.origin}/ecology/#/maiPledge?refresh=1&origin=main`;window.location.assign(r)};return(r,u)=>(a(),d("div",{class:"go-token-right relative w-[128px]",onClick:v},[co,ro,t("p",uo,[t("span",mo,y(r.$t("ecology.Token Rights road")),1),po])]))}},ho=F(fo,[["__scopeId","data-v-41206486"]]),vo=""+new URL("../images/balance-big-BlAQSRAv.png",import.meta.url).href,go=""+new URL("../images/balance-small-DTMS8DT7.png",import.meta.url).href,_o=""+new URL("../images/visibility-D5JMp6Ho.svg",import.meta.url).href,wo=""+new URL("../images/copy-gray-CDg8kt-2.svg",import.meta.url).href,xo=""+new URL("../images/bank-card-fill-6SZF_gMZ.svg",import.meta.url).href,Z=o=>(H("data-v-0d1f03ca"),o=o(),G(),o),bo={class:"balance-container relative w-full"},yo=Z(()=>t("img",{src:vo,class:"absolute top-0 left-0 w-full h-[107px] z-[1]"},null,-1)),$o=Z(()=>t("img",{src:go,class:"absolute top-2 right-2 w-[40%] h-[39px]"},null,-1)),So={class:"absolute top-0 left-0 w-full h-full p-3 z-[2]"},Io={class:"point-box"},ko={class:"flex items-center font-sm text-b2 font-normal"},To=Z(()=>t("img",{class:"w-4 h-4",src:_o},null,-1)),Ro=[To],Lo={class:"text-xl text-b1 font-Audiowide mt-1 leading-[25px] min-w-max"},Co=Z(()=>t("img",{src:wo,class:"w-3 h-3 ml-2",alt:"copy"},null,-1)),Bo={class:"balance-box"},Uo={class:"balance-item"},Po={class:"balance-icon"},zo=Z(()=>t("img",{src:es,alt:""},null,-1)),Ao={class:"balance-label text-b3 text-sm"},No={class:"balance-value"},Eo=Z(()=>t("div",{class:"divider"},null,-1)),Fo={class:"balance-icon"},Do=Z(()=>t("img",{src:xo},null,-1)),Oo={class:"balance-label text-b3"},Mo={class:"balance-value"},Wo=Q({props:{contributes:{default:0},contributesLoading:{type:Boolean,default:!1},pointBalance:{default:0},mcoinBalance:{default:0},pointLoading:{type:Boolean,default:!1},mcoinLoading:{type:Boolean,default:!1}},setup(o){const v=le(),{getCurrentAccount:r}=Fe(),{contributesStore:u}=ce(),{t:l}=te(),i=_(1),$=()=>{const c=Math.min(window.innerWidth,375);i.value=c/375},m=()=>{u.changeHideIntegral(!u.hideIntegral)},x=()=>{const f=r();f&&Ht(f)},S=C(()=>ut(r()||"-","...",5,4)),p=f=>{v.push(f)};return ie(()=>{window.addEventListener("resize",$)}),Ee(()=>{window.removeEventListener("resize",$)}),(f,c)=>{const k=ae("VanLoading"),g=ae("van-loading");return a(),d("div",bo,[yo,$o,t("div",So,[t("div",Io,[t("div",ko,[t("span",null,y(f.$t("common.credit")),1),t("div",{class:"pl-1",onClick:m},Ro)]),t("div",Lo,[o.contributesLoading?(a(),W(k,{key:0,color:"#000",size:"20"})):(a(),d("span",{key:1,class:"relative",onClick:c[0]||(c[0]=T=>p("/integralDetail"))},y(e(u).hideIntegral?e(j)(o.contributes,2):"***"),1))])]),t("div",{class:"address-box text-b1 font-normal text-xs absolute flex items-center justify-end h-[18px] leading-[18px] top-[16px] right-[20px]",onClick:x},[t("span",null,y(e(S)),1),Co]),t("div",Bo,[t("div",Uo,[t("div",Po,[zo,t("div",Ao,y(f.$t("common.wallet")),1)]),t("div",No,[o.mcoinLoading?(a(),W(g,{key:0,size:"14"})):(a(),d(J,{key:1},[nt(y(e(j)(o.mcoinBalance||0,3)),1)],64))])]),Eo,t("div",{class:"balance-item",onClick:c[1]||(c[1]=T=>p("/balanceDetail"))},[t("div",Fo,[Do,t("div",Oo,y(f.$t("assets.canWithdrawv2")),1)]),t("div",Mo,[o.pointLoading?(a(),W(g,{key:0,size:"14"})):(a(),d(J,{key:1},[nt(y(e(j)(o.pointBalance,3)),1)],64))])])])])])}}}),jo=F(Wo,[["__scopeId","data-v-0d1f03ca"]]),Ho={class:"flex justify-between gap-3"},Go={emits:["invest","withdraw"],setup(o){return(v,r)=>(a(),d("div",Ho,[t("div",{class:"send-btn w-full h-[50px] text-[#FF8812] text-lg text-center flex items-center justify-center",onClick:r[0]||(r[0]=u=>v.$emit("invest"))},y(v.$t("home.invest")),1),t("div",{class:"get-btn w-full h-[50px] text-b1 text-lg text-center flex items-center justify-center",onClick:r[1]||(r[1]=u=>v.$emit("withdraw"))},y(v.$t("home.withdraw")),1)]))}},qo=F(Go,[["__scopeId","data-v-8029a830"]]),Vo=""+new URL("../images/cat-house-BaIWGYDK.png",import.meta.url).href,Qo=""+new URL("../images/cat-shadow-naI2hTWi.svg",import.meta.url).href,Zo=""+new URL("../images/bowl-BUuEu_lz.png",import.meta.url).href,Yo=""+new URL("../images/arrow-right-s-line-DoZN1Qa9.png",import.meta.url).href,Xo=""+new URL("../images/cat-food-CqiIXtTs.png",import.meta.url).href,Jo=o=>(H("data-v-7ab7cf68"),o=o(),G(),o),Ko={class:"text-xs text-white font-semibold text-shadow text-center whitespace-nowrap"},en=Jo(()=>t("img",{src:Xo,alt:"",class:"h-[28px]"},null,-1)),tn={class:"font-semibold text-sm text-[#B67829] display-text-shadow"},sn={key:1},on=Q({props:{scale:{default:1},bubbleLoading:{type:Boolean,default:!1},text:{default:""}},emits:["releaseStart","releaseSuccess","releaseFail"],setup(o,{expose:v,emit:r}){const u=o,{t:l}=te(),{contributesStore:i}=ce(),{handleNaturePoints:$}=dt(),m=C(()=>u.bubbleLoading),x=C(()=>i.freeRelease||0);C(()=>i.releaseLoading),C(()=>i.releaseSecond);const S=_(!1),p=_(!1),f=()=>{if(u.bubbleLoading||S.value||j(x.value)<=0)return;S.value=!0,setTimeout(()=>{p.value=!0,S.value=!1;try{r("releaseStart"),$(c)}catch(k){console.error("release fail:",k),setTimeout(()=>{r("releaseFail"),p.value=!1},1e3)}},500);const c=(k=!0)=>{k?r("releaseSuccess"):(console.error("release fail"),setTimeout(()=>{r("releaseFail"),p.value=!1,console.log("animationFinished",p.value)},1e3))}};return v({handleRelease:f}),(c,k)=>{const g=ae("van-loading");return we((a(),d("div",{class:K(["release-bubble w-[140px] max-w-[140px] h-[140px] max-h-[140px] flex flex-col items-center justify-center",S.value?"release-loading":""]),style:P({width:`${90*o.scale}px`,height:`${90*o.scale}px`}),onClick:f},[t("div",Ko,y(o.text),1),en,t("div",tn,[e(m)?(a(),W(g,{key:0,size:"14",color:"#B67829"})):(a(),d("span",sn," +"+y(e(x)<1?e(j)(e(x),4):e(j)(e(x),2)),1))]),Ct(c.$slots,"default",{},void 0,!0)],6)),[[xe,!p.value]])}}}),nn=F(on,[["__scopeId","data-v-7ab7cf68"]]),mt=o=>(H("data-v-436b4b17"),o=o(),G(),o),an={class:"release-component"},ln={class:"progress-bar__wrap absolute z-10 left-[-16px] top-[50px]"},cn=mt(()=>t("div",{class:"progress_pattern"},null,-1)),rn=[cn],un={class:"progress_word absolute z-10 left-1/2 top-1/2 transform -translate-x-1/2 -translate-y-1/2"},dn=mt(()=>t("img",{class:"absolute z-10 right-[2px] top-1/2 transform -translate-y-1/2 w-[12px] h-[12px]",src:Yo,alt:""},null,-1)),mn={props:{bowlStyle:{type:Object,default:()=>({})},text:{type:String,required:!0},releaseSecond:{type:Number,default:0},bubbleLoading:{type:Boolean,default:!1}},emits:["releaseStart","releaseSuccess","releaseFail"],setup(o,{expose:v,emit:r}){const u=le(),{contributesStore:l}=ce(),i=_(!1),$=C(()=>l.releaseData||{}),m=_(!1),x=C(()=>{const g=+$.value.monthTotal||0,T=+$.value.remainTotal||0;return g>0?T/g:0}),S=()=>{m.value=!0,r("releaseStart")},p=()=>{k(),r("releaseSuccess"),setTimeout(async()=>{await l.fetchUserRelase(),setTimeout(()=>{m.value=!1},1e3)},12e3)},f=()=>{m.value=!1,r("releaseFail")},c=_(null),k=async()=>{i.value=!0,await l.getNaturalReleaseTimes(),i.value=!1};return v({releaseBubbleRef:c}),ie(()=>{k()}),(g,T)=>(a(),d("div",an,[t("img",{src:Zo,class:"cat-food w-[60px] h-[44px] absolute z-[1]",style:P(o.bowlStyle),role:"img",alt:"猫粮盆"},null,4),e(j)(+e(l).freeRelease)>0?(a(),W(nn,{key:0,ref:(h,B)=>{B.releaseBubbleRef=h,c.value=h},class:"absolute left-[-16px] top-[-96px] z-50",style:P([{transition:"opacity 0.2s ease-in"},{opacity:m.value?0:1}]),text:o.text,bubbleLoading:m.value,onReleaseSuccess:p,onReleaseStart:S,onReleaseFail:f},null,8,["style","text","bubbleLoading"])):ee("",!0),t("div",ln,[t("div",{class:"progress_bar relative flex items-center",onClick:T[0]||(T[0]=h=>e(u).push("/releaseTimeDetail"))},[t("div",{class:"progress_act",style:P(`width: calc(${e(x)} * 177px / 2)`)},rn,4),t("div",un,y(e($).remainTotal||0)+"/"+y(e($).monthTotal||0),1),dn])])]))}},pn=F(mn,[["__scopeId","data-v-436b4b17"]]),fn={class:"multi-lottie-container relative"},hn={props:{animation:{type:String,default:"wink",validator:o=>["eat2","eat1","wink"].includes(o)},lottieClass:{type:String,default:""},lottieStyle:{type:Object,default:()=>({})}},emits:["complete"],setup(o,{expose:v,emit:r}){const u=o,l={eat2:{path:"lottie/eat_v2.json",loop:!0},eat1:{path:"lottie/eat.json",loop:!1},wink:{path:"lottie/wink.json",loop:!0}},i=_(u.animation),$=_(null),m=_(null),x=_(null),S=C(()=>{switch(i.value){case"eat2":return $.value;case"eat1":return m.value;case"wink":return x.value;default:return x.value}});ct(()=>u.animation,h=>{h!==i.value&&["eat2","eat1","wink"].includes(h)&&(i.value=h,ve(()=>{p()}))});const p=()=>{const h=S.value;if(h)try{i.value==="wink"?h.handlePlay():h.handleGoToAndPlay(0)}catch(B){console.warn("Failed to play animation:",B)}},f=()=>{i.value!=="wink"&&(i.value="wink",ve(()=>{p()})),r("complete",i.value)};return v({setAnimation:h=>{["eat2","eat1","wink"].includes(h)?(i.value=h,ve(()=>{p()})):console.warn(`Invalid animation key: ${h}`)},play:()=>{p()},pause:()=>{const h=S.value;if(h&&typeof h.pause=="function")try{h.handlePause()}catch(B){console.warn("Failed to pause animation:",B)}},stop:()=>{const h=S.value;if(h&&typeof h.stop=="function")try{h.handleStop()}catch(B){console.warn("Failed to stop animation:",B)}},getCurrentLottieRef:S}),ve(()=>{p()}),(h,B)=>(a(),d("div",fn,[we(R(Ne,{class:K(["lottie-item eat-2",o.lottieClass]),style:P(o.lottieStyle),path:l.eat2.path,loop:l.eat2.loop,ref:(A,D)=>{D.eat2Ref=A,$.value=A},autoplay:!1,onComplete:f},null,8,["class","style","path","loop"]),[[xe,i.value==="eat2"]]),we(R(Ne,{class:K(["lottie-item",o.lottieClass]),style:P(o.lottieStyle),path:l.eat1.path,loop:l.eat1.loop,ref:(A,D)=>{D.eat1Ref=A,m.value=A},autoplay:!1,onComplete:f},null,8,["class","style","path","loop"]),[[xe,i.value==="eat1"]]),we(R(Ne,{class:K(["lottie-item",o.lottieClass]),style:P(o.lottieStyle),path:l.wink.path,loop:l.wink.loop,autoplay:!0,ref:(A,D)=>{D.winkRef=A,x.value=A},onComplete:f},null,8,["class","style","path","loop"]),[[xe,i.value==="wink"]])]))}},vn=F(hn,[["__scopeId","data-v-7a50b9a2"]]),gn=""+new URL("../images/roadSigns-DPiZ1yw1.png",import.meta.url).href,_n={},wn={class:"p-3 flex justify-center items-center"},xn=t("img",{src:gn,alt:"road-sign",class:"w-[78px]"},null,-1),bn=[xn];function yn(o,v){return a(),d("div",wn,bn)}const $n=F(_n,[["render",yn]]),Sn=""+new URL("../images/cat-house-min-D9fPn9IA.webp",import.meta.url).href,pt=o=>(H("data-v-1322bf64"),o=o(),G(),o),In={class:"mascot-cat__container relative"},kn=pt(()=>t("div",{class:"pre-bg"},null,-1)),Tn=["lowsrc"],Rn=["src"],Ln=pt(()=>t("img",{src:Qo,class:"w-[100px]",alt:"猫影子"},null,-1)),Cn=[Ln],Bn={props:{vsageUserInfo:{type:Object,default:()=>({})}},emits:["releaseStart","releaseSuccess","releaseFail"],setup(o,{expose:v,emit:r}){const u=o,l=le(),{t:i}=te(),{contributesStore:$}=ce();dt();const m=C(()=>{var U,z;return console.log("nftId",(U=u.vsageUserInfo)==null?void 0:U.nftTokenId),(z=u.vsageUserInfo)==null?void 0:z.nftTokenId}),x=_(1),S=_(0),p=()=>{let z=0;window.innerWidth>=640?z=375:z=window.innerWidth,S.value=Number(z),x.value=z/375},f=C(()=>({transform:` scale(${x.value})`,transformOrigin:"top left",top:`${.6784*S.value+5}px`,left:`${50*x.value}px`,zIndex:10})),c=C(()=>({transform:`scale(${x.value})`,transformOrigin:"top right",top:`${.6784*S.value+6}px`,right:`${12*x.value-10}px`})),k=C(()=>({width:"140px",top:`${.6784*S.value+-60}px`,zIndex:2})),g=C(()=>({width:"100px",top:`${.6784*S.value+79}px`,zIndex:1})),T=_(null),h=_("wink"),B=U=>{h.value=U,T.value&&T.value.setAnimation(U)},A=()=>{r("releaseStart"),B("eat2")},D=()=>{B("eat2"),setTimeout(()=>{r("releaseSuccess")},3e3),setTimeout(()=>{B("wink")},4e3)},re=()=>{r("releaseFail"),B("wink")},$e=()=>{console.log("handleToPlaza"),l.push({path:"/plaza",query:{from:"home"}})};return ie(()=>{window.addEventListener("resize",p),p()}),Ee(()=>{window.removeEventListener("resize",p)}),v({setLottie:B}),(U,z)=>(ae("van-button"),a(),d("div",In,[kn,t("img",{lowsrc:e(Sn),src:Vo,class:"cat-house w-[257px] h-[252px] absolute top-[31px] left-0 z-0",style:P({transform:` scale(${x.value})`,transformOrigin:"top left"}),role:"img",decoding:"async",alt:"猫爬架"},null,12,Tn),R(pn,{ref:(Y,se)=>{se.releaseComponentRef=Y},text:U.$t("integral.nature"),"release-second":e($).releaseSecond,onReleaseStart:A,onReleaseSuccess:D,onReleaseFail:re,style:P(e(f))},null,8,["text","release-second","style"]),e(m)===-1||e(m)===null||e(m)===void 0?(a(),W(vn,{key:0,class:"pointer-events-none mx-auto absolute w-[140px] left-0 right-0",style:P(e(k)),animation:h.value,ref:(Y,se)=>{se.multiLottieRef=Y,T.value=Y}},null,8,["style","animation"])):(a(),d("div",{key:1,class:"absolute ip-box-img left-0 right-0 mx-auto flex justify-center items-center",style:P(e(k))},[t("img",{src:e(Gt)(`nft/nft-${e(m)}.png`)},null,8,Rn)],4)),e(m)===-1||e(m)===null||e(m)===void 0?(a(),d("div",{key:2,class:"cat-shadow pointer-events-none mx-auto absolute w-[100px] left-0 right-0 bottom-0",style:P(e(g))},Cn,4)):ee("",!0),R($n,{class:"absolute",style:P(e(c)),onClick:Bt($e,["self"])},null,8,["style","onClick"]),ee("",!0)]))}},Un=F(Bn,[["__scopeId","data-v-1322bf64"]]),Pn=o=>(H("data-v-3bb5d0c8"),o=o(),G(),o),zn={class:"relative home-app w-full overflow-hidden font-Puhui"},An={class:"home__container h-auto pb-20 w-full"},Nn={class:"top-ui__wrap relative z-20"},En={class:"bottom-ui__wrap flex flex-col justify-end px-3 pb-[90px] w-full z-10 pointer-events-none"},Fn={class:"flex items-end justify-between pointer-events-none"},Dn={class:"mt-3 pointer-events-auto"},On={class:"mt-3 pointer-events-auto"},Mn={key:0,class:"fixed top-0 bottom-0 left-0 right-0 z-50 min-h-screen min-w-screen"},Wn=Pn(()=>t("div",{style:{color:"red"},class:"frame"},null,-1)),jn=Q({name:"Home"});function Hn(o){var tt,st;qt();const{activeStatus:v,activeAmounts:r}=os(),{getCurrentAccount:u}=Fe(),{contributesStore:l}=ce(),{pointBalances:i,pointWithdraw:$}=be(),m=Vt(),x=Qt(),{trade:S}=be(),{tradeWithUsdt:p}=Zt(),{t:f}=te(),c=le(),[k,g]=E(!1),[T,h]=E(!1),[B,A]=E(!1),[D,re]=E(!1),[$e,U]=E(!1),[z,Y]=E(!0),[se,ft]=E(!0),[Me,ue]=E(!1),[ht,q]=E(!1),[We,Se]=E(!1),[vt,Ie]=E(!1),je=_(null),{userInfo:V,changeUserInfo:gt}=rt(),{getOneBalance:de}=Yt(),oe=_(["MCOIN","MUSD","MAI"]),w=Ut({nftActive:!1,userInfo:{address:"",userName:""},contributesOld:0,userContributes:{contributes:0,consumes:0,payments:0,releaseSecond:0},vsageUserInfo:{nickName:((tt=V==null?void 0:V.vsageUserInfo)==null?void 0:tt.nickName)||"",nftTokenId:((st=V==null?void 0:V.vsageUserInfo)==null?void 0:st.nftTokenId)||-1},nftId:-1,coinPoint:0,userActiveStatus:0,userActiveTime:null,pointBalance:null,mcoinBalance:null,usdtBalance:null,allowance:0}),ke=async()=>{w.pointBalance=await i(),Y(!1)},me=async()=>{w.mcoinBalance=await(await m).balanceOf(),ft(!1)},Te=async()=>{try{w.usdtBalance=await(await x).balanceOf(u())}catch{w.usdtBalance=0}},He=async()=>{const s=await(await m).allowance(Jt.flashMall);w.allowance=s.result},Ge=s=>{if(typeof s=="string"&&s.indexOf("address")!==-1&&(s.indexOf("offlineSubmit")!==-1||s.indexOf("pay")!==-1)){g(!1);const n=M(s,"address"),I=M(s,"ratio"),L=M(s,"caddr"),b=M(s,"cname"),N=M(s,"amount"),X=M(s,"orderType"),ne=M(s,"key");c.push({path:"/offlineSubmit",query:{address:n,ratio:I,caddr:L,cname:b,amount:N,orderType:X,key:ne}})}if(typeof s=="string"&&s.indexOf("goodsDetail")!==-1&&s.indexOf("id")!==-1&&(g(!1),c.push({path:"/goodsDetail",query:{id:s.split("=")[1]}})),typeof s=="string"&&s.indexOf("offlineGoodsDetail")!==-1&&s.indexOf("goodsId")!==-1){const n=M(s,"goodsId"),I=M(s,"storeId");let L={};n&&(L.goodsId=n),I&&(L.storeId=I),g(!1),c.push({path:"/offlineGoodsDetail",query:L})}if(typeof s=="string"&&s.indexOf("shop")!==-1&&s.indexOf("shopId")!==-1&&(g(!1),c.push({path:"/shop",query:{shopId:s.split("=")[1]}})),typeof s=="string"&&s.indexOf("category")!==-1&&s.indexOf("shopId")!==-1){const n=_t(s,"shopId");g(!1),c.push({path:"/category",query:{deliveryType:1,init:1,shopId:n}})}};function _t(s,n){const I=s.substring(s.indexOf("#")+1),L=I.indexOf("?"),b=L!==-1?I.substring(L+1):"";return new URLSearchParams(b).get(n)}const wt=s=>{s.catch(()=>{_e(f("common.scanError")),g(!1)})},qe=()=>{h(!1),A(!0)},Re=s=>{c.push(s)},Ve=async()=>{const s=await as(u());!s.success||!s.data||(w.contributesOld=w.userContributes.contributes||0,w.userInfo=s.data)},Qe=_(),xt=C(()=>Qe.value&&Qe.value.memberLevel||0),bt=async()=>{if(!lt.isConnected()||!ls.versions.android)return g(!0);lt.invokeQRScanner().then(s=>{Ge(s)}).catch(s=>{_e(s)})},Le=async()=>{const s=await ns();!s.success||!s.data||(w.vsageUserInfo=s.data,gt({...V,vsageUserInfo:w.vsageUserInfo}))},yt=async(s,n,I)=>{if(I==="USDT")$t(s,n);else{q(!0);try{const L=await S(u(),s,n);if(!L.success)return q(!1);await L.result.wait(),q(!1),ue(!1),Ce("eat1"),Be(),setTimeout(()=>{l.getNaturalReleaseTimes()},3e3)}finally{q(!1)}}},$t=async(s,n)=>{q(!0);try{const I=await p(u(),s,n);if(!I.success)return;await I.result.wait(),q(!1),ue(!1),Ce("eat1"),Be(),setTimeout(()=>{l.getNaturalReleaseTimes()},3e3)}finally{q(!1)}},St=s=>{s==="USDT"?Te():me()},It=async(s,n)=>{Ie(!0);try{const I=await $(s,n);if(Ie(!1),!I.success)return;_e(f("maiPledge.Extraction successful")),Se(!1),Ce("eat1"),Be(),setTimeout(()=>{l.getNaturalReleaseTimes()},3e3),je.value.amount=null}finally{Ie(!1)}},Ze=async()=>{var L,b,N;const s=await r();w.coinPoint=+s||0;const n=await v();if(!n.success)return;w.userActiveStatus=Number(((L=n.result)==null?void 0:L.status)||0);const I=Xt(((b=n.result)==null?void 0:b.time)*1e3);w.userActiveTime={dateTime:I,cutdownTimestamp:+((N=n.result)==null?void 0:N.time)*1e3,m:I.split("-")[1].padStart(2,"0"),d:I.split("-")[2].split(" ")[0].padStart(2,"0"),h:I.split("-")[2].split(" ")[1].split(":")[0].padStart(2,"0")}},Ye=_(null),Ce=s=>{Ye.value.setLottie(s)},Be=async()=>{Ve(),l.fetchContributes(),Le(),Ze(),ke(),me(),Te(),He(),oe.value.forEach(s=>de(s)),setTimeout(()=>{document.title="首页"},500)},Ue=_(!1),Pe=()=>{Ve(),Le(),He(),setTimeout(()=>{document.title="首页"},500)},O=at(()=>{Ue.value&&(localStorage.getItem("isRegister")?(localStorage.removeItem("isRegister"),setTimeout(()=>{l.fetchContributes(),l.fetchRelaseByScan()},3e3)):(l.fetchContributes(),l.fetchRelaseByScan()),Ze(),ke(),me(),Te())},3e4,{immediateCallback:!0});let pe,ze;const kt=()=>{O.pause()},Tt=()=>{O.resume(),ze=0,pe=at(()=>{ze<3?(console.log("getPointBalance/getMcoinBalance"),ke(),me(),oe.value.forEach(s=>de(s))):pe.pause(),ze++},3e3)},Rt=()=>{O.resume()},Xe=_(375),Je=_(0),Ae=()=>{Xe.value=window.innerWidth,Je.value=window.innerHeight,setTimeout(()=>{fe()},100)};C(()=>Math.min(640,Xe.value)/Je.value);const Ke=_(0),et=_(0),fe=()=>{const s=document.querySelector(".top-ui__wrap"),n=document.querySelector(".bottom-ui__wrap"),I=document.querySelector(".main-ui__wrap");if(s&&n){const L=s.getBoundingClientRect(),b=n.getBoundingClientRect(),N=I.getBoundingClientRect(),X=L.bottom,ne=b.top,Lt=N.top,ot=X+(ne-X)/2;return Ke.value=ot-235||0,et.value=Math.max(Lt+40,88),{topUiBottom:X,bottomUiTop:ne,centerPoint:ot,distance:ne-X}}else return null};return ie(()=>{Pe(),Ae(),window.addEventListener("resize",Ae),l.releaseSecond=0,l.releaseSecondFlag=!1,l.freeRelease=0,setTimeout(()=>{fe()},100),document.addEventListener("visibilitychange",function(){document.hidden||(Pe(),oe.value.forEach(s=>de(s)),setTimeout(()=>{l.getNaturalReleaseTimes()},3e3),setTimeout(()=>{fe()},100),O.pause(),setTimeout(()=>{Ue.value=!0,O.resume()},500),console.log("fm-home show"))})}),Pt(()=>{Pe(),oe.value.forEach(s=>de(s)),setTimeout(()=>{l.getNaturalReleaseTimes()},3e3),setTimeout(()=>{fe()},100),O.pause(),setTimeout(()=>{Ue.value=!0,O.resume()},500)}),Ee(()=>{window.removeEventListener("resize",Ae),O&&O.pause(),pe&&pe.pause()}),(s,n)=>{var L;const I=ae("van-icon");return a(),d("div",zn,[t("div",An,[t("div",Nn,[t("div",{class:"bg-test absolute left-0 top-0 w-full",style:P({height:et.value+"px"})},null,4),R(ws,{tokens:oe.value,info:e(w).userInfo,vsageUserInfo:e(w).vsageUserInfo,onSetLevelShow:n[0]||(n[0]=b=>e(h)(!0)),onSetEditNameShow:n[1]||(n[1]=b=>e(re)(!0))},null,8,["tokens","info","vsageUserInfo"]),R(zs,{onHandleTo:Re,onScan:bt,onInvite:qe})]),t("div",{class:"main-ui__wrap w-full absolute top-0",style:P({transform:`translateY(${Ke.value}px)`})},[R(Un,{ref:(b,N)=>{N.gameGrassRef=b,Ye.value=b},vsageUserInfo:e(w).vsageUserInfo,onReleaseStart:kt,onReleaseSuccess:Tt,onReleaseFail:Rt},null,8,["vsageUserInfo"])],4),t("div",En,[t("div",Fn,[R(no,{class:"point-times__wrap pointer-events-auto",contributes:e(l).contributes,coinPoint:e(w).coinPoint,userActiveStatus:e(w).userActiveStatus,userActiveTime:e(w).userActiveTime,onHandleOpen:n[2]||(n[2]=b=>e(U)(!0))},null,8,["contributes","coinPoint","userActiveStatus","userActiveTime"]),R(ho,{onHandleTo:Re,class:"pointer-events-auto"})]),t("div",Dn,[R(jo,{contributes:e(l).contributes,contributesLoading:e(l).loading,pointBalance:e(w).pointBalance,mcoinBalance:e(w).mcoinBalance,pointLoading:e(z),mcoinLoading:e(se)},null,8,["contributes","contributesLoading","pointBalance","mcoinBalance","pointLoading","mcoinLoading"])]),t("div",On,[R(qo,{onInvest:n[3]||(n[3]=b=>e(ue)(!0)),onWithdraw:n[4]||(n[4]=b=>e(Se)(!0))})])])]),R(At,{show:e(T),userInfo:e(w).userInfo,memberLevel:e(xt),onClose:n[5]||(n[5]=b=>e(h)(!1)),onInvite:qe,onHandleTo:Re},null,8,["show","userInfo","memberLevel"]),R(Nt,{show:e(B),onClose:n[6]||(n[6]=b=>e(A)(!1))},null,8,["show"]),e(k)?(a(),d("div",Mn,[t("div",{class:"absolute z-50 text-white top-2 left-2",onClick:n[7]||(n[7]=b=>e(g)(!1))},[R(I,{name:"arrow-left"})]),R(e(zt.QrStream),{onDecode:Ge,onInit:wt},{default:it(()=>[Wn]),_:1})])):ee("",!0),R(Dt,{show:e(D),userName:(L=e(w).vsageUserInfo)==null?void 0:L.nickName,onClose:n[8]||(n[8]=b=>e(re)(!1)),onSuccess:n[9]||(n[9]=b=>Le())},null,8,["show","userName"]),R(Ot,{show:e($e),onClose:n[10]||(n[10]=b=>e(U)(!1))},null,8,["show"]),e(Me)?(a(),W(ts,{key:1,show:e(Me),MCOINBalance:+e(w).mcoinBalance+ +e(w).pointBalance,pointBalance:+e(w).pointBalance,USDTBalance:+e(w).usdtBalance,loading:e(ht),owner:e(u)(),onClose:n[11]||(n[11]=b=>e(ue)(!1)),onHanldeInvest:yt,onChangeBalance:St},null,8,["show","MCOINBalance","pointBalance","USDTBalance","loading","owner"])):ee("",!0),e(We)?(a(),W(ss,{key:2,ref:(b,N)=>{N.withdrawRef=b,je.value=b},show:e(We),balance:e(w).pointBalance,loading:e(vt),onClose:n[12]||(n[12]=b=>e(Se)(!1)),onHandleWithdraw:It},null,8,["show","balance","loading"])):ee("",!0)])}}const Gn=Q({...jn,setup:Hn}),va=F(Gn,[["__scopeId","data-v-3bb5d0c8"]]);export{va as default};
