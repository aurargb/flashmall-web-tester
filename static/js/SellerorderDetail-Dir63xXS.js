import{w as F,x as k,r as S,o as be,D as ee,a9 as ye,F as v,X as x,P as r,G as d,H as e,I as Pe,Q as o,y as te,B as Oe,a1 as j,E as U,K as C,N as D,O as R,a4 as M,T as $,_ as we,z as fe,bc as Me,bp as Be,Z as Fe,$ as Ve,a2 as qe,bg as Ee,be as H,R as Le,l as He}from"./vendor-BlU_hoYl.js";import{g as G}from"./orderTime-CrHWsAnM.js";import{u as Ke,a as Ue,b as Ge,c as ze}from"./useOrderActionButtons-BOt9swVU.js";import{_ as V}from"./copy-w-Dr8nkqKW.js";import{h as B,d as q,q as Ze,b as W,l as K,e as Y,u as _e,g as he,R as Qe,o as xe,a4 as Xe}from"./index-UgIL2Smv.js";import{_ as Je,a as We,b as Ye,c as et}from"./remark-CnqNNofH.js";import{_ as z}from"./MCOIN-BOqZVkND.js";import{_ as tt}from"./link-CItP-_Ep.js";import{u as st}from"./useRefund-CagomE1G.js";import{_ as ot}from"./CountdownLabel-CPOIew63.js";import{B as nt}from"./BackIcon-8hcEjDKb.js";import{U as rt}from"./UnfreezePop-DnSKWMt5.js";import{a as at,b as it,c as pe,n as ve}from"./order-ClP3Ze4h.js";import{P as lt}from"./flashSale-DDyqLyYN.js";import{s as dt}from"./refund-DM6xdaIZ.js";import"./credit-0laLclE7.js";import"./useOrderStatus-D1Cw0BRr.js";import"./order-H59PKTFP.js";import"./useShipTemplate-C35bKCd2.js";import"./enums-DlE-aiss.js";import"./default-avatar-DfqlD94j.js";import"./USDT-CNsbs3BR.js";import"./FMCP-yoa9RTPy.js";import"./ApproveButton-FviueR9l.js";const ct={key:0,class:"p-3 break-all bg-white rounded-xl"},ut={class:"font-semibold text-base text-b1"},mt={class:"mr-1"},ft=e("span",null,"请在",-1),ht={class:"text-[#FF8812] mx-1"},xt=e("span",null,"内处理售后申请",-1),pt={key:1},vt=e("span",null,null,-1),bt={class:"mt-1 font-normal text-sm text-b2"},yt={key:0},wt={key:1},_t={props:{order:{type:Object,required:!0},nowTime:{type:Number,required:!0}},emits:["timeDone"],setup(t,{emit:c}){const m=t,{t:I}=F(),p=k(()=>{const u=m.order||{};return Ke(u)}),b=S(Date.now());let a=null;const h=k(()=>{const u=G(m.order.expressTime,m.order.confirmLimit,m.nowTime);return u>0?u*1e3:0}),w=k(()=>{const u=be(h.value).unix();if(u<=0)return null;const s=Math.floor(u/(1e3*60*60*24)),i=Math.floor(u%(1e3*60*60*24)/(1e3*60*60)),l=Math.floor(u%(1e3*60*60)/(1e3*60)),f=Math.floor(u%(1e3*60)/1e3);let y="";return s>0&&(y+=`${s}天`),(i>0||s>0)&&(y+=`${i.toString().padStart(2,"0")}时`),(l>0||i>0||s>0)&&(y+=`${l.toString().padStart(2,"0")}分`),y+=`${f.toString().padStart(2,"0")}秒`,y}),_=()=>{b.value=Date.now(),h.value<=0&&a&&(clearInterval(a),a=null,c("timeDone"))};return ee(()=>{_(),h.value>0&&p.value&&(a=setInterval(_,1e3))}),ye(()=>{a&&(clearInterval(a),a=null)}),(u,s)=>r(p)?(d(),v("div",ct,[e("div",ut,[e("span",mt,[r(w)?(d(),v(Pe,{key:0},[ft,e("span",ht,o(r(w)),1),xt],64)):(d(),v("span",pt,"请及时处理售后申请"))]),vt]),e("div",bt,[r(w)?(d(),v("span",yt," 请关注商品状态，倒计时结束买家申请平台介入 ")):(d(),v("span",wt," 请关注商品状态，买家可申请平台介入 "))])])):x("",!0)}},gt={class:"p-3 break-all bg-white rounded-xl"},kt={class:"title text-b1 text-sm font-semibold flex justify-between"},Ct=e("img",{src:V,class:"w-5 h-5 ml-2",alt:""},null,-1),Tt=[Ct],It={class:"font-normal text-sm text-b1 mt-2"},At={class:"mt-1 text-b1 text-sm font-normal"},Rt={class:"ml-1"},St=te({props:{order:null},setup(t){const{order:c}=t,m=k(()=>`${c.userAddress.provinceName??""}${c.userAddress.cityName??""}${c.userAddress.countyName??""}${c.userAddress.detailInfo??""} ${c.userAddress.userName??""} ${c.userAddress.telNumber??""}`),I=()=>{const p=m.value;B(p)};return(p,b)=>(d(),v("div",gt,[e("div",kt,[e("span",null,o(p.$t("order.buyerAddressInfo")),1),e("div",{class:"text-b1 text-sm font-normal text-right flex items-center",onClick:I},Tt)]),e("div",It,o(t.order.userAddress.provinceName??"")+o(t.order.userAddress.cityName??"")+o(t.order.userAddress.countyName??"")+o(t.order.userAddress.detailInfo??""),1),e("div",At,[e("span",null,o(t.order.userAddress.userName),1),e("span",Rt,o(t.order.userAddress.telNumber??""),1)])]))}}),jt={class:"p-3 break-all bg-white rounded-xl"},Nt={class:"title text-b1 text-sm font-semibold"},Dt={class:"content"},Pt={class:"flex justify-between items-center mt-[16px]"},Ot={class:"text-b3 text-sm font-normal"},Mt={class:"text-b1 text-sm font-normal text-right flex items-center"},Bt=e("div",{class:"flex-shrink-0"},[e("img",{class:"w-[16px] h-[16px]",src:z})],-1),Ft={class:"ml-1"},Vt={key:0,class:"flex justify-between items-center mt-[16px]"},qt={class:"text-b3 text-sm font-normal line-clamp-1 max-w-[100px]"},Et={class:"text-b1 text-sm font-normal text-right flex items-center"},Lt={class:"mr-1"},Ht=e("div",{class:"flex-shrink-0"},[e("img",{class:"w-[16px] h-[16px]",src:z})],-1),Kt={class:"ml-1"},Ut={key:1,class:"flex justify-between items-center mt-[16px]"},Gt={class:"text-b3 text-sm font-normal line-clamp-1 max-w-[100px]"},zt={class:"text-b1 text-sm font-normal text-right flex items-center"},Zt=e("div",{class:"mr-1"},"-",-1),Qt=e("div",{class:"flex-shrink-0"},[e("img",{class:"w-[16px] h-[16px]",src:z})],-1),Xt={class:"ml-1"},Jt={class:"flex justify-between items-center mt-[16px]"},Wt={class:"text-b3 text-sm font-normal"},Yt={class:"text-b1 text-sm font-normal text-right flex items-center"},es=e("div",{class:"flex-shrink-0"},[e("img",{class:"w-[16px] h-[16px]",src:z})],-1),ts={class:"ml-1"},ss={class:"flex justify-between items-center mt-[16px]"},os={class:"text-b3 text-sm font-normal"},ns={class:"text-b1 text-sm font-normal text-right"},rs={class:"flex items-center"},as={class:"flex justify-between items-center mt-[16px]"},is={class:"text-b3 text-sm font-normal"},ls=["href"],ds=e("img",{src:tt,class:"w-5 h-5 ml-1",alt:""},null,-1),cs={key:1},us={class:"flex justify-between items-center mt-4"},ms={class:"text-b3 text-sm font-normal"},fs=e("img",{src:V,class:"w-5 h-5 ml-1",alt:""},null,-1),hs={class:"flex justify-between items-center mt-[16px]"},xs={class:"text-b3 text-sm font-normal"},ps=e("img",{src:V,class:"w-5 h-5 ml-1",alt:""},null,-1),vs={key:2,class:"flex justify-between items-center mt-[16px]"},bs={class:"text-b3 text-sm font-normal"},ys={class:"text-b1 text-sm font-normal text-right"},ws={key:3,class:"flex justify-between items-center mt-[16px]"},_s={class:"text-b3 text-sm font-normal"},gs={class:"text-b1 text-sm font-normal text-right"},$s={key:4,class:"flex justify-between items-center mt-[16px]"},ks={class:"text-b3 text-sm font-normal"},Cs={class:"text-b1 text-sm font-normal text-right"},Ts={key:5,class:"flex justify-between items-center mt-[16px]"},Is={class:"text-b3 text-sm font-normal"},As={class:"text-b1 text-sm font-normal text-right"},Rs={key:6,class:"flex justify-between items-center mt-[16px]"},Ss={class:"text-b3 text-sm font-normal whitespace-nowrap"},js={class:"text-b1 text-sm font-normal text-right flex items-center"},Ns={class:"break-all flex-1"},Ds=e("img",{src:V,class:"w-5 h-5",alt:""},null,-1),Ps=[Ds],Os={key:7,class:"flex justify-between items-center mt-[16px]"},Ms=e("div",{class:"text-b3 text-sm font-normal whitespace-nowrap"}," 发货物流公司 ",-1),Bs={class:"text-b1 text-sm font-normal text-right break-all"},Fs={key:8,class:"flex justify-between items-center mt-[16px]"},Vs=e("div",{class:"text-b3 text-sm font-normal whitespace-nowrap"}," 发货运单号 ",-1),qs={class:"text-b1 text-sm font-normal text-right flex items-center"},Es={class:"break-all flex-1"},Ls=e("img",{src:V,class:"w-5 h-5",alt:""},null,-1),Hs=[Ls],Ks={key:9,class:"flex justify-between items-center mt-[16px]"},Us=e("div",{class:"text-b3 text-sm font-normal whitespace-nowrap"}," 退货物流公司 ",-1),Gs={class:"text-b1 text-sm font-normal text-right break-all"},zs={key:10,class:"flex justify-between items-center mt-[16px]"},Zs=e("div",{class:"text-b3 text-sm font-normal whitespace-nowrap"}," 退货运单号 ",-1),Qs={class:"text-b1 text-sm font-normal text-right flex items-center"},Xs={class:"break-all flex-1"},Js=e("img",{src:V,class:"w-5 h-5",alt:""},null,-1),Ws=[Js],Ys={props:{order:{type:Object,required:!0}},setup(t){const c=t,{t:m}=F(),I=k(()=>{var a,h,w;return(a=c==null?void 0:c.order)!=null&&a.payAddress?(h=c==null?void 0:c.order)==null?void 0:h.payAddress:(w=c==null?void 0:c.order)==null?void 0:w.address}),p=k(()=>{let a=0;return a=new Oe(c.order.totalAmount||0),q(a)}),b=k(()=>{var h;const a=c.order.orderGoods||[];return a.length>0?a[0].discountRatio||0:((h=c.order.stores)==null?void 0:h.discountRatio)||0});return(a,h)=>{var w,_,u,s,i;return d(),v("div",jt,[e("div",Nt,o(a.$t("order.orderInfo")),1),e("div",Dt,[e("div",Pt,[e("div",Ot,o(a.$t("order.total price detail")),1),e("div",Mt,[Bt,e("div",Ft,o(r(q)(t.order.totalAmountOriginal||t.order.totalAmount)),1)])]),t.order.merchantAdjustAmount?(d(),v("div",Vt,[e("div",qt,o(a.$t("order.merchant modify price")),1),e("div",Et,[e("div",Lt,o(t.order.merchantAdjustAmount>0?"+":"-"),1),Ht,e("div",Kt,o(Math.abs(t.order.merchantAdjustAmount)||0),1)])])):x("",!0),t.order.fmGeneralActivity&&t.order.activityReduceAmount?(d(),v("div",Ut,[e("div",Gt,o(((w=t.order.fmGeneralActivity)==null?void 0:w.name)||"-"),1),e("div",zt,[Zt,Qt,e("div",Xt,o(r(q)(t.order.activityReduceAmount)),1)])])):x("",!0),e("div",Jt,[e("div",Wt,o(a.$t("order.total price actual")),1),e("div",Yt,[es,e("div",ts,o(r(p)),1)])]),e("div",ss,[e("div",os,o(a.$t("common.ratio")),1),e("div",ns,[e("div",rs,o(r(b))+"%",1)])]),e("div",as,[e("div",is,o(a.$t("order.hash")),1),t.order.hash?(d(),v("a",{key:0,class:"text-sm font-normal text-right flex items-center underline text-[#FF8812]",href:`${r(Ze).chainConfig.blockExplorerUrls[0]}/tx/${t.order.hash}`},[j(o(r(W)(t.order.hash,"***",9,5)||"--")+" ",1),ds],8,ls)):(d(),v("span",cs," -- "))]),e("div",us,[e("div",ms,o(a.$t("order.orderAddress")),1),e("div",{class:"text-b1 text-sm font-normal text-right flex items-center",onClick:h[0]||(h[0]=l=>r(B)(t.order.address))},[j(o(r(W)(t.order.address,"...",5,5))+" ",1),fs])]),e("div",hs,[e("div",xs,o(a.$t("order.payAddress")),1),e("div",{class:"text-b1 text-sm font-normal text-right flex items-center",onClick:h[1]||(h[1]=l=>r(B)(r(I)))},[j(o(r(W)(r(I),"...",5,5))+" ",1),ps])]),t.order.createTime?(d(),v("div",vs,[e("div",bs,o(a.$t("order.createTime")),1),e("div",ys,o(r(K)(t.order.createTime)),1)])):x("",!0),t.order.chainCreateTime?(d(),v("div",ws,[e("div",_s,o(a.$t("order.chainFinishTime")),1),e("div",gs,o(r(K)(t.order.chainCreateTime)),1)])):x("",!0),t.order.expressTime?(d(),v("div",$s,[e("div",ks,o(a.$t("order.expressTime")),1),e("div",Cs,o(r(K)(t.order.expressTime)),1)])):x("",!0),t.order.finishTime?(d(),v("div",Ts,[e("div",Is,o(a.$t("order.finishTime")),1),e("div",As,o(r(K)(t.order.finishTime)),1)])):x("",!0),t.order.id?(d(),v("div",Rs,[e("div",Ss,o(a.$t("order.orderNumber")),1),e("div",js,[e("div",Ns,o(t.order.id),1),e("div",{class:"ml-1 w-5 h-5 min-w-5 min-h-5",onClick:h[2]||(h[2]=l=>r(B)(t.order.id))},Ps)])])):x("",!0),t.order.expressCompany?(d(),v("div",Os,[Ms,e("div",Bs,o(t.order.expressCompany),1)])):x("",!0),t.order.expressNo?(d(),v("div",Fs,[Vs,e("div",qs,[e("div",Es,o(t.order.expressNo),1),e("div",{class:"ml-1 w-5 h-5 min-w-5 min-h-5",onClick:h[3]||(h[3]=l=>r(B)(t.order.expressNo))},Hs)])])):x("",!0),(_=t.order.refundInfo)!=null&&_.expressCompany?(d(),v("div",Ks,[Us,e("div",Gs,o((u=t.order.refundInfo)==null?void 0:u.expressCompany),1)])):x("",!0),(s=t.order.refundInfo)!=null&&s.expressNo?(d(),v("div",zs,[Zs,e("div",Qs,[e("div",Xs,o((i=t.order.refundInfo)==null?void 0:i.expressNo),1),e("div",{class:"ml-1 w-5 h-5 min-w-5 min-h-5",onClick:h[4]||(h[4]=l=>{var f;return r(B)((f=t.order.refundInfo)==null?void 0:f.expressNo)})},Ws)])])):x("",!0)])])}}},eo={key:0,class:"p-3 break-all bg-white rounded-xl"},to={class:"font-semibold text-base text-b1"},so={class:"text-[#FF8812] mr-1"},oo=e("span",null,"后可确认收货",-1),no=e("div",{class:"mt-1 font-normal text-sm text-b2"},"请关注订单状态",-1),ro={props:{order:{type:Object,required:!0},nowTime:{type:Number,required:!0}},emits:["timeDone"],setup(t,{emit:c}){const m=t,{t:I}=F(),p=S(Date.now());let b=null;const a=k(()=>{const u=G(m.order.expressTime,m.order.confirmLimit,m.nowTime);return u>0?u*1e3:0}),h=k(()=>a.value>0),w=k(()=>{const u=be(a.value).unix();if(u<=0)return"00秒";const s=Math.floor(u/(1e3*60*60*24)),i=Math.floor(u%(1e3*60*60*24)/(1e3*60*60)),l=Math.floor(u%(1e3*60*60)/(1e3*60)),f=Math.floor(u%(1e3*60)/1e3);let y="";return s>0&&(y+=`${s}天`),(i>0||s>0)&&(y+=`${i.toString().padStart(2,"0")}时`),(l>0||i>0||s>0)&&(y+=`${l.toString().padStart(2,"0")}分`),y+=`${f.toString().padStart(2,"0")}秒`,y}),_=()=>{p.value=Date.now(),a.value<=0&&b&&(clearInterval(b),b=null,c("timeDone"))};return ee(()=>{_(),a.value>0&&(b=setInterval(_,1e3))}),ye(()=>{b&&(clearInterval(b),b=null)}),(u,s)=>r(h)?(d(),v("div",eo,[e("div",to,[e("span",so,o(r(w)),1),oo]),no])):x("",!0)}},ao={class:"flex justify-between items-center gap-3 mt-5 fixed left-0 right-0 bottom-0 safe-bottom px-3"},io=e("span",{class:"whitespace-nowrap"},"收到退回商品确认退款",-1),lo={props:{order:{type:Object,required:!0},nowTime:{type:Number,required:!0},shopAddress:{type:String,default:null},btnLoading:{type:Boolean,default:!1}},emits:["handleTo","handleConfirm","handleModifyPrice","handleRefresh"],setup(t,{emit:c}){const m=t,{t:I}=F(),{accountStore:p}=Y();Y(),_e();const b=k(()=>(m.order.status===1||m.order.status===2)&&m.order.payType!=2&&!m.order.merchantsConfirm&&!st(m.order,"MERCHANT_RECEIVE","visible")),a=k(()=>{const i=m.order||{};return Ue(i)}),h=k(()=>{const i=m.order||{};return Ge(i)}),w=k(()=>{const i=m.order||{};return ze(i)}),_=()=>{if(p.isOnlyView)return $($t("order.Requires merchant account operation"));c("handleConfirm",m.order)},u=()=>{if(p.isOnlyView)return $($t("order.Requires merchant account operation"));c("handleMerchantReceive",m.order)},s=()=>{if(p.isOnlyView)return $($t("order.Requires merchant account operation"));c("handlePlatformIntervene",m.order)};return(i,l)=>{const f=U("VanButton");return d(),v("div",ao,[!r(p).isOnlyView&&t.order.status===0&&!t.order.hash?(d(),C(f,{key:0,round:"",class:"flex-1 main-btn font-semibold text-b1 text-base h-[46px] rounded-full",onClick:l[1]||(l[1]=M(y=>r(p).isOnlyView?r($)(i.$t("order.Requires merchant account operation")):i.$emit("handleModifyPrice"),["stop"])),disabled:t.order.hash},{default:D(()=>[j(o(i.$t("order.modifyPrice"))+" ",1),R(ot,{class:"inline-block ml-1",startTime:t.order.createTime,duration:15,durationType:"minutes",showZero:!1,onDone:l[0]||(l[0]=y=>i.$emit("handleRefresh"))},null,8,["startTime"])]),_:1},8,["disabled"])):x("",!0),!r(p).isOnlyView&&r(b)?(d(),C(f,{key:1,round:"",class:"flex-1 gray-btn border-btn font-normal text-base h-[46px] rounded-full",loading:t.btnLoading,onClick:l[2]||(l[2]=M(y=>r(p).isOnlyView?r($)(i.$t("order.Requires merchant account operation")):i.$emit("handleCancel"),["stop"]))},{default:D(()=>[j(o(i.$t("order.cancelOrder")),1)]),_:1},8,["loading"])):x("",!0),!r(p).isOnlyView&&t.order.status===1?(d(),C(f,{key:2,round:"",class:"flex-1 main-btn font-semibold text-b1 text-base h-[46px] rounded-full",onClick:l[3]||(l[3]=M(y=>r(p).isOnlyView?r($)(i.$t("order.Requires merchant account operation")):i.$emit("handleDelivery"),["stop"]))},{default:D(()=>[j(o(i.$t("order.Ship")),1)]),_:1})):x("",!0),r(a)?(d(),C(f,{key:3,round:"",class:"flex-1 main-btn font-semibold text-b1 text-base h-[46px] rounded-full",disabled:r(G)(t.order.expressTime,t.order.confirmLimit,t.nowTime)>0,loading:t.order.loading,onClick:M(_,["stop"])},{default:D(()=>[j(o(i.$t("order.confirmGeted")),1)]),_:1},8,["disabled","loading","onClick"])):x("",!0),r(w)?(d(),C(f,{key:4,round:"",class:"flex-1 gray-btn border-btn font-normal text-base h-[46px] rounded-full",loading:t.btnLoading,onClick:M(s,["stop"])},{default:D(()=>[j(o(i.$t("order.Platform intervention")),1)]),_:1},8,["loading","onClick"])):x("",!0),r(h)?(d(),C(f,{key:5,round:"",class:"flex-1 main-btn font-semibold text-b1 text-base h-[46px] rounded-full",loading:t.order.loading||t.btnLoading,onClick:M(u,["stop"])},{default:D(()=>[io]),_:1},8,["loading","onClick"])):x("",!0)])}}},co={key:0,class:"p-3 break-all bg-white rounded-xl"},uo={class:"font-semibold text-base text-b1"},mo={class:"mt-1 font-normal text-sm text-b2"},fo={props:{order:{type:Object,required:!0}},setup(t){return(c,m)=>t.order.status===0?(d(),v("div",co,[e("div",uo,[e("span",null,o(c.$t("order.seller count down label 1")),1)]),e("div",mo,[e("span",null,o(c.$t("order.seller count down label 2")),1)])])):x("",!0)}},ge=t=>(Fe("data-v-77d0f6f8"),t=t(),Ve(),t),ho={class:"popup-header"},xo={class:"title text-base font-semibold text-b1 whitespace-nowrap"},po={class:"popup-body"},vo={class:"gap-1 text-sm flex justify-between w-full"},bo={class:"text-b2 font-normal text-sm whitespace-nowrap"},yo={class:"flex items-center gap-1 text-b1 text-sm font-normal"},wo=["src"],_o={class:""},go=ge(()=>e("div",{class:"divider"},null,-1)),$o={class:"gap-1 text-sm flex justify-between w-full"},ko={class:"text-b2 font-normal text-sm whitespace-nowrap"},Co={class:"flex items-center gap-1 text-b1 text-sm font-normal"},To=["src"],Io={class:""},Ao=ge(()=>e("div",{class:"divider"},null,-1)),Ro={class:"gap-1 text-sm flex justify-between w-full"},So={class:"text-b2 font-normal text-sm whitespace-nowrap"},jo={class:"flex items-center justify-end text-b1 text-sm font-normal"},No=["placeholder","disabled"],Do={class:"popup-footer w-full mt-4"},Po=te({props:{show:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},order:{type:Object,default:()=>{}}},emits:["update:show","submit"],setup(t,{expose:c,emit:m}){const I=t,{t:p}=F(),b=S(!1),a=S(null);fe(()=>I.show,s=>{b.value=s,a.value=null},{immediate:!0}),fe(()=>b.value,s=>{m("update:show",s)});const h=()=>{b.value=!1,a.value=0},w=s=>{const i=s.target;let l=i.value;l=l.replace(/[^\d.]/g,"");const f=l.split(".");f.length>2&&(l=f[0]+"."+f.slice(1).join("")),l.indexOf("-")>0&&(l=l.replace(/-/g,"")),f.length===2&&f[1].length>8&&(l=f[0]+"."+f[1].substring(0,8)),a.value=l,i.value=l},_=s=>{const i=s.key,l=s.target.value,f=/[\d.-]/,y=["Backspace","Delete","Tab","Enter","ArrowLeft","ArrowRight","ArrowUp","ArrowDown"];if(!f.test(i)&&!y.includes(i)){s.preventDefault();return}if(i==="."&&l.includes(".")){s.preventDefault();return}if(i==="-"&&l.length>0){s.preventDefault();return}},u=()=>{m("submit",a.value)};return c({onClose:h}),(s,i)=>{const l=U("van-icon"),f=U("VanButton"),y=U("van-popup");return d(),C(y,{show:b.value,"onUpdate:show":i[1]||(i[1]=P=>b.value=P),position:"bottom",round:"",style:{width:"100%",borderRadius:"20px 20px 0 0"}},{default:D(()=>[e("div",ho,[e("span",xo,o(s.$t("order.modifyPrice")),1),R(l,{name:"cross",class:"close-icon",onClick:h})]),e("div",po,[e("div",vo,[e("div",bo,o(s.$t("order.rigin price")),1),e("div",yo,[e("img",{src:r(he)("images/tokens/MCOIN.png"),class:"w-5"},null,8,wo),e("span",_o,o(r(q)(t.order.totalAmountOriginal||0)),1)])]),go,e("div",$o,[e("div",ko,o(s.$t("order.last price")),1),e("div",Co,[e("img",{src:r(he)("images/tokens/MCOIN.png"),class:"w-5"},null,8,To),e("span",Io,o(r(q)(t.order.totalAmount||0)),1)])]),Ao,e("div",Ro,[e("div",So,o(s.$t("order.new price")),1),e("div",jo,[Me(e("input",{type:"text",placeholder:s.$t("order.new price placeholder"),class:"text-right text-[#FF8812] text-sm font-normal max-w-[150px]","onUpdate:modelValue":i[0]||(i[0]=P=>a.value=P),disabled:t.loading,onInput:w,onKeypress:_},null,40,No),[[Be,a.value]])])])]),e("div",Do,[R(f,{round:"",class:"flex-1 main-btn font-semibold text-b1 text-base h-[46px] rounded-full w-full",loading:t.loading,onClick:u},{default:D(()=>[j(o(s.$t("common.confirm")),1)]),_:1},8,["loading"])])]),_:1},8,["show"])}}}),Oo=we(Po,[["__scopeId","data-v-77d0f6f8"]]),Mo={class:"absolute left-4 flex items-center gap-1 -translate-y-1/2 top-1/2"},Bo={class:"font-bold text-base text-b1"},Fo={class:"px-3 safe-bottom pt-[50px] flex flex-col gap-3"},Vo=te({setup(t){const{getCurrentStoreId:c}=_e(),{getMerchantDhKey:m,decryptAddressKey:I,decryptKey:p}=Qe(),{cancel:b}=xe(),{clerkStore:a}=Y(),h=qe(),w=He(),{t:_}=F(),u=h.query.id,s=S(null),i=S(!1),l=n=>{const g=n.target.scrollTop;i.value=g>25},f=async()=>{var g,T,N,L,ae,ie,le,de,ce,ue;const n=await at({id:u});if((g=n.data)!=null&&g.userAddress&&(n.data.userAddress.postscript=n.data.postscript),(T=n.data)!=null&&T.userAddress&&((L=(N=n.data)==null?void 0:N.userAddress)!=null&&L.encryptFlag)){const A=await m((ae=n.data)==null?void 0:ae.address,(ie=n.data)==null?void 0:ie.submitUserPubKey);A&&(n.data.userAddress=I(n.data.userAddress,A))}if(n.data.shippingHash){const A=await m(n.data.address,(le=n.data)==null?void 0:le.shippingUserPubKey);if(A){const me=p(n.data.expressNo,A);me.hash===n.data.shippingHash&&(n.data.expressNo=me.decrypt,n.data.expressCompany=p(n.data.expressCompany,A).decrypt)}}if((de=n.data.refundInfo)!=null&&de.shippingHash){const A=await m(n.data.address,(ue=(ce=n.data)==null?void 0:ce.refundInfo)==null?void 0:ue.shippingUserPubKey);A&&(n.data.refundInfo.expressNo=p(n.data.refundInfo.expressNo,A).decrypt,n.data.refundInfo.expressCompany=p(n.data.refundInfo.expressCompany,A).decrypt)}s.value=n.data},y=n=>{w.push(n)},P=()=>{f()},O=S(new Date().getTime()/1e3);Ee(()=>{O.value+=1},1e3);const{merchantConfirm:$e}=xe(),ke=async n=>{if(a.isClerk&&!a.clerkAuth)return $(_("order.Requires merchant account operation"));n.loading=!0;try{const T=(await pe({orderIds:n.id})).data.ordIds,N=await $e(T);if(!N.success)return;if(n.payType!==lt.STORE_CARD){if(!(await ve({ordIds:T,hash:N.result.hash})).success)return;n.merchantsConfirm=1,$.success(_("order.confirmSuccess")),setTimeout(()=>{w.replace({path:"/sellerOrderList",query:{type:1,active:3}})},2e3)}}finally{n.loading=!1}},se=S(null),[Ce,oe]=H(!1),[Te,Z]=H(!1),ne=()=>{Z(!0)},Ie=async n=>{if(!n){$.fail("请输入修改后的价格");return}if(n<=0){$.fail("价格不能小于0");return}oe(!0);const g=await it({orderId:s.value.id,amount:n});oe(!1),g.success&&($.success("修改价格成功"),Z(!1),sessionStorage.setItem("modifiedOrderId",s.value.id.toString()),f())},Ae=()=>{w.push(`/sellerDelivery?id=${s.value.id}&detail=1`)},Re=()=>{h.params.quick==="quackChange"&&ne()},[Q,re]=H(!1),[Se,E]=H(!1),je=async()=>{if(a.isClerk&&!a.clerkAuth)return $(_("order.Requires merchant account operation"));J.value=!1,!Q.value&&(s.value.creditFlag?E(!0):X())},X=async()=>{re(!0);try{const g=(await pe({orderIds:u})).data.ordIds;if(J.value&&!(await dt({orderId:u,type:1})).success)return;const T=await b(g);if(!T.success||!(await ve({ordIds:g,hash:T.result.transactionHash})).success)return;E(!1),f(),setTimeout(()=>{w.push({path:"/sellerOrderList",query:{active:4},replace:!0})},500)}catch(n){$(n.message||n)}finally{re(!1)}},J=S(!1),Ne=async()=>{try{J.value=!0,s.value.creditFlag?E(!0):X()}catch(n){$(n.message||n)}},De=async n=>{y("/refundService?&role=merchants&id="+n.id)};return ee(async()=>{var n;O.value=await Xe(),await f(),se.value=(n=await c())==null?void 0:n.merchant,Re()}),(n,g)=>s.value?(d(),v("div",{key:0,class:"font-Puhui main-bg safe-bottom-page",onScroll:l},[e("section",{class:Le(["header-bar fixed top-0 left-0 right-0 flex font-normal justify-center text-sm items-center h-[50px] px-4 z-50 backdrop-blur-md transition-all duration-300",{"bg-white":i.value}])},[e("div",Mo,[R(nt)]),e("div",Bo,[e("span",null,o(n.$t("order.orderDetail")),1)])],2),e("section",Fo,[R(_t,{"now-time":O.value,order:s.value,onTimeDone:P},null,8,["now-time","order"]),s.value.status===2&&r(G)(s.value.expressTime,s.value.confirmLimit,O.value)>0&&!s.value.refundInfo?(d(),C(ro,{key:0,order:s.value,"now-time":O.value,onTimeDone:P},null,8,["order","now-time"])):x("",!0),s.value.status===0&&!s.value.hash?(d(),C(fo,{key:1,order:s.value},null,8,["order"])):x("",!0),R(St,{order:s.value},null,8,["order"]),R(Je,{order:s.value},null,8,["order"]),R(We,{order:s.value,"show-price":!1,"show-shipping-template":!0},null,8,["order"]),s.value.status===0&&!s.value.hash?(d(),C(Ye,{key:2,order:s.value},null,8,["order"])):x("",!0),s.value.status!==0||s.value.hash?(d(),C(Ys,{key:3,order:s.value},null,8,["order"])):x("",!0),s.value.id&&s.value.status===0?(d(),C(et,{key:4,order:s.value},null,8,["order"])):x("",!0),s.value.status==0&&s.value.hash?x("",!0):(d(),C(lo,{key:5,order:s.value,"now-time":O.value,"shop-address":se.value,btnLoading:r(Q),onHandleTo:y,onHandleConfirm:ke,onHandleModifyPrice:ne,onHandleRefresh:f,onHandleDelivery:Ae,onHandleCancel:je,onHandleMerchantReceive:Ne,onHandlePlatformIntervene:De},null,8,["order","now-time","shop-address","btnLoading"]))]),R(Oo,{ref:(T,N)=>{N.changePriceRef=T},show:r(Te),loading:r(Ce),onClose:g[0]||(g[0]=T=>r(Z)(!1)),order:s.value,onSubmit:Ie},null,8,["show","loading","order"]),R(rt,{order:s.value,show:r(Se),type:"1",onClose:g[1]||(g[1]=T=>r(E)(!1)),loading:r(Q),onHandleSubmit:X},null,8,["order","show","loading"])],32)):x("",!0)}}),un=we(Vo,[["__scopeId","data-v-1f7bb28d"]]);export{un as default};
