import{S as ne,G as le,a as ce,_ as de,b as ue}from"./ShareGoodPopup-BzlbgEaU.js";import{y as L,bf as re,x as B,z as me,F as v,G as n,H as o,Q as d,P as i,I as pe,J as ge,K as h,X as ve,bs as ye,_ as P,a2 as m,Y as V,Z as M,be as N,r as u,w as fe,a1 as he,l as Te,bj as _e,by as we,D as $e,E as be,O as b,R as Ie,N as z,a0 as xe,T as D}from"./vendor-Ba70TIw4.js";import{e as ke,G as Se,a as Ge,_ as Re}from"./GoodsInfo-CM9k6ImR.js";import{_ as Ce}from"./GoodsEvaluateItem-BfEP67ql.js";import{k as H}from"./order-DXFBu85c.js";import{F as S}from"./enums-DlE-aiss.js";import{d as Fe,f as De,r as Le,_ as Be,W as Pe}from"./index-DGR86ePT.js";import{P as Ae}from"./flashSale-DDyqLyYN.js";import{D as Oe}from"./goods-BVwS8oFG.js";import{R as je}from"./RemovedShelves-I9s0rUiR.js";import{q as qe}from"./goods-BZ-_UyPn.js";import{q as Ee}from"./cart-BQEhRssk.js";import"./shop-arrow-right-BueA_z4m.js";import"./BoutiqueLabelInLogo-BUC1vRQ4.js";import"./shop-CeqcS6K2.js";import"./RatioBox-DxAmCY_c.js";import"./kefu-B-s0jZtS.js";import"./convertToImage-Ct2iSnQg.js";import"./browser-DFlSdkZC.js";import"./upload-28Y_C7H9.js";import"./active_empty-ofPcrP74.js";import"./HelpPop-vGyfF3_2.js";import"./MCOIN-BOqZVkND.js";import"./logo-JjZ15zkW.js";import"./BoutiqueLable-RObK-asU.js";import"./GoodsPrice-9JtLUWL4.js";import"./BackIcon-DkqwcD_b.js";const Ne={class:"relative mb-2 w-full flex justify-center items-center"},ze={class:"text-sm font-semibold text-center"},He={class:"absolute right-0 top-0 text-[12px] text-[#999999] leading-[20px]"},Ve=L({props:{goodsId:null},emits:["handleTo"],setup(t,{emit:p}){const f=t,l=re({commentList:[],total:0}),w=async()=>{const r=await H({goodsId:f.goodsId,page:1,size:1,commentDefaultGoodFlag:0});r.success&&(l.commentList=r.data);const c=await H({goodsId:f.goodsId,page:1,size:1});c.success&&(l.total=c.total)},y=B(()=>{if(l.commentList&&l.commentList.length>0){const r=[];for(let c=0;c<l.commentList.length;c++)l.commentList[c].commentImages&&l.commentList[c].commentImages.length>0&&r.push(...l.commentList[c].commentImages.split(","));return r}return[]}),T=r=>{const c=y.value.findIndex(e=>e===r);ye({images:y.value,closeable:!0,showIndex:!0,startPosition:c})};return me(()=>f.goodsId,()=>{w()},{immediate:!0}),(r,c)=>(n(),v("div",{class:"p-2.5 mb-2.5 bg-white rounded-xl text-base",onClick:c[0]||(c[0]=e=>p("handleTo",`/evaluate-good?goodsId=${t.goodsId}`))},[o("div",Ne,[o("div",ze,d(r.$t("evaluate.Buyer Reviews"))+"（"+d(i(l).total)+"） ",1),o("div",He,d(r.$t("common.all"))+" > ",1)]),(n(!0),v(pe,null,ge(i(l).commentList,(e,g)=>(n(),h(Ce,{onImgPre:T,key:e.id,data:e,class:"border-none",style:ve(g===i(l).commentList.length-1?"margin-bottom:0":"")},null,8,["data","style"]))),128))]))}}),Me="/static/images/wyhlg-lNCG0Riy.svg",Ye="/static/images/g-d-flash-bg-D1sma3Dd.svg",Ue="/static/images/g-d-flash-f-C4Zpe-zO.svg",Ze={class:"tag text-xs flex justify-start items-center text-[#F25C11]"},Je={key:0},Ke={key:1},Qe={key:2},We={key:3},Xe={props:{shippingTemplate:{type:Object,default:()=>{}}},setup(t){return(p,f)=>(n(),v("div",Ze,[o("span",null,[t.shippingTemplate.type===i(S).FREE&&t.shippingTemplate.threshold?(n(),v("span",Je,d(p.$t("shop.shippingTemplate.actualPayment"))+d(i(Fe)(t.shippingTemplate.threshold))+"MC"+d(p.$t("shop.shippingTemplate.freeShipping")),1)):m("",!0),t.shippingTemplate.type===i(S).FREE&&t.shippingTemplate.threshold===0?(n(),v("span",Ke,d(p.$t("shop.shippingTemplate.freeShipping")),1)):m("",!0),t.shippingTemplate.type===i(S).NO_SHIPPING?(n(),v("span",Qe,d(p.$t("shop.shippingTemplate.noShipping")),1)):m("",!0),t.shippingTemplate.type===i(S).CASH_ON_DELIVERY?(n(),v("span",We,d(p.$t("shop.shippingTemplate.cashOnDelivery")),1)):m("",!0)])]))}},et=P(Xe,[["__scopeId","data-v-c8264250"]]),G=t=>(V("data-v-807a4676"),t=t(),M(),t),tt={class:"act__wrap flex items-center justify-between p-3 pr-2.5"},st={class:"left-box z-10"},ot={class:"act-price font-sans text-b6 text-[26px] font-normal"},at={class:"leading-[26px] font-BebasNeue"},it=G(()=>o("span",{class:"text-[12px] ml-1"},"MC",-1)),nt={class:"mt-1 flex flex-row justify-start items-center gap-1"},lt={key:1,class:"tag"},ct={key:2},dt={class:"right-box z-10"},ut=G(()=>o("div",{class:"happy-buying"},[o("img",{src:Me,alt:"五一欢乐购"})],-1)),rt={class:"text-right mt-[2px] text-[#B27936] text-xs font-normal"},mt=G(()=>o("img",{class:"flash-item-2",src:Ye},null,-1)),pt=G(()=>o("img",{class:"flash-item-1",src:Ue,alt:""},null,-1)),gt={props:{goods:{type:Object,default:()=>{}},activity:{type:Object,default:()=>{}},activityGoods:{type:Object,default:()=>{}},activityRule:{type:Object,default:()=>{}},shippingTemplate:{type:Object,default:()=>{}}},setup(t){const p=t,f=B(()=>{var T;if(!((T=p.activity)!=null&&T.endTime))return 0;const l=new Date(p.activity.endTime).getTime(),w=new Date().getTime(),y=(l-w)/(1e3*60*60*24);return y<=0?0:y<1?1:Math.ceil(y)});return(l,w)=>(n(),v("div",tt,[o("div",st,[o("div",ot,[o("span",at,d(t.activityGoods.activityPrice),1),it]),o("div",nt,[t.shippingTemplate.id?(n(),h(et,{key:0,shippingTemplate:t.shippingTemplate},null,8,["shippingTemplate"])):m("",!0),t.activityRule&&t.activityRule.fullAmount?(n(),v("div",lt,d(l.$t("active.man")+t.activityRule.fullAmount||0)+"-"+d(t.activityRule.reduceAmouint||t.activityRule.reduceAmount||0),1)):m("",!0),t.goods.deliveryType===i(Oe).online?(n(),v("div",ct,[t.goods.payType!==i(Ae).STORE_CARD?(n(),h(ke,{key:0,class:"points-tag",showType:"balance",goods:t.goods,activityGoods:t.activityGoods},null,8,["goods","activityGoods"])):m("",!0)])):m("",!0)])]),o("div",dt,[ut,o("div",rt,[o("span",null,d(l.$t("active.last")),1),o("span",null,d(i(f)+l.$t("common.day")),1)])]),mt,pt]))}},vt=P(gt,[["__scopeId","data-v-807a4676"]]),Y=t=>(V("data-v-11ccd807"),t=t(),M(),t),yt={class:"relative w-full h-full bg-white"},ft={key:0},ht=Y(()=>o("img",{class:"w-[1.375rem] h-[1.375rem]",src:de},null,-1)),Tt=[ht],_t=Y(()=>o("img",{class:"w-[1.375rem] h-[1.375rem]",src:ue},null,-1)),wt=[_t],$t={class:"safe-bottom-page pt-4 px-2.5 bg-[#F6F6F5]"},bt={class:"text-center text-black/80"},It={class:"p-3 text-base"},xt=L({name:"GoodsDetail"});function kt(t){const{mcoinRate:p}=De(),[f,l]=N(!1),w=u(!1),{loadingToggle:y}=Le(),{t:T}=fe(),r=he(),c=Te(),e=u(null),g=u(null),R=u(null),C=u(null),A=u(null),U=u([]),F=u({}),Z=u(),O=u(null),J=u(r.query.id),K=async()=>{const a=J.value;if(a==null||a==="")return;const s=await qe(a);Z.value=s.data.categoryName,e.value=s.data.goods,w.value=s.data.isFollow,g.value=s.data.stores,U.value=s.data.goodsList,O.value=s.data.fmStoredCard,F.value=s.data.fmShippingTemplate||{},R.value=s.data.fmGeneralActivity||null,C.value=s.data.fmGeneralActivityGoods||null,A.value=s.data.fmGeneralActivityRule||null},j=u(null),Q=async()=>{j.value=await p()},W=B(()=>1/j.value),$=u(null),X=a=>{const s=a===void 0?`/submitOrder?id=${e.value.id}`:`/submitOrder?id=${e.value.id}&${a}`;c.push(s)},[ee,q]=N(!1),te=async()=>{if(e.value.stock===0&&e.value.goodsTypes!==2){D(T("order.Insufficient stock"));return}const a={needlogin:"true",...r.query};c.replace({path:r.path,query:a}),y(!0);const s=await Ee(e.value.id);y(!1),s.success&&D(T("cart.addTips"))},I=a=>{c.push(a)},se=()=>{D({message:T("common.Saved successfully"),icon:Pe("toast-success.svg"),duration:3e3})},oe=()=>{try{window.history.state.back?c.back():window.history.length>2?window.history.back():c.replace({path:"/mall"})}catch{c.push("/")}},E=u(0);let x=u(!0);const ae=we(()=>{const a=document.getElementById("fm-page");E.value=a.scrollY||a.scrollTop,E.value<100?(x.value=!1,$.value&&$.value.resumeSwiper()):(x.value=!0,$.value&&$.value.pauseSwiper())},100);return _e(()=>{const a=document.getElementById("fm-page");a&&a.removeEventListener("scroll",ae)}),$e(async()=>{y(!0),await Q(),await K(),y(!1)}),(a,s)=>{const ie=be("VanButton");return n(),v("div",yt,[e.value&&e.value.status===1&&g.value.status!==3&&g.value.status!==4&&g.value.status!==0?(n(),v("div",ft,[o("header",{class:Ie(["flex items-center sm:w-[375px] w-full justify-between top-0 z-50 h-[44px] px-2.5 fixed",{"bg-white":i(x)," bg-black/0":!i(x)}])},[o("div",{class:"flex flex-wrap items-center",onClick:oe},Tt),o("div",{onClick:s[0]||(s[0]=_=>i(l)(!0))},wt)],2),b(Se,{ref:(_,k)=>{k.goodsImgRef=_,$.value=_},imgs:(e.value.icons||"").split(","),stock:e.value.stock,goodsTypes:e.value.goodsTypes},null,8,["imgs","stock","goodsTypes"]),R.value&&C.value.activityStock>0?(n(),h(vt,{key:0,goods:e.value,activityRule:A.value,activity:R.value,activityGoods:C.value,shippingTemplate:F.value,class:"mt-[-6px] z-10"},null,8,["goods","activityRule","activity","activityGoods","shippingTemplate"])):m("",!0),b(Ge,{tokenRate:i(W),stores:g.value,goods:e.value,card:O.value,shippingTemplate:F.value,class:"relative z-10"},null,8,["tokenRate","stores","goods","card","shippingTemplate"]),o("div",$t,[b(Ve,{onHandleTo:I,goodsId:e.value.id},null,8,["goodsId"]),g.value.id?(n(),h(ne,{key:0,store:g.value,onHandleTo:I},null,8,["store"])):m("",!0),e.value.goodsDesc||e.value.goodsPic?(n(),h(Re,{key:1,text:e.value.goodsDesc,imgs:(e.value.goodsPic||"").split(",")},null,8,["text","imgs"])):m("",!0)]),e.value.id?(n(),h(le,{key:1,goods:e.value,goodsId:e.value.id,payType:e.value.payType||1,boutiqueFlag:e.value.boutiqueFlag||!1,isFollow:w.value,deliveryType:e.value.deliveryType,storeInfo:g.value,stock:e.value.stock,goodsTypes:e.value.goodsTypes,onHandleBuy:X,onHandeToShop:s[1]||(s[1]=_=>I(`/category?deliveryType=1&shopId=${g.value.id}`)),onHandleConnect:s[2]||(s[2]=_=>{var k;return I(`/shopInfo?address=${(k=g.value)==null?void 0:k.merchant}`)}),onHandleAddCart:te},null,8,["goods","goodsId","payType","boutiqueFlag","isFollow","deliveryType","storeInfo","stock","goodsTypes"])):m("",!0)])):e.value?(n(),h(je,{key:1,type:"good"})):m("",!0),i(f)?(n(),h(ce,{key:2,show:i(f),onOnSuceess:se,onClose:s[3]||(s[3]=_=>i(l)(!1)),goods:e.value},null,8,["show","goods"])):m("",!0),b(Be,{show:i(ee),name:a.$t("common.tip"),onClose:s[5]||(s[5]=_=>i(q)(!1))},{default:z(()=>[o("div",bt,[o("div",It,d(a.$t("goods.addcartip")),1),b(ie,{class:"btn-orange text-white min-w-[120px] h-[40px]",onClick:s[4]||(s[4]=_=>i(q)(!1))},{default:z(()=>[xe(d(a.$t("common.I_see")),1)]),_:1})])]),_:1},8,["show","name"])])}}const St=L({...xt,setup:kt}),ts=P(St,[["__scopeId","data-v-11ccd807"]]);export{ts as default};
