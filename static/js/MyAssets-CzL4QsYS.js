import{_ as K,y as N,E as S,F as i,G as s,H as n,Q as p,O as L,N as Q,a0 as U,K as f,I as A,P as e,Y as oe,Z as le,a2 as m,a3 as Se,X as Re,l as Te,r as M,z as Pe,J as De,$ as Ue,be as B,w as Ee,bg as Oe,bf as ae,D as We,bj as Ae,B as P,T as Ne}from"./vendor-Ba70TIw4.js";import{_ as Fe}from"./mcoin-logo-1-Deho8IWN.js";import{d as v,f as se,o as He,u as je,e as Ve,k as ze,i as qe,j as Ye,q as I,r as Ke,s as ne}from"./index-Bsb9uxb4.js";import{_ as Qe}from"./MAI-JFNXjgdS.js";import{W as Xe,I as Ge}from"./WithdrawPop-DthsRC10.js";import{_ as Je}from"./RealizedBtn-B5rlUm0x.js";import{B as Ze}from"./BackIcon-DkqwcD_b.js";import{g as et}from"./integral-BG3nEreq.js";import{e as tt}from"./exchangeContract-BKEn3mjv.js";import{u as at}from"./usePointRelase-C3UYc-Ka.js";import"./arrow-bottom-D85vJawE.js";import"./ApproveButton-DG7THQ9e.js";import"./MCOIN-Bodfn-v1.js";const st=t=>(oe("data-v-adf00880"),t=t(),le(),t),nt={class:"score mt-3 px-4 pt-4 relative aspect-[691/330]"},ot={class:"text-white text-base absolute top-2.5 left-3"},lt={class:"flex justify-end"},it={class:"flex pt-2 text-3xl item-center font-Audiowide ptop"},rt={class:"w-full pt-2 flex-start ptop"},ct={class:"mr-[12px]"},dt={class:"text-[#784E06] text-[15px] font-semibold mr-4 mrp"},ut=st(()=>n("div",{class:"flex-start gap-1 mt-[2px]"},[n("img",{src:Fe,class:"w-4",alt:""}),n("div",{class:"text-xs text-[#D0BE9D]"},"MCOIN")],-1)),pt={class:"text-[15px] font-semibold"},mt={class:"flex-start gap-1 mt-[2px]"},ft={class:"text-xs text-[#D0BE9D]"},gt=N({props:{contributes:null,pointBalance:null,mcoinBalance:null,pointLoading:{type:Boolean},mcoinLoading:{type:Boolean},contributesLoading:{type:Boolean}},emits:["click"],setup(t,{emit:x}){return(w,y)=>{const $=S("VanButton"),b=S("van-loading");return s(),i("div",nt,[n("div",ot,p(w.$t("assets.myPoints")),1),n("div",lt,[L($,{class:"btn px-4 py-2 h-[27px] rounded-md",onClick:y[0]||(y[0]=R=>x("click"))},{default:Q(()=>[U(p(w.$t("home.invest")),1)]),_:1})]),n("div",it,[t.contributesLoading?(s(),f(b,{key:0})):(s(),i(A,{key:1},[U(p(e(v)(t.contributes,2)),1)],64))]),n("div",rt,[n("div",ct,[n("div",dt,[t.mcoinLoading?(s(),f(b,{key:0,size:"14"})):(s(),i(A,{key:1},[U(p(e(v)(t.mcoinBalance||0,3)),1)],64))]),ut]),n("div",null,[n("div",pt,[t.pointLoading?(s(),f(b,{key:0,size:"14"})):(s(),i(A,{key:1},[U(p(e(v)(t.pointBalance,3)),1)],64))]),n("div",mt,[n("div",ft,p(w.$t("assets.canWithdraw")),1)])])])])}}}),wt=K(gt,[["__scopeId","data-v-adf00880"]]),ht=""+new URL("../images/finish-Ckcquemr.png",import.meta.url).href,yt=""+new URL("../images/danta-CjAoSTYA.png",import.meta.url).href,vt=""+new URL("../images/beef-CPp0y1sY.png",import.meta.url).href,xt=""+new URL("../images/cake-BBusHBXP.png",import.meta.url).href,$t=""+new URL("../images/chicken-9FMSiK1Q.png",import.meta.url).href,Bt=t=>(oe("data-v-7a18df02"),t=t(),le(),t),bt={key:0},_t=Bt(()=>n("img",{src:Qe,class:"w-3 h-3"},null,-1)),kt=[_t],Ct={class:"font-semibold text-[15px] text-[#F59C5A]"},It={key:1},Lt={key:1,class:"text-xs text-white text-shadow"},Mt={key:2,src:ht,alt:"",class:"w-[28px] mt-1"},St={key:3,src:yt,alt:"",class:"w-[28px]"},Rt={key:4,src:vt,alt:"",class:"w-[28px]"},Tt={key:5,src:xt,alt:"",class:"w-[28px]"},Pt={key:6,src:$t,alt:"",class:"w-[28px]"},Dt=N({props:{type:null,text:null,amount:null,scale:{default:1},loading:{type:Boolean}},emits:["handleRelease"],setup(t,{emit:x}){return(w,y)=>{const $=S("van-loading");return s(),i("div",{class:"bb w-[140px] aspect-square flex flex-col items-center justify-center",style:Re({width:`${140*t.scale}px`,height:`${140*t.scale}px`}),onClick:y[0]||(y[0]=()=>x("handleRelease",t.type))},[t.type!==4?(s(),i("div",bt,kt)):m("",!0),n("div",Ct,[t.loading?(s(),f($,{key:0,size:"28",color:"#F59C5A"})):(s(),i("span",It," +"+p(e(v)(t.amount||0,4)),1))]),t.type===4?(s(),i("div",Lt,p(t.text),1)):m("",!0),t.type===4?(s(),i("img",Mt)):t.type===1?(s(),i("img",St)):t.type===3?(s(),i("img",Rt)):t.type===2?(s(),i("img",Tt)):(s(),i("img",Pt)),Se(w.$slots,"default",{},void 0,!0)],4)}}}),D=K(Dt,[["__scopeId","data-v-7a18df02"]]),Ut=""+new URL("../images/daishu-Cg4Fq10g.png",import.meta.url).href,Et=""+new URL("../images/tuijian-4IHxPOA6.png",import.meta.url).href,Ot=""+new URL("../images/level-DxWrAcdT.png",import.meta.url).href,Wt={class:"w-full p-5"},At={class:"mb-4"},Nt={class:"flex items-center justify-between py-4 border-top"},Ft={class:"flex items-center"},Ht={key:0,src:Ut,class:"w-[17px] mr-1.5"},jt={key:1,src:Et,class:"w-[17px] mr-1.5"},Vt={key:2,src:Ot,class:"w-[17px] mr-1.5"},zt={class:"text-[#2E2008] font-semibold text-sm"},qt={class:"text-[2E2008] opacity-60 text-xs"},Yt={class:"text-[#FEA021] text-sm mt-1"},Kt={key:0},Qt=N({props:{show:{type:Boolean},title:null,type:null},emits:["close"],setup(t,{emit:x}){const w=t,y=Te(),$=M(!1),b=M(!1),R=M([]),_=async()=>{$.value=!0,await F(),$.value=!1},u=r=>{y.push(r)},F=async()=>{const r=await et(w.type);b.value=!0,r.success&&(R.value=r.data||[])};return Pe(()=>w.type,()=>{_()},{immediate:!0,deep:!0}),(r,g)=>{const E=S("van-icon"),C=S("VanPopup");return s(),f(C,{show:t.show,"onUpdate:show":g[2]||(g[2]=d=>Ue(show)?show.value=d:null),round:"",style:{width:"90vw","max-height":"80vh"},onClickOverlay:g[3]||(g[3]=()=>x("close"))},{default:Q(()=>[n("div",Wt,[n("div",At,[n("div",null,p(t.type===20?r.$t("integral.layer"):t.type===30?r.$t("integral.recommend release"):t.type===10?r.$t("integral.level"):t.type===1?r.$t("integral.pay"):t.type===2?r.$t("integral.get money"):""),1),L(E,{name:"cross",size:"18",color:"#000",class:"absolute top-5 right-5",onClick:g[0]||(g[0]=()=>{x("close")})})]),(s(!0),i(A,null,De(R.value,d=>(s(),i("div",{key:d.id},[n("div",Nt,[n("div",null,[n("div",Ft,[d.tradeType===20?(s(),i("img",Ht)):d.tradeType===30?(s(),i("img",jt)):d.tradeType===10?(s(),i("img",Vt)):m("",!0),n("div",zt,p(d.tradeType===20?r.$t("integral.layer"):d.tradeType===30?r.$t("integral.recommend release"):d.tradeType===10?r.$t("integral.level"):d.tradeType===1?r.$t("integral.pay"):d.tradeType===2?r.$t("integral.get money"):""),1)]),n("div",qt,p(d.createTime),1)]),n("div",Yt,[d.tradeType===1||d.tradeType===2?(s(),i("span",Kt,"+")):m("",!0),U(p(d.amount),1)])])]))),128)),n("div",{class:"text-center underline text-[#2E2008] font-normal",onClick:g[1]||(g[1]=d=>u("/integralDetail"))},p(r.$t("integral.check detail")),1)])]),_:1},8,["show"])}}}),Xt={class:"relative px-4 bg"},Gt={key:0,class:"cutdown-border"},Jt={class:"absolute bottom-0 left-0 right-0 w-full px-3 pt-6 pb-3 m-auto"},Zt={class:"text-center text-[#D0BE9D] text-xs mt-1.5"},ea=N({setup(t){var te;const{pointRate:x}=se(),{withdrawMaiPending:w,tradeWithUsdt:y,userWithdrawMaiOfMint:$,userWithdrawMaiOfSwap:b,merchantWithdrawMaiOfSwap:R}=He(),{getCurrentAccount:_}=je(),{contributesStore:u}=Ve(),{balances:F}=ze(),[r,g]=B(!1),[E,C]=B(!1),[d,H]=B(!1),[ie,k]=B(!1),[,re]=B(!1),[X,ce]=B(!0),[de,ue]=B(!0),{loadingToggle:j}=Ke(),[G,pe]=B(!1),{pointBalances:me,pointWithdraw:fe,trade:ge}=se(),J=qe(),we=Ye(),{lastPrice:he}=tt(),{handleNaturePoints:ye}=at(),{t:ve}=Ee();Oe(()=>{W(),z()},3e3);const o=ae({pointInfo:{freeRelease:0,gradeRelease:0,levelRelease:0,recommendRelease:0,releaseSecond:0,userMai:0,merchantMai:0,userSwap:0,merchantExtraMai:0,releaseSecondFlag:!1},pointBalance:null,mcoinBalance:F[(te=I)==null?void 0:te.MCOIN]||null,usdtBalance:null,allowance:0}),V=M(0),O=async l=>{j(!0,2);try{let a={success:!1};switch(l){case 40:a=await $();break;case 60:a=await b();break;case 50:case 70:a=await R();break}a.success&&T(!0)}finally{j(!1)}},Z=M(null),xe=async(l,a)=>{H(!0);try{const h=await fe(l,a);if(H(!1),!h.success)return;z(),W(),Ne(ve("maiPledge.Extraction successful")),Z.value.amount=null}finally{H(!1)}},$e=async(l,a,h)=>{if(h==="USDT")Be(l,a);else{k(!0);try{const c=await ge(_(),l,a);if(!c.success)return k(!1);await c.result.wait(),k(!1),C(!1),T(!0)}finally{k(!1)}}},Be=async(l,a)=>{k(!0);try{const h=await y(_(),l,a);if(!h.success)return;await h.result.wait(),k(!1),C(!1),T(!0)}finally{k(!1)}},be=l=>{l==="USDT"||W()},z=async()=>{o.pointBalance=await me(),ce(!1)},_e=async()=>{try{o.usdtBalance=await(await we).balanceOf(_())}catch{o.usdtBalance=0}},W=async()=>{o.mcoinBalance=await(await J).balanceOf(),ue(!1)},ke=async()=>{const l=await(await J).allowance(I.flashMall);o.allowance=l.result},q=ae({levelCount:0,algebraCount:0,recommendCount:0}),Ce=()=>{pe(!1),V.value===10?q.levelCount=0:V.value===20?q.algebraCount=0:q.recommendCount=0},Ie=async()=>{const l=await w(_()),a=await ne(I.WMAI).balanceOf(I.LP),h=await ne(I.MCOIN).balanceOf(I.LP),c=P(h).div(a).toString(),Y=+await he(),Me=await x();o.pointInfo.userMai=+P(l.result.userMai).div(Me).div(Y).div(10).times(.9),o.pointInfo.merchantMai=+P(l.result.merchantMai).div(c).div(2).times(.9),o.pointInfo.userSwap=+P(l.result.userSwap).div(c).times(.9),o.pointInfo.merchantExtraMai=+P(l.result.merchantExtraMai).div(c).div(2).times(.9)},ee=M(!1),T=async(l=!0)=>{ee.value=!0,u.fetchContributes(l),await Promise.all([u.fetchUserRelase(),u.getNaturalReleaseTimes(),z(),_e(),W(),ke(),Ie()]),ee.value=!1},Le=()=>{setTimeout(()=>{T(!0)},12e3)};return We(()=>{re(!0),T(!1)}),Ae(()=>{j(!1)}),(l,a)=>{const h=S("van-count-down");return s(),i("div",Xt,[L(Ze,{isWhite:!0,class:"pt-4"}),L(wt,{contributes:e(u).contributes,contributesLoading:e(u).loading,pointBalance:+e(o).pointBalance,pointLoading:e(X),mcoinBalance:e(o).mcoinBalance,mcoinLoading:e(de),onClick:a[0]||(a[0]=c=>e(C)(!0))},null,8,["contributes","contributesLoading","pointBalance","pointLoading","mcoinBalance","mcoinLoading"]),!e(u).releaseLoading&&e(v)(e(u).freeRelease)>0?(s(),f(D,{key:0,class:"absolute left-[33%] top-[38%] z-100",type:4,text:l.$t("integral.nature"),amount:+e(u).freeRelease,loading:e(u).releaseLoading,onHandleRelease:a[1]||(a[1]=c=>e(ye)(Le))},{default:Q(()=>[!e(u).releaseSecondFlag&&e(u).releaseSecond>0?(s(),i("div",Gt,[L(h,{time:e(u).releaseSecond*1e3,class:"text-[#784E06] font-semibold"},null,8,["time"])])):m("",!0)]),_:1},8,["text","amount","loading"])):m("",!0),+e(v)(e(o).pointInfo.userMai)?(s(),f(D,{key:1,class:"absolute left-[10%] top-[40%]",type:1,text:"消费基础",scale:.59,amount:e(o).pointInfo.userMai,onHandleRelease:a[2]||(a[2]=c=>O(40))},null,8,["scale","amount"])):m("",!0),+e(v)(e(o).pointInfo.merchantMai)?(s(),f(D,{key:2,class:"absolute right-[7%] top-[40%]",type:3,text:"收款基础",scale:.59,amount:e(o).pointInfo.merchantMai,onHandleRelease:a[3]||(a[3]=c=>O(50))},null,8,["scale","amount"])):m("",!0),+e(v)(e(o).pointInfo.userSwap)?(s(),f(D,{key:3,class:"absolute left-[9%] top-[57%]",type:5,text:"消费补贴",scale:.59,amount:e(o).pointInfo.userSwap,onHandleRelease:a[4]||(a[4]=c=>O(60))},null,8,["scale","amount"])):m("",!0),+e(v)(e(o).pointInfo.merchantExtraMai)?(s(),f(D,{key:4,class:"absolute right-[8%] top-[57%]",type:2,text:"商户补贴",scale:.59,amount:e(o).pointInfo.merchantExtraMai,onHandleRelease:a[5]||(a[5]=c=>O(70))},null,8,["scale","amount"])):m("",!0),n("div",Jt,[L(Je,{disabled:e(X),icon:!0,text:l.$t("home.withdraw"),onClick:a[6]||(a[6]=c=>e(g)(!0))},null,8,["disabled","text"]),n("div",Zt,p(l.$t("assets.estimated value")),1)]),e(r)?(s(),f(Xe,{key:5,ref:(c,Y)=>{Y.withdrawRef=c,Z.value=c},show:e(r),balance:e(o).pointBalance,loading:e(d),onClose:a[7]||(a[7]=c=>e(g)(!1)),onHandleWithdraw:xe},null,8,["show","balance","loading"])):m("",!0),e(E)?(s(),f(Ge,{key:6,show:e(E),MCOINBalance:+e(o).mcoinBalance+ +e(o).pointBalance,pointBalance:+e(o).pointBalance,USDTBalance:+e(o).usdtBalance,loading:e(ie),owner:e(_)(),onClose:a[8]||(a[8]=c=>e(C)(!1)),onHanldeInvest:$e,onChangeBalance:be},null,8,["show","MCOINBalance","pointBalance","USDTBalance","loading","owner"])):m("",!0),e(G)?(s(),f(Qt,{key:7,type:V.value,onClose:a[9]||(a[9]=c=>Ce()),show:e(G)},null,8,["type","show"])):m("",!0)])}}}),fa=K(ea,[["__scopeId","data-v-004599c9"]]);export{fa as default};
