import{_ as re}from"./shop-arrow-right-BueA_z4m.js";import{B as me}from"./BoutiqueLabelInLogo-BUC1vRQ4.js";import{R as ue}from"./RatioBox-DxAmCY_c.js";import{g as fe,r as J,h as pe,W as G,aA as ve,aB as ge,aJ as he,d as xe}from"./index-DGR86ePT.js";import{_ as H,y as O,bf as ye,z as W,E as B,F as c,G as n,H as t,P as m,O as u,a0 as I,Q as i,Y as N,Z as F,x as P,be as L,a2 as $,N as k,a4 as z,w as we,r as S,D as _e,a9 as be,K as V,I as ke,R as Q,$ as $e,T as j,bc as Se,bd as Ie,bo as Be}from"./vendor-Ba70TIw4.js";import{b as Ce,c as Te,d as Ae,e as De}from"./GoodsInfo-CM9k6ImR.js";import{_ as Ue}from"./kefu-B-s0jZtS.js";import{c as Ve}from"./goods-BZ-_UyPn.js";import{D as E}from"./goods-BVwS8oFG.js";import{c as Y,i as X,s as Z}from"./convertToImage-Ct2iSnQg.js";import{d as K}from"./active_empty-ofPcrP74.js";import{H as je}from"./HelpPop-vGyfF3_2.js";import{_ as Ee}from"./MCOIN-BOqZVkND.js";import{_ as Le}from"./logo-JjZ15zkW.js";const ds="/static/images/good_back-D3eNN5v8.png",rs="/static/images/good_share-1a0Cq1VD.png",He=e=>(N("data-v-0e486320"),e=e(),F(),e),Oe={class:"w-full flex justify-start items-center"},Ne={class:"w-10 h-10 rounded-[4px] overflow-hidden flex-shrink-0 relative"},Fe=["src"],Pe={class:"absolute right-0 top-0"},ze={class:"ml-1 h-10 flex flex-col justify-between items-start"},Re={class:"text-base font-semibold text-black line-clamp-1 max-w-max leading-[22px] flex items-center"},Me=He(()=>t("img",{src:re,class:"shrink-0 w-4 h-4 object-cover"},null,-1)),qe={class:"flex items-center text-xs text-primary"},Ge={class:"ml-1"},Qe={class:"h-10 flex flex-col justify-start items-center ml-auto flex-shrink-0"},Ke=O({props:{store:null},emits:["handleTo"],setup(e,{emit:w}){const a=e;return ye({}),W(()=>a.store.id,()=>{},{immediate:!0}),(s,v)=>{const y=B("van-rate");return n(),c("div",{class:"p-3 mb-2.5 bg-white rounded-xl text-base",onClick:v[1]||(v[1]=d=>w("handleTo",`/shop?shopId=${e.store.id}`))},[t("div",Oe,[t("div",Ne,[t("img",{src:e.store.logo||e.store.scenery&&e.store.scenery.split(",")[0]||m(fe)("images/goods/defaultImg.png"),class:"w-10 h-full object-cover"},null,8,Fe),t("div",Pe,[u(me,{type:e.store.type},null,8,["type"])])]),t("div",ze,[t("div",Re,[I(i(e.store.storeName)+" ",1),Me]),t("div",qe,[u(y,{class:"flex-shrink-0",readonly:"","allow-half":"",modelValue:e.store.star,"onUpdate:modelValue":v[0]||(v[0]=d=>e.store.star=d),size:14,gutter:"1",color:"#FEA021"},null,8,["modelValue"]),t("span",Ge,i(e.store.star),1)])]),t("div",Qe,[u(ue,{tag:s.$t("common.rebate"),ratio:e.store.discountRatio||0},null,8,["tag","ratio"])])])])}}}),ms=H(Ke,[["__scopeId","data-v-0e486320"]]),ee="/static/images/collect_b-kiXhnb3F.svg",te="/static/images/collect_gray-BYsbfCdJ.svg",Je={class:"w-[335px] relative rounded-none",id:"serverQR"},We={class:"img-box rounded-none"},Ye=["src"],Xe={key:0,class:"fixed left-0 w-full px-2.5 flex-center-bw top-1.5"},Ze={class:"ml-1 text-sm font-normal"},et=O({props:{show:{type:Boolean},imgUrl:null},emits:["close","onSuccess"],setup(e,{emit:w}){const a=e,{loadingToggle:s}=J(),v=P(()=>a.imgUrl?a.imgUrl.startsWith("http")?a.imgUrl+"?"+new Date().getTime():K:K),[y,d]=L(!1),p=()=>{w("close")},T=()=>{d(!0),s(!0),document.getElementById("serverQR")?setTimeout(()=>{_()},200):setTimeout(()=>{_()},3e3)},_=async()=>{let r=document.getElementById("serverQR");r.style.display="block";const g=await Y(r);await X(g)&&Z(g,"img")&&setTimeout(()=>{p(),d(!1),s(!1),w("onSuccess")},3e3)};return(r,g)=>{const b=B("van-icon"),A=B("VanButton");return a.show?(n(),c("div",{key:0,class:"popup-overlay",onClick:p},[t("div",Je,[t("div",We,[t("img",{src:m(v),alt:"",crossOrigin:"anonymous"},null,8,Ye)]),m(y)?$("",!0):(n(),c("div",Xe,[u(A,{class:"text-sm h-[30px] min-w-[65px] rounded-2xl text-white share-btn",onClick:z(T,["stop"])},{default:k(()=>[u(b,{name:"back-top",class:"rotate-180",size:"14"}),t("span",Ze,i(r.$t("common.save")),1)]),_:1},8,["onClick"]),t("div",{class:"share-btn w-[30px] h-[30px] rounded-full flex justify-center items-center text-white text-lg",onClick:p},[u(b,{name:"cross"})])]))])])):$("",!0)}}}),tt=H(et,[["__scopeId","data-v-062c2a0c"]]),se=e=>(N("data-v-084ef958"),e=e(),F(),e),st={class:"w-full flex items-center justify-between bg-white rounded-full sm:w-[355px]"},ot={class:"flex justify-between"},lt={key:0,src:Ce,class:"w-6 h-6 m-auto mb-1"},nt={key:1,src:Te,class:"w-6 h-6 m-auto mb-1"},at={class:"text-[#999] text-xs"},it={key:0,class:"text-xs text-center px-1.5 mr-3"},ct=se(()=>t("img",{src:Ue,class:"w-6 h-6 m-auto mb-1"},null,-1)),dt={class:"text-[#999] text-xs"},rt={key:0,src:ee,class:"w-6 h-6 m-auto mb-1"},mt={key:1,src:te,class:"w-6 h-6 m-auto mb-1"},ut={class:"text-[#999] text-xs"},ft={key:0,src:ee,class:"w-6 h-6 m-auto mb-1"},pt={key:1,src:te,class:"w-6 h-6 m-auto mb-1"},vt={class:"text-[#999] text-xs"},gt={key:0,class:"flex flex-1 justify-end"},ht={class:"flex items-center"},xt=se(()=>t("img",{src:Ae,class:"h-6 m-auto mr-1 w-11"},null,-1)),yt={key:0,class:"text-center text-white"},wt={class:"text-sm leading-3"},_t={class:"text-lg font-medium leading-5"},bt=I(" Mcoin "),kt={class:"text-[0.675rem]"},$t={class:"mr-0.5"},St={key:1,class:"py-2.5 ml-2 text-[#999] text-base"},It={key:2,class:"py-2.5 ml-2 text-[#999] text-base"},Bt=O({props:{isFollow:{type:Boolean},goodsId:null,isSale:{type:Boolean},isSaleEnd:{type:Boolean},isSaleStart:{type:Boolean},isSaleOver:{type:Boolean},goods:null,systemTime:null,currentAmount:null,totalAmount:null,payType:null,boutiqueFlag:{type:Boolean},deliveryType:null,storeInfo:null,stock:null,goodsTypes:null},emits:["handeToShop","handleConnect","handleBuy","handleAddCart","toPurchase","handleOffine"],setup(e,{expose:w,emit:a}){const s=e,[v,y]=L(!1),{t:d}=we(),p=S(!1),[T,_]=L(!1),r=S(!1),g=S([]),b=S(null),A=o=>{var l;if(o.id==="metakey"){try{window==null||window.handleCustomerService({shopId:(l=s.goods)==null?void 0:l.shopId})}catch(x){console.log(x)}return}if(o.id==="downloadmetakey"){le();return}o.customerServiceLink?o.customerServiceLink.includes("img.s3")?(b.value=o.customerServiceLink,y(!0)):(j({message:d("common.link copy and open"),duration:4e3}),pe(o.customerServiceLink)):j({message:d("common.no service")})},oe=async()=>{const o=s.storeInfo.id,l=await he(o);if(l.success){const x=[];l.data.forEach(h=>{h.customerServiceLink&&x.push({text:h.nickname,id:h.id,customerServiceLink:h.customerServiceLink,disabled:!1})}),g.value=x,T.value?x.unshift({text:d("common.meta-key-service"),id:"metakey",disabled:!1}):x.unshift({text:d("common.meta-key-service"),id:"downloadmetakey",disabled:!1})}},U=S(!1),le=()=>{U.value=!0};W(()=>s.storeInfo,()=>{var o;(o=s.storeInfo)!=null&&o.id&&oe()},{immediate:!0,deep:!0});const R=S(!1),ne=P(()=>[{text:d("piggy.normalBuy"),id:1}]),ae=o=>{a("handleBuy",`payType=${o.id}`)},ie=()=>{Ve({goodsIds:[s.goodsId],type:p.value?2:1,collectType:s.isSale?2:1}).then(o=>{o.success&&(p.value?j({message:d("common.cancel collect"),icon:G("toast-success.svg")}):j({message:d("common.collect success"),icon:G("toast-success.svg")}),p.value=!p.value)})},C=S(!1),ce=async()=>{var x,h,f,M,q;if(C.value||!((x=s.goods)!=null&&x.goodsId))return;s.goods.collectId=9999;let o={};(h=s.goods)!=null&&h.goodsId&&(o.goodsId=(f=s.goods)==null?void 0:f.goodsId),(M=s.goods)!=null&&M.storeId&&(o.storeId=(q=s.goods)==null?void 0:q.storeId),C.value=!0;const l=await ve(o);C.value=!1,l.success&&(s.goods.collectId=l.data)},de=async()=>{var l;if(C.value||!((l=s.goods)!=null&&l.goodsId))return;let o=s.goods.collectId;s.goods.collectId=null,C.value=!0,await ge({ids:[o]}),C.value=!1};return w({}),_e(()=>{var o;p.value=s.isFollow,(o=window.ethereum)!=null&&o.isMetaKey?_(!0):_(!1)}),be(()=>{}),(o,l)=>{const x=B("van-popover"),h=B("VanButton");return n(),c("div",{class:Q(["fixed bottom-0 sm:left-1/2 sm:-translate-x-2/4 left-0 sm:w-[375px] w-full bg-white box-shadow safe-bottom flex-center pt-2.5 px-2.5 font-Puhui font-normal",m(v)?"z-[2003]":"z-20"])},[t("div",st,[t("div",ot,[t("div",{class:"text-xs text-center px-1.5 mr-3",onClick:l[0]||(l[0]=()=>a("handeToShop"))},[e.isSale?(n(),c("img",nt)):(n(),c("img",lt)),t("div",at,i(o.$t("mall.shop")),1)]),u(x,{show:r.value,"onUpdate:show":l[1]||(l[1]=f=>r.value=f),actions:g.value,onSelect:A,placement:"top",trigger:"click"},{reference:k(()=>[g.value.length>0?(n(),c("div",it,[ct,t("div",dt,i(o.$t("common.service")),1)])):$("",!0)]),_:1},8,["show","actions"]),!e.isSale&&e.deliveryType===m(E).online?(n(),c("div",{key:0,class:"text-xs text-center px-1.5",onClick:ie},[p.value?(n(),c("img",rt)):(n(),c("img",mt)),t("div",ut,i(o.$t("common.collect")),1)])):$("",!0),!e.isSale&&e.deliveryType===m(E).offeline?(n(),c("div",{key:1,class:"text-xs text-center px-1.5",onClick:l[2]||(l[2]=f=>e.goods.collectId?de():ce())},[e.goods.collectId?(n(),c("img",ft)):(n(),c("img",pt)),t("div",vt,i(o.$t("common.collect")),1)])):$("",!0)]),e.isSale?(n(),V(h,{key:1,class:Q(["min-w-[60px] rounded-3xl px-2.5",s.isSaleEnd||s.isSaleStart||s.currentAmount>=s.totalAmount?"bg-[#D9D9D9]":"bg-[#FB1A18]"]),disabled:s.isSaleStart||s.isSaleEnd||s.currentAmount>=s.totalAmount,onClick:l[7]||(l[7]=()=>{a("toPurchase")})},{default:k(()=>[t("div",ht,[xt,!s.isSaleEnd&&!s.isSaleStart&&s.currentAmount<s.totalAmount?(n(),c("div",yt,[t("div",wt,[t("span",_t,i(e.goods.price),1),bt]),t("div",kt,[t("span",$t,i(o.$t("refund.TotalNum",{num:e.totalAmount})),1),t("span",null,i(o.$t("flashSale.Already snatched"))+i(s.currentAmount)+i(o.$t("common.pieces")),1)])])):s.isSaleStart?(n(),c("div",St,i(o.$t("common.no start")),1)):(n(),c("div",It,i(s.currentAmount>=s.totalAmount?o.$t("flashSale.Alreadygrabbed"):o.$t("flashSale.gooderror")),1))])]),_:1},8,["disabled","class"])):(n(),c("div",gt,[e.deliveryType===m(E).online?(n(),c(ke,{key:0},[u(h,{class:"px-4 text-sm text-newOrigin rounded-r-none bg-newOrigin/20 rounded-l-3xl",disabled:e.stock===0&&e.goodsTypes!=2,onClick:l[3]||(l[3]=z(f=>a("handleAddCart"),["stop"]))},{default:k(()=>[I(i(o.$t("common.addCart")),1)]),_:1},8,["disabled"]),e.payType!==3||e.boutiqueFlag?(n(),V(h,{key:0,class:"px-4 text-sm text-default rounded-l-none rounded-r-3xl bg-btnOrBg",onClick:l[4]||(l[4]=()=>a("handleBuy",e.payType===2?"":"payType=1")),disabled:e.stock===0&&e.goodsTypes!=2},{default:k(()=>[I(i(e.payType===2?o.$t("piggy.cardBuy"):o.$t("common.Buy it now")),1)]),_:1},8,["disabled"])):(n(),V(x,{key:1,placement:"top",show:R.value,"onUpdate:show":l[5]||(l[5]=f=>R.value=f),actions:m(ne),onSelect:ae},{reference:k(()=>[u(h,{class:"px-5 text-sm text-white bg-primary rounded-r-3xl",disabled:e.stock===0&&e.goodsTypes!=2},{default:k(()=>[I(i(o.$t("common.Buy it now")),1)]),_:1},8,["disabled"])]),_:1},8,["show","actions"]))],64)):(n(),V(h,{key:1,class:"max-w-[200px] w-full !justify-center text-sm text-default text-center bg-btnOrBg rounded-3xl ml-6",onClick:l[6]||(l[6]=()=>a("handleOffine")),text:o.$t("common.payBill")},null,8,["text"]))]))]),u(tt,{show:m(v),"onUpdate:show":l[8]||(l[8]=f=>$e(v)?v.value=f:null),imgUrl:b.value,onOnSuccess:l[9]||(l[9]=f=>m(y)(!1)),onClose:l[10]||(l[10]=f=>m(y)(!1))},null,8,["show","imgUrl"]),u(je,{show:U.value,"onUpdate:show":l[11]||(l[11]=f=>U.value=f),display:["download","account","wallet","auth"],onClose:l[12]||(l[12]=f=>U.value=!1)},null,8,["show"])],2)}}}),us=H(Bt,[["__scopeId","data-v-084ef958"]]),D=e=>(N("data-v-e260fc0e"),e=e(),F(),e),Ct={class:"w-[335px] relative",id:"saveHtml"},Tt={class:"img-box"},At=["src"],Dt={key:0,class:"fixed left-0 w-full px-2.5 flex-center-bw top-1.5"},Ut=D(()=>t("div",null,null,-1)),Vt={class:"px-2.5 py-2"},jt={class:"flex items-center justify-start text-primary"},Et=D(()=>t("div",{class:"mr-1.5 w-6 flex-shrink-0"},[t("img",{class:"w-6 h-6",src:Ee})],-1)),Lt={class:"text-[#FEA021] text-3xl font-medium mr-1"},Ht=D(()=>t("span",{class:"text-base"},"Mcoin",-1)),Ot={class:"self-center ml-4"},Nt={class:"mt-1 text-sm font-semibold text-left text-default"},Ft={class:"flex items-center justify-between pt-8"},Pt={class:"flex items-center"},zt={class:"border border-solid border-black/20 p-0.5"},Rt={class:"ml-3 text-sm text-black-800 opacity-80"},Mt=D(()=>t("br",null,null,-1)),qt=D(()=>t("img",{src:Le,class:"w-[60px] h-[60px] object-contain"},null,-1)),Gt={key:1,class:"fixed w-fit px-2.5 left-1/2 bottom-9 transform -translate-x-1/2"},Qt={class:"ml-1 text-sm font-normal"},Kt=O({props:{show:{type:Boolean},goods:null,codeUrl:null},emits:["close","onSuceess"],setup(e,{emit:w}){const a=e,{loadingToggle:s}=J(),v=P(()=>a.codeUrl||window.location.origin+"/#/goodsDetail?id="+a.goods.id),[y,d]=L(!1),p=()=>{w("close")},T=()=>{d(!0),s(!0),document.getElementById("saveHtml")?setTimeout(()=>{_()},200):setTimeout(()=>{_()},3e3)},_=async()=>{let r=document.getElementById("saveHtml");r.style.display="block";const g=await Y(r);await X(g)&&Z(g,a.goods.goodsName||a.goods.title||"")&&setTimeout(()=>{p(),d(!1),s(!1),w("onSuceess")},3e3)};return(r,g)=>{const b=B("van-icon"),A=B("VanButton");return a.show?(n(),c("div",{key:0,class:"popup-overlay",onClick:p},[t("div",{class:"popup-content",onClick:g[0]||(g[0]=z(()=>{},["stop"]))},[t("div",Ct,[t("div",Tt,[t("img",{src:(a.goods.icons||a.goods.mainImageUrls||"").split(",")[0]+"?"+new Date().getTime(),alt:"",crossOrigin:"anonymous"},null,8,At)]),m(y)?$("",!0):(n(),c("div",Dt,[Ut,t("div",{class:"share-btn w-[30px] h-[30px] rounded-full flex justify-center items-center text-white text-lg",onClick:p},[u(b,{name:"cross"})])])),t("div",Vt,[t("div",jt,[Et,t("div",null,[t("span",Lt,i(m(xe)(a.goods.price||0)),1),Ht]),Se(t("div",Ot,[u(De,{goods:e.goods},null,8,["goods"])],512),[[Ie,e.goods.deliveryType===m(E).online]])]),t("div",Nt,i(a.goods.goodsName||a.goods.title||""),1),t("div",Ft,[t("div",Pt,[t("div",zt,[u(Be,{value:m(v),size:60,level:"H"},null,8,["value"])]),t("div",Rt,[I(i(r.$t("common.new found")),1),Mt,I(i(r.$t("common.share you")),1)])]),qt])]),m(y)?$("",!0):(n(),c("div",Gt,[u(A,{class:"text-sm h-[30px] min-w-[65px] rounded-2xl text-white share-btn",onClick:T},{default:k(()=>[u(b,{name:"back-top",class:"rotate-180",size:"14"}),t("span",Qt,i(r.$t("common.save img")),1)]),_:1})]))])])])):$("",!0)}}}),fs=H(Kt,[["__scopeId","data-v-e260fc0e"]]);export{us as G,ms as S,ds as _,fs as a,rs as b};
