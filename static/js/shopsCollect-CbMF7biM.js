import{E as k,F as h,G as i,H as s,P as a,O as f,Q as v,K as d,a2 as w,y as E,x as Z,l as ee,a1 as te,w as se,bf as le,r as $,z as oe,be as P,D as ae,bh as ne,N as b,J as ie,I as ce,a0 as re,T as ue}from"./vendor-Ba70TIw4.js";import{g as L,e as de,ao as fe,W as pe,br as me,bC as he,bD as ve,bE as ge}from"./index-Bsb9uxb4.js";import{C as xe}from"./CommonVanProvider-CqQk6UpZ.js";import{_ as ye}from"./EmptyTipsPop-BnhhUp92.js";import{_ as _e,M as be}from"./MetaKeyTag-DSSf9cM_.js";import{_ as ke}from"./ExpressMinutesTag-fPnBfgtt.js";import{R as we}from"./RatioBox-Q-7JJrFz.js";import{B as O}from"./BoutiqueLabelInLogo-BUC1vRQ4.js";import{B as Ce}from"./BetweenTab-DPw9h7Hc.js";import"./BackIcon-DkqwcD_b.js";import"./useOrderStatus-eiwKm5Dv.js";import"./shop-CeqcS6K2.js";/* empty css                                                               */const $e={class:"pb-3"},Fe={class:"w-full flex justify-start items-start px-3 bg-white p-3 rounded-xl"},Ie={class:"w-[60px] h-[60px] rounded-[4px] overflow-hidden flex-shrink-0 relative"},Se=["src"],Te={class:"absolute right-0 top-0"},Ne={class:"ml-2 flex flex-col justify-between items-start w-full"},Ve={class:"flex items-center justify-start w-full"},je={class:"max-w-[calc(100%-66px)] text-base font-semibold text-black line-clamp-1 leading-[22px] flex-shrink-0"},Be={class:"flex items-center text-sm text-primary"},Ee={class:"ml-1"},Ae={class:"w-full flex justify-start items-center gap-1.5 overflow-x-auto h-[18px]"},ze={props:{shop:{type:Object,required:!0}},setup(o){return(c,g)=>{const p=k("van-rate");return i(),h("div",$e,[s("div",Fe,[s("div",Ie,[s("img",{src:o.shop.logo||o.shop.scenery&&o.shop.scenery.split(",")[0]||a(L)("images/goods/defaultImg.png"),class:"w-[60px] h-[60px] object-cover"},null,8,Se),s("div",Te,[f(O,{type:o.shop.type},null,8,["type"])])]),s("div",Ne,[s("div",Ve,[s("p",je,v(o.shop.storeName),1),f(we,{class:"ml-auto h-[22px]",tag:c.$t("common.rebate"),ratio:o.shop.discountRatio||0},null,8,["tag","ratio"])]),s("div",Be,[f(p,{class:"flex-shrink-0",readonly:"","allow-half":"",modelValue:o.shop.star,"onUpdate:modelValue":g[0]||(g[0]=F=>o.shop.star=F),size:16,gutter:"0",color:"#FEA021"},null,8,["modelValue"]),s("span",Ee,v(o.shop.star),1)]),s("div",Ae,[f(_e,{type:o.shop.buyFlag?1:o.shop.watchFlag?2:o.shop.followFlag?3:0},null,8,["type"]),o.shop.recentExpressSeconds?(i(),d(ke,{key:0,time:o.shop.recentExpressSeconds},null,8,["time"])):w("",!0),o.shop.metakeyFlag?(i(),d(be,{key:1})):w("",!0)])])])])}}},qe={class:"border-[0.5px] border-solid border-[#FF8812] rounded-sm px-1 py-0.5 text-[#FF8812] text-xxs font-normal min-w-fit"},R=E({props:{text:null},setup(o){return(c,g)=>(i(),h("div",qe,v(o.text),1))}}),Pe={class:"pb-3"},Re={class:"w-full flex justify-start items-start px-3 bg-white p-3 rounded-xl"},Le={class:"w-[60px] h-[60px] rounded-[4px] overflow-hidden flex-shrink-0 relative"},Oe={class:"absolute right-0 top-0"},De={class:"ml-2 flex flex-col justify-between items-start w-full"},Ue={class:"flex items-center justify-start w-full"},Me={class:"max-w-[calc(100%-66px)] text-base font-semibold text-black line-clamp-1 leading-[22px] flex-shrink-0"},Ge=s("div",{class:"flex items-center text-sm text-primary"},null,-1),Ke={class:"w-full flex justify-start items-center gap-1.5 overflow-x-auto h-[18px] mt-1"},He={class:"mt-1 text-sm text-b3 font-normal line-clamp-1"},Je={props:{shop:{type:Object,required:!0}},setup(o){const c=o,g=Z(()=>{let p="";return c.shop.areaName1&&(p=c.shop.areaName1),c.shop.areaName2&&c.shop.areaName2!==c.shop.areaName1&&(p+=`-${c.shop.areaName2}`),p});return(p,F)=>{const N=k("van-image");return i(),h("div",Pe,[s("div",Re,[s("div",Le,[f(N,{width:"60",height:"60",src:o.shop.storeIcons&&o.shop.storeIcons.split(",")[0]||a(L)("images/goods/defaultImg.png"),class:"rounded-[4px] w-[60px] h-[60px]"},null,8,["src"]),s("div",Oe,[f(O,{type:o.shop.type},null,8,["type"])])]),s("div",De,[s("div",Ue,[s("p",Me,v(o.shop.storeName),1)]),Ge,s("div",Ke,[f(R,{text:o.shop.goodsCategoryName1},null,8,["text"]),f(R,{text:a(g)},null,8,["text"])]),s("div",He,v(o.shop.storeAddress||""),1)])])])}}},Qe={class:"flex items-center justify-start gap-1"},We=["src"],Xe=s("span",{class:"text-b2 text-sm font-normal"},"取消",-1),Ye=[Xe],Ze=s("span",{class:"text-b2 text-sm font-normal"},"编辑",-1),et=[Ze],tt={class:"scrollPage p-3 h-[calc(100vh-83px)] overflow-y-auto"},st={class:"flex items-center justify-start"},lt={key:0,class:"flex-shrink-0 mr-3"},ot={class:"w-full"},at={key:0,class:"fixed bottom-0 left-0 right-0 bg-[#F5F5F5] p-3 pb-[calc(12px+env(safe-area-inset-bottom))] flex items-center justify-between"},nt={class:"flex-shrink-0 flex items-center justify-start gap-2 mr-3"},it={key:0},ct=E({name:"shopsCollect"});function rt(o){const c=ee(),g=te(),{t:p}=se(),{regionStore:F}=de(),N=[{label:p("shop.on-line"),value:1},{label:p("shop.off-line"),value:2}],D=t=>{r.value=[],x.value=[],m.value=!1,I(!1),e.type=t||1,c.replace({query:{type:t}}),V()},e=le({type:Number(g.query.type)||1,page:0,size:10,finished:!1,list:[],loading:!1,total:0}),r=$([]),x=$([]),A=$(null),m=$(!1),z=()=>{m.value?r.value=e.list.map(l=>e.type===2?l.collectId:l.shopId):r.value=[]},U=()=>{var t;(t=A.value)==null||t.toggle(),z()};oe(r,t=>{console.log(t),t.length&&t.length>=e.list.length?m.value=!0:m.value=!1});const M=(t,l)=>{var u;C.value?(u=x.value[l])==null||u.toggle():c.push("/category?deliveryType=1&shopId="+t.shopId+"&activated=1")},G=(t,l)=>{var u;C.value?(u=x.value[l])==null||u.toggle():c.push("/city/storefront?storeId="+t.storeId+"&activated=1")},q=async()=>{e.loading=!0,e.page+=1,await K(),e.loading=!1},K=async()=>{let t=null;if(e.type===1&&(t=await ve({page:e.page,size:e.size})),e.type===2){const l=await ge({page:e.page,size:e.size,sortBy:"desc|create_time"});t={success:l.success,data:l.data.records||[],total:l.data.total||0}}if(!t.success){e.finished=!0;return}if(!t.data||!t.total){e.finished=!0;return}e.total=t.total,e.list=e.page===1?t.data:e.list.concat(t.data),m.value&&(r.value=e.list.map(l=>e.type===2?l.collectId:l.shopId)),e.list.length>=e.total&&(e.finished=!0)},V=()=>{e.page=0,e.total=0,e.finished=!1,e.list=[],q()},[C,I]=P(!1),[H,j]=P(!1),J=async()=>{if(!r.value.length){ue("请选择要移除的店铺");return}let t=null;e.type===1?t=await me({shopIds:r.value||[],type:2}):t=await he({ids:r.value||[]}),t.success&&(V(),j(!0),r.value=[],x.value=[],m.value=!1),setTimeout(()=>{j(!1)},1e3)};let S=null;const Q=async()=>{const t=localStorage.getItem("shopsCollect_scrollTop");+t?(console.log("setCacheScrollTop",+t),S.scrollTo({top:+t,left:0,behavior:"instant"})):localStorage.removeItem("shopsCollect_scrollTop")},B=$(!1),W=()=>{B.value||(B.value=!0,setTimeout(()=>{localStorage.setItem("shopsCollect_scrollTop",S.scrollTop+""),B.value=!1},500))};return ae(()=>{S=document.querySelector(".scrollPage"),S.addEventListener("scroll",W)}),ne(async()=>{var t,l,u,T;Q(),!(((T=(u=(l=(t=c==null?void 0:c.options)==null?void 0:t.history)==null?void 0:l.state)==null?void 0:u.forward)==null?void 0:T.indexOf("activated=1"))>-1&&e.list.length)&&(r.value=[],x.value=[],m.value=!1,I(!1),V())}),(t,l)=>{const u=k("van-checkbox"),T=k("van-checkbox-group"),X=k("van-list"),Y=k("VanButton");return i(),d(xe,{class:"bg-[#F5F5F5] font-Puhui font-normal relative shopGoodsPage",title:"店铺收藏","theme-vars":{"field-placeholder-text-color":"#F5F5F5"},ref:(n,_)=>{_.shopsCollectRef=n}},{title:b(()=>[s("div",Qe,[s("div",null,[s("img",{src:a(pe)(`mall/${a(F).country}-flag.svg`),class:"w-4 h-auto"},null,8,We)]),s("span",null,v(t.$t("collect.shopsCollect")),1)])]),right:b(()=>[s("div",null,[a(C)===!0?(i(),h("div",{key:0,onClick:l[0]||(l[0]=n=>a(I)(!1))},Ye)):(i(),h("div",{key:1,onClick:l[1]||(l[1]=n=>a(I)(!0))},et))])]),default:b(()=>[s("div",null,[f(Ce,{class:"between-tab__wrap",options:N,"label-key":"label","value-key":"value",modelValue:a(e).type,"onUpdate:modelValue":l[2]||(l[2]=n=>a(e).type=n),onChange:D},null,8,["modelValue"]),s("div",tt,[a(e).list.length===0&&!a(e).loading?(i(),d(fe,{key:0,name:t.$t("common.No data yet")},null,8,["name"])):(i(),d(X,{key:1,loading:a(e).loading,"onUpdate:loading":l[4]||(l[4]=n=>a(e).loading=n),"finished-text":t.$t("common.noMore"),"loading-text":t.$t("common.loading"),finished:a(e).finished,onLoad:q,"immediate-check":!0},{default:b(()=>[(i(!0),h(ce,null,ie(a(e).list,(n,_)=>(i(),d(T,{key:n.shopId||n.collectId,modelValue:r.value,"onUpdate:modelValue":l[3]||(l[3]=y=>r.value=y),"checked-color":"#FEA021","icon-size":"16"},{default:b(()=>[s("div",st,[a(C)?(i(),h("div",lt,[a(e).type===2?(i(),d(u,{key:0,name:n.collectId,ref:y=>x.value[_]=y},null,8,["name"])):(i(),d(u,{key:1,name:n.shopId,ref:y=>x.value[_]=y},null,8,["name"]))])):w("",!0),s("div",ot,[a(e).type===2?(i(),d(Je,{key:0,shop:n,onClick:y=>G(n,_)},null,8,["shop","onClick"])):(i(),d(ze,{key:1,shop:n,onClick:y=>M(n,_)},null,8,["shop","onClick"]))])])]),_:2},1032,["modelValue"]))),128))]),_:1},8,["loading","finished-text","loading-text","finished"]))])]),a(C)?(i(),h("div",at,[s("div",nt,[f(u,{modelValue:m.value,"onUpdate:modelValue":l[5]||(l[5]=n=>m.value=n),"checked-color":"#FEA021","icon-size":"16",ref:n=>A.value=n,onClick:z},null,8,["modelValue"]),s("span",{class:"text-b3 text-sm font-normal",onClick:U},"全选")]),f(Y,{class:"main-btn flex-center text-white font-semibold rounded-full !bg-[#f44] text-base w-full h-[46px]",onClick:J},{default:b(()=>[re(v(t.$t("common.delete"))+" ",1),r.value.length>0?(i(),h("span",it," ("+v(r.value.length)+") ",1)):w("",!0)]),_:1})])):w("",!0),a(H)?(i(),d(ye,{key:1,isError:!1,onClose:l[6]||(l[6]=n=>a(j)(!1)),text:"删除成功"})):w("",!0)]),_:1},512)}}const wt=E({...ct,setup:rt});export{wt as default};
