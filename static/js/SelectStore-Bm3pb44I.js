import{_ as R,bf as A,D as $,K as v,G as d,N as S,l as j,a1 as z,E as N,H as e,O as B,bc as K,F as u,a2 as y,a4 as M,P as n,Q as _,bp as O,bz as D,J as U,I as q,Y as E,Z as G}from"./vendor-Ba70TIw4.js";import{_ as H}from"./down-arrow-IWNxO-Dl.js";import{_ as J}from"./search-C4fLtTfY.js";import{_ as Q}from"./delete-BlDblrKv.js";import{C as T}from"./CommonVanProvider-CqQk6UpZ.js";import{e as Y,ap as Z,aH as W,ao as X}from"./index-Bsb9uxb4.js";import"./BackIcon-DkqwcD_b.js";const g=h=>(E("data-v-546fdcd4"),h=h(),G(),h),ee={class:"px-3"},te={class:"search__wrap w-full h-[50px] pb-3"},se={class:"search__input w-full h-full bg-b5 rounded-3xl flex items-center justify-center px-3 py-2.5"},oe=["onClick"],ae={class:"text-sm text-b2 font-normal min-w-[28px] max-w-[56px]"},ne={key:1,class:"text-truncate"},ie=g(()=>e("img",{src:H,class:"w-[9px] h-auto"},null,-1)),re=g(()=>e("div",{class:"mx-2 bg-b4 w-[1px] h-full"},null,-1)),le=g(()=>e("div",{class:"search__icon flex-shrink-0"},[e("img",{src:J,class:"w-4 h-4"})],-1)),ce=["placeholder","onKeyup"],de=g(()=>e("img",{src:Q,class:"w-4 h-4",alt:""},null,-1)),fe=[de],pe={class:"text-[#FF8812] text-sm font-semibold whitespace-nowrap"},ue=["onClick"],he={class:"flex-1 flex items-center gap-1"},me={class:"line-clamp-1 text-base font-semibold"},_e={key:0,class:"text-xs text-newOrigin border border-newOrigin px-1 rounded-sm"},ge={class:"mt-1 text-b3 flex items-center justify-between gap-x-1"},xe={class:"line-clamp-1"},ve={setup(h){var w,C,L;const{cityMapStore:s}=Y(),b=j(),I=z(),t=A({total:0,loading:!1,finished:!1,list:[]}),a=A({page:0,size:20,overseasFlag:((w=s.currentActiveCity)==null?void 0:w.overseasFlag)||!1,storeNameLike:void 0,longitude:s.locationCoords.lng||((C=s.currentActiveCity)==null?void 0:C.areaLongitude)||null,latitude:s.locationCoords.lat||((L=s.currentActiveCity)==null?void 0:L.areaLatitude)||null}),V=()=>{b.push({path:"/city/selectArea",query:{mode:"select",from:encodeURIComponent(I.path)}})},k=()=>{console.log(a.storeNameLike),a.page=0,a.size=20,a.finished=!1,a.list=[],x()},F=i=>{i.storeId&&s.setSelectedStore(i),b.back()},x=async()=>{console.log("onLoad"),t.loading=!0,a.page+=1,await P(),t.loading=!1},P=async()=>{var o,r;if(!((o=s.selectedArea)!=null&&o.areaId)){t.finished=!0;return}a.areaIdPreviousLastLeaf=(r=s.selectedArea)==null?void 0:r.areaId;const{success:i,data:l}=await Z(a);if(t.loading=!1,!i){t.finished=!0;return}const{records:c,total:m,current:f,pages:p}=l;(!m||!c||!(c!=null&&c.length))&&(t.finished=!0),t.total=m,t.list=a.page===1?c:t.list.concat(c),+f>=+p&&(t.finished=!0)};return $(()=>{s.selectedArea||s.setSelectedArea(s.currentActiveCity),x()}),(i,l)=>{const c=N("van-loading"),m=N("VanList");return d(),v(T,{title:"选择门店",class:"bg-white font-Puhui font-normal relative","theme-vars":{"nav-bar-background-color":"#fff","field-placeholder-text-color":"#A6A6A6"},ref:(f,p)=>{p.searchRef=f}},{default:S(()=>{var f,p;return[e("div",ee,[e("div",te,[e("div",se,[e("div",{class:"city-selector flex items-center justify-start gap-1",onClick:M(V,["stop"])},[e("div",ae,[(f=n(s).selectedArea)!=null&&f.areaName?(d(),u("span",ne,_((p=n(s).selectedArea)==null?void 0:p.areaName),1)):(d(),v(c,{key:0,size:"14"}))]),ie],8,oe),re,le,K(e("input",{ref:(o,r)=>{r.searchRef=o},type:"text","onUpdate:modelValue":l[0]||(l[0]=o=>n(a).storeNameLike=o),class:"flex-1 h-full bg-transparent ml-1 font-normal",placeholder:i.$t("offline.store_search"),onKeyup:D(k,["enter"]),enterkeyhint:"search"},null,40,ce),[[O,n(a).storeNameLike]]),n(a).storeNameLike?(d(),u("div",{key:0,class:"flex-shrink-0 flex items-center justify-center",onClick:l[1]||(l[1]=(...o)=>i.onClear&&i.onClear(...o))},fe)):y("",!0),e("div",{class:"search__btn ml-2 flex-shrink-0",onClick:k},[e("span",pe,_(i.$t("common.search")),1)])])]),B(m,{loading:n(t).loading,"onUpdate:loading":l[2]||(l[2]=o=>n(t).loading=o),finished:n(t).finished,"immediate-check":!1,"loading-text":i.$t("common.loading"),onLoad:x,class:"shopList h-[calc(100vh-100px)] overflow-y-auto"},{default:S(()=>{var o;return[e("section",null,[!((o=n(t))!=null&&o.list.length)&&!n(W)?(d(),v(X,{key:0})):y("",!0),(d(!0),u(q,null,U(n(t).list,r=>(d(),u("div",{key:r.storeId,class:"gap-1 text-sm py-3 border-b border-b-b4 first:pt-0 last:border-none",onClick:ye=>F(r)},[e("div",he,[e("div",me,_(r.storeName),1),+r.storeGoodsCount>0?(d(),u("div",_e," 代买单 ")):y("",!0)]),e("div",ge,[e("span",xe,_(r.storeAddress),1)])],8,ue))),128))])]}),_:1},8,["loading","finished","loading-text"])])]}),_:1},512)}}},Ne=R(ve,[["__scopeId","data-v-546fdcd4"]]);export{Ne as default};
