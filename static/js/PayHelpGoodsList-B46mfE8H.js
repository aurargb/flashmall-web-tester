import{y as L,x as E,r as H,E as k,F as m,G as l,H as a,O as g,X as F,P as o,I as $,a1 as C,Q as v,K as T,N as f,a4 as P,_ as G,l as O,a2 as I,w as q,bf as R,D as S,J as W}from"./vendor-BlU_hoYl.js";import{_ as M}from"./avatarRing2-Ckr5tuam.js";import{_ as z}from"./MCOIN-Bodfn-v1.js";import{_ as U}from"./PayHelpSelector-DsfF45cv.js";import{b as j,d as J,e as K,a4 as Q,W as X}from"./index-Clz0Qna-.js";import{_ as Y}from"./OfflineGoods-BGXEfi-E.js";import{P as w,f as Z,g as tt}from"./payHelp-SJlQkCy7.js";import{C as ot}from"./CommonVanProvider-CDfGVWR4.js";import{B as et}from"./BetweenTab-BE6o466J.js";import"./offlineGoods-DvT2Go6q.js";import"./ImgBoutiqueLable-BIio6fYG.js";import"./shop-CeqcS6K2.js";import"./BackIcon-8hcEjDKb.js";/* empty css                                                               */const st={class:"flex flex-col gap-y-3"},nt={class:"flex items-center gap-x-1"},at=a("div",{class:"w-[30px] h-[30px] bg-b5 rounded-full"},[a("img",{src:M})],-1),it={class:"text-b2 flex-1"},lt=C(" 我发起的代付 "),ut={class:"flex gap-x-0.5 text-newOrigin font-semibold"},rt={key:0},dt=a("span",null,"后过期",-1),ct={key:1},mt=a("div",{class:"text-b3"},"订单总金额:",-1),ft={class:"flex items-center"},pt=a("img",{src:z,class:"w-4 h-4 mr-1.5"},null,-1),_t={class:"text-b1 font-normal"},gt={class:"absolute right-0 bottom-0 px-1 py-0.5 min-w-[28px] text-center rounded-tl-lg rounded-br-lg text-b6 text-xs",style:{background:"rgba(0, 0, 0, 0.6)"}},yt={key:0,class:"flex items-center justify-end"},ht=C("分享帮付链接"),xt=L({props:{info:null,nowTime:null,type:null},setup(d){var r;const i=d,p=E(()=>{var n,c;return(c=(n=i.info)==null?void 0:n.orderGoods)==null?void 0:c.length}),y=E(()=>{var n;return p.value>0&&((n=i.info)==null?void 0:n.orderGoods[0])}),_=+((r=i.info)==null?void 0:r.createTime)+15*60*1e3-i.nowTime*1e3,N=E(()=>{var n;return`${window.location.origin}/#/payHelpGoods?payId=${(n=i==null?void 0:i.info)==null?void 0:n.id}`}),h=H(null),t=()=>{var n;h.value&&((n=h.value)==null||n.setShow(!0))};return(n,c)=>{var b,s;const B=k("van-count-down"),x=k("VanButton");return l(),m("div",st,[a("div",nt,[at,a("div",it,[d.type===o(w).OTHER?(l(),m($,{key:0},[C(v(o(j)(d.info.address,"...",5,5))+"发起帮付 ",1)],64)):(l(),m($,{key:1},[lt],64))]),a("div",ut,[_>0?(l(),m("div",rt,[_>0?(l(),T(B,{key:0,time:_,format:"mm:ss",onFinish:c[0]||(c[0]=()=>{})})):F("",!0),dt])):(l(),m("div",ct,"订单超时"))])]),g(Y,{goods:{goodsIcons:(b=o(y))==null?void 0:b.icons,...o(y)}},{"bottom-left":f(()=>[mt]),"bottom-price":f(()=>{var e;return[a("div",ft,[pt,a("div",_t,v(o(J)(((e=d.info)==null?void 0:e.totalAmount)||0)),1)])]}),"img-icon":f(()=>[a("div",gt," +"+v(o(p)),1)]),_:1},8,["goods"]),d.type===o(w).OWNER?(l(),m("div",yt,[g(x,{class:"bg-yellow h-[32px] px-3 rounded-md text-b1 font-semibold",onClick:P(t,["stop"])},{default:f(()=>[ht]),_:1},8,["onClick"])])):F("",!0),g(U,{ref:(e,D)=>{D.payHelpRef=e,h.value=e},amount:(s=d.info)==null?void 0:s.totalAmount,link:o(N)},null,8,["amount","link"])])}}}),vt=["src"],wt={class:"text-b3"},bt={class:"mx-3 py-3 safe-body overflow-y-auto"},Et=L({name:"ConsumerOrders"});function kt(d){const{regionStore:i,accountStore:p}=K(),y=O(),_=I(),{t:N}=q(),h=E(()=>[{label:"帮他人支付中",value:w.OTHER},{label:"等待他人支付",value:w.OWNER}]),t=R({status:w.OTHER,shopInfo:null,list:[],total:0,loading:!1,finished:!1,nowTime:null}),r=R({pageNum:0,pageSize:20}),n=s=>{t.status=s,y.replace({path:"payHelpGoodsList",query:{status:s}}),B()},c=s=>{y.push(s)},B=async()=>{t.finished=!1,t.total=0,t.list=[],r.pageNum=0,x()},x=async()=>{if(!(p!=null&&p.sign.address))return t.finished=!0;t.loading=!0,r.pageNum+=1,await b(),t.loading=!1},b=async()=>{const{success:s,data:e}=t.status?await Z(r):await tt(r);if(t.loading=!1,!s){t.finished=!0;return}if(!e||!(e!=null&&e.length)){t.finished=!0;return}t.list=r.pageNum===1?e:t.list.concat(e)};return S(async()=>{var s,e;(s=_.query)!=null&&s.status&&(t.status=Number((e=_.query)==null?void 0:e.status)),x(),t.nowTime=await Q()}),(s,e)=>{const D=k("VanList"),V=k("router-view");return l(),T(ot,{title:s.$t("payhelp.payList"),class:"bg-gray1 font-Puhui font-normal relative payHelpPage","theme-vars":{"field-placeholder-text-color":"#A6A6A6","count-down-text-color":"#FF8812","count-down-font-size":"16px"},ref:(u,A)=>{A.shopGoodsRef=u}},{right:f(()=>[a("img",{src:o(X)(`mall/${o(i).country}-flag.svg`),class:"w-5 h-auto mr-1"},null,8,vt),a("span",wt,v(s.$t(`country.${o(i).country}`))+v(o(i).country),1)]),default:f(()=>[g(et,{options:o(h),"label-key":"label","value-key":"value",modelValue:o(t).status,"onUpdate:modelValue":e[0]||(e[0]=u=>o(t).status=u),onChange:n},null,8,["options","modelValue"]),a("div",bt,[g(D,{loading:o(t).loading,"onUpdate:loading":e[1]||(e[1]=u=>o(t).loading=u),finished:o(t).finished,"immediate-check":!1,"finished-text":s.$t("common.noMore"),"loading-text":s.$t("common.loading"),onLoad:x},{default:f(()=>[(l(!0),m($,null,W(o(t).list,u=>(l(),T(xt,{class:"offline-crad-box mb-3",key:u.id,info:u,type:o(t).status,"now-time":o(t).nowTime,onClick:A=>c(`/payHelpGoods?payId=${u.id}`)},null,8,["info","type","now-time","onClick"]))),128))]),_:1},8,["loading","finished","finished-text","loading-text"])]),g(V,{class:"child-view bg-gray1"})]),_:1},8,["title"])}}const Bt=L({...Et,setup:kt}),It=G(Bt,[["__scopeId","data-v-831fac66"]]);export{It as default};
