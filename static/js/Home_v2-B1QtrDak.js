import{y as Q,F as d,G as a,H as t,Q as y,l as le,r as _,D as ie,O as T,P as e,_ as E,w as te,N as it,Y as j,Z as H,T as _e,x as L,z as ct,R as K,I as J,J as he,a9 as De,E as ae,K as M,a0 as nt,bc as we,bd as xe,a3 as Ct,X as P,a2 as ee,n as ve,a4 as Bt,be as D,bf as Ut,bg as at,bh as Pt,bi as At,t as lt}from"./vendor-Ba70TIw4.js";import{L as zt,I as Nt}from"./LevelPop-CIoS4G2F.js";import{_ as Dt,a as Et,E as Ft,H as Ot}from"./EditUserNamePop-CvLa8GVp.js";import{_ as Mt}from"./avatarRing-CLGxkH-F.js";import{U as Wt}from"./UserAsset-C_tLF0F6.js";import{u as Ee,f as be,a as rt,b as ut,p as ge,c as jt,d as W,e as ce,h as Ht,g as Gt,m as qt,i as Vt,j as Qt,o as Zt,k as Yt,l as Xt,n as V,q as Jt}from"./index-DiRx6UeW.js";import{_ as Kt}from"./mcoin-logo-1-Deho8IWN.js";import{u as dt}from"./usePointRelase-DHKqKMz7.js";import{L as Ne}from"./Lottie_v2-CV1u9nMf.js";import{I as es,W as ts}from"./WithdrawPop-B7M3yHKb.js";import{a as ss}from"./activityContract-DFdCtbmX.js";import{q as os,u as ns}from"./user-YzTePvUF.js";import{b as as}from"./browser-DFlSdkZC.js";import"./close-BkqxFSX4.js";import"./PopHeader-CPr5VpPI.js";import"./TokenBalance-D2dbq6-u.js";import"./level-CXYyT9QD.js";import"./ChangeRegionPop-yUEqIma_.js";import"./arrow-C-JiYSPQ.js";import"./arrow-bottom-D85vJawE.js";import"./ApproveButton-Dz4gGYB2.js";import"./MCOIN-Bodfn-v1.js";const ls=""+new URL("../images/edit-D2b4Y7Fs.svg",import.meta.url).href,is={class:"flex items-center justify-start text-lg mt-1"},cs={class:"truncate text-sm text-b1 font-semibold line-clamp-1"},rs=t("img",{src:ls,class:"w-4 h-4"},null,-1),us=[rs],ds=Q({props:{userName:null},emits:["handleToEditName"],setup(o,{emit:v}){return(r,u)=>(a(),d("div",is,[t("div",cs,y(o.userName),1),t("div",{class:"ml-1 text-primary",onClick:u[0]||(u[0]=l=>v("handleToEditName"))},us)]))}}),ms={class:"relative pt-3 px-3 pb-1"},ps={class:"avatar-wrap flex flex-row justify-start items-center"},fs={class:"relative flex-shrink-0"},hs=t("img",{class:"w-[32px] h-[32px] relative m-auto",src:Mt},null,-1),vs={class:"text-xs font-Puhui text-center px-1"},gs={class:"nickname-wrap h-[36px]"},_s=Q({props:{info:null,vsageUserInfo:null,isTag:{type:Boolean},tokens:null},emits:["setEditNameShow","setLevelShow"],setup(o,{emit:v}){const{getCurrentAccount:r}=Ee(),u=le(),{memberLevels:l}=be(),{changeUserInfo:i,userInfo:$}=rt(),m=_(($==null?void 0:$.storeMemberLevel)||0),x=async()=>{m.value=await l(),i({...$,storeMemberLevel:m.value})},S=f=>{u.push(f)},p=()=>{v("setEditNameShow")};return ie(()=>{x()}),(f,c)=>{var I;return a(),d("div",ms,[t("div",ps,[t("div",fs,[hs,t("div",{class:"bg-white rounded-xl flex text-center absolute right-[-14px] bottom-[-4px] min-w-max",onClick:c[0]||(c[0]=g=>v("setLevelShow"))},[t("p",vs," V"+y(m.value||0),1)])]),T(Wt,{tokens:o.tokens,onHandleTo:S,class:"w-full ml-6"},null,8,["tokens"])]),t("div",gs,[T(ds,{class:"min-w-max","user-name":((I=o.vsageUserInfo)==null?void 0:I.nickName)||e(ut)(e(r)()||"-","...",5,4),onHandleToEditName:p},null,8,["user-name"])])])}}}),ws=""+new URL("../images/tools-scan-C28Ke7ai.png",import.meta.url).href,xs=""+new URL("../images/tools-trans-Ck2uxaL4.png",import.meta.url).href,bs=""+new URL("../images/tools-share-Dmjj9UlR.png",import.meta.url).href,ys=""+new URL("../images/tools-i18n-cOjffy46.png",import.meta.url).href,ye=o=>(j("data-v-74f1ba01"),o=o(),H(),o),$s={class:"flex flex-col justify-start items-center absolute right-3 top-[54px]"},Ss=ye(()=>t("img",{src:ws,alt:"扫码"},null,-1)),Is=[Ss],ks=ye(()=>t("img",{src:xs,alt:"转账"},null,-1)),Ts=[ks],Rs=ye(()=>t("img",{src:bs,alt:"分享"},null,-1)),Ls=[Rs],Cs={class:"tool-item"},Bs=ye(()=>t("img",{src:ys,alt:"语言"},null,-1)),Us={emits:["handleTo","scan","invite"],setup(o,{emit:v}){const{t:r}=te(),{members:u}=be(),l=()=>{v("scan")},i=()=>{v("handleTo","/collect")},$=async()=>{if(!await u())return _e(r("home.inviteTip"));v("invite")};return(m,x)=>(a(),d("div",$s,[t("div",{class:"tool-item",onClick:l},Is),t("div",{class:"tool-item",onClick:i},Ts),t("div",{class:"tool-item",onClick:$},Ls),t("div",Cs,[T(Dt,{position:"right"},{icon:it(()=>[Bs]),_:1})])]))}},Ps=E(Us,[["__scopeId","data-v-74f1ba01"]]),As=""+new URL("../images/information-BqDj4dbA.svg",import.meta.url).href,Fe=o=>(j("data-v-a99e19b8"),o=o(),H(),o),zs={class:"point-days rounded-lg"},Ns={class:"relative w-full"},Ds=Fe(()=>t("img",{src:Et,class:"absolute top-0 right-0 -z-1"},null,-1)),Es={key:0,class:"z-10"},Fs={key:0,class:"text-[#000] font-semibold text-2xl flex items-end z-10"},Os={class:"time-text-shadow"},Ms={class:"text-xs"},Ws={key:1,class:"text-[#000] font-semibold text-2xl flex items-end z-10"},js={class:"time-text-shadow"},Hs={class:"text-xs text-[#000] font-semibold"},Gs={key:2,class:"text-[#000] font-semibold text-2xl flex items-end z-10"},qs={class:"time-text-shadow"},Vs={class:"text-xs text-[#000] font-semibold"},Qs={key:3,class:"text-[#000] font-semibold text-2xl flex items-end z-10"},Zs={class:"time-text-shadow"},Ys={class:"text-xs text-[#000] font-semibold"},Xs={key:1,class:"text-[#000] font-semibold text-3xl flex items-center z-10"},Js=Fe(()=>t("span",{class:"time-text-shadow text-3xl font-WorkSans"}," ∞ ",-1)),Ks={class:"ml-1 text-xs pt-3 pl-1"},eo={class:"text-b2 font-normal text-xxs"},to={class:"text-xxs font-bold text-b2"},so=Fe(()=>t("img",{class:"w-3 h-3 ml-[2px]",src:As},null,-1)),oo=Q({props:{contributes:{default:0},coinPoint:{default:0},userActiveStatus:{default:0},userActiveTime:{default:null}},emits:["handleOpen"],setup(o,{emit:v}){const r=o,{t:u}=te(),l=L(()=>r.userActiveStatus===1?r.userActiveStatus:r.contributes<=1e4?1:0),i=_(0),$=_(0),m=_(0),x=_(0),S=_(0),p=L(()=>($.value=Math.floor(i.value/3600/24)<=0?0:Math.floor(i.value/3600/24),x.value=Math.floor(i.value/3600)<=0?0:Math.floor(i.value/3600),m.value=Math.floor(i.value/60)<=0?0:Math.floor(i.value/60),S.value=Math.floor(i.value)<=0?0:Math.floor(i.value),[$.value,x.value,m.value,S.value]));let f=null;return ct(()=>{var c;return(c=r.userActiveTime)==null?void 0:c.cutdownTimestamp},c=>{c&&(i.value=(c-new Date().getTime())/1e3,f&&clearInterval(f),f=setInterval(()=>{i.value>0?i.value--:clearInterval(f)},1e3))},{immediate:!0,deep:!0}),(c,I)=>(a(),d("div",zs,[t("div",Ns,[t("div",{class:K(["flex items-end justify-center relative rounded-t-lg p-2 min-w-[80px] overflow-hidden h-[46px]",e(l)?" bg-[#FED73A]":"bg-[#E9E4DE]"])},[Ds,o.contributes>=1e4?(a(),d("div",Es,[e(p)[0]>0?(a(),d("div",Fs,[(a(!0),d(J,null,he(e(ge)(e(p)[0],2),(g,k)=>(a(),d("div",{class:"bg-white w-[23px] h-[30px] rounded-lg mr-1 px-1",key:k},[t("span",Os,y(g),1)]))),128)),t("div",Ms,y(c.$t("common.days")),1)])):e(p)[1]>0?(a(),d("div",Ws,[(a(!0),d(J,null,he(e(ge)(e(p)[1],2),(g,k)=>(a(),d("div",{class:"bg-white w-[23px] h-[30px] rounded-lg mr-1 px-1 overflow-hidden text-center",key:k},[t("span",js,y(g),1)]))),128)),t("div",Hs,y(c.$t("common.hours")),1)])):e(p)[2]>0?(a(),d("div",Gs,[(a(!0),d(J,null,he(e(ge)(e(p)[2],2),(g,k)=>(a(),d("div",{class:"bg-white w-[23px] h-[30px] rounded-lg mr-1 px-1 overflow-hidden text-center",key:k},[t("span",qs,y(g),1)]))),128)),t("div",Vs,y(c.$t("common.minutes")),1)])):(a(),d("div",Qs,[(a(!0),d(J,null,he(e(ge)(e(p)[3],2),(g,k)=>(a(),d("div",{class:"bg-white w-[23px] h-[30px] rounded-lg mr-1 px-1 overflow-hidden text-center",key:k},[t("span",Zs,y(g),1)]))),128)),t("div",Ys,y(c.$t("common.seconds")),1)]))])):(a(),d("div",Xs,[Js,t("div",Ks,y(c.$t("common.days")),1)]))],2),t("div",{onClick:I[0]||(I[0]=g=>v("handleOpen")),class:K(["font-normal pl-4 text-center rounded-b-[4px] pr-2 flex items-center justify-center w-full py-[1px] h-[15px]",e(l)?"bg-[#FFE0B6]":"bg-[#FFF0D9]"])},[t("span",eo,y(e(jt)(e(W)(o.coinPoint,0))),1),t("span",to,y(c.$t("common.credit")),1),so],2)])]))}}),no=E(oo,[["__scopeId","data-v-a99e19b8"]]),ao=""+new URL("../images/go-tr-C6OxuTpH.png",import.meta.url).href,lo=""+new URL("../images/go-tr-icon-D6nG65Ok.png",import.meta.url).href,io=""+new URL("../images/go-tr-arrow-BxXIWQWF.png",import.meta.url).href,Oe=o=>(j("data-v-41206486"),o=o(),H(),o),co=Oe(()=>t("div",{class:"tr-img"},[t("img",{src:ao})],-1)),ro=Oe(()=>t("img",{src:lo,alt:"token right icon",class:"absolute top-[-6px] left-[6px] w-[40px] h-[40px]"},null,-1)),uo={class:"absolute right-[4px] top-0 h-full flex justify-end items-center -translate-y-[2px]"},mo={class:"text-sm font-semibold font-Puhui text-b6"},po=Oe(()=>t("img",{src:io,class:"w-[16px] h-[16px] ml-[2px]"},null,-1)),fo={setup(o){const v=()=>{var u;const r=`${(u=window.location)==null?void 0:u.origin}/ecology/#/maiPledge?refresh=1&origin=main`;window.location.assign(r)};return(r,u)=>(a(),d("div",{class:"go-token-right relative w-[128px]",onClick:v},[co,ro,t("p",uo,[t("span",mo,y(r.$t("ecology.Token Rights road")),1),po])]))}},ho=E(fo,[["__scopeId","data-v-41206486"]]),vo=""+new URL("../images/balance-big-BlAQSRAv.png",import.meta.url).href,go=""+new URL("../images/balance-small-DTMS8DT7.png",import.meta.url).href,_o=""+new URL("../images/visibility-D5JMp6Ho.svg",import.meta.url).href,wo=""+new URL("../images/copy-gray-CDg8kt-2.svg",import.meta.url).href,xo=""+new URL("../images/bank-card-fill-6SZF_gMZ.svg",import.meta.url).href,Z=o=>(j("data-v-0d1f03ca"),o=o(),H(),o),bo={class:"balance-container relative w-full"},yo=Z(()=>t("img",{src:vo,class:"absolute top-0 left-0 w-full h-[107px] z-[1]"},null,-1)),$o=Z(()=>t("img",{src:go,class:"absolute top-2 right-2 w-[40%] h-[39px]"},null,-1)),So={class:"absolute top-0 left-0 w-full h-full p-3 z-[2]"},Io={class:"point-box"},ko={class:"flex items-center font-sm text-b2 font-normal"},To=Z(()=>t("img",{class:"w-4 h-4",src:_o},null,-1)),Ro=[To],Lo={class:"text-xl text-b1 font-Audiowide mt-1 leading-[25px] min-w-max"},Co=Z(()=>t("img",{src:wo,class:"w-3 h-3 ml-2",alt:"copy"},null,-1)),Bo={class:"balance-box"},Uo={class:"balance-item"},Po={class:"balance-icon"},Ao=Z(()=>t("img",{src:Kt,alt:""},null,-1)),zo={class:"balance-label text-b3 text-sm"},No={class:"balance-value"},Do=Z(()=>t("div",{class:"divider"},null,-1)),Eo={class:"balance-icon"},Fo=Z(()=>t("img",{src:xo},null,-1)),Oo={class:"balance-label text-b3"},Mo={class:"balance-value"},Wo=Q({props:{contributes:{default:0},contributesLoading:{type:Boolean,default:!1},pointBalance:{default:0},mcoinBalance:{default:0},pointLoading:{type:Boolean,default:!1},mcoinLoading:{type:Boolean,default:!1}},setup(o){const v=le(),{getCurrentAccount:r}=Ee(),{contributesStore:u}=ce(),{t:l}=te(),i=_(1),$=()=>{const c=Math.min(window.innerWidth,375);i.value=c/375},m=()=>{u.changeHideIntegral(!u.hideIntegral)},x=()=>{const f=r();f&&Ht(f)},S=L(()=>ut(r()||"-","...",5,4)),p=f=>{v.push(f)};return ie(()=>{window.addEventListener("resize",$)}),De(()=>{window.removeEventListener("resize",$)}),(f,c)=>{const I=ae("VanLoading"),g=ae("van-loading");return a(),d("div",bo,[yo,$o,t("div",So,[t("div",Io,[t("div",ko,[t("span",null,y(f.$t("common.credit")),1),t("div",{class:"pl-1",onClick:m},Ro)]),t("div",Lo,[o.contributesLoading?(a(),M(I,{key:0,color:"#000",size:"20"})):(a(),d("span",{key:1,class:"relative",onClick:c[0]||(c[0]=k=>p("/integralDetail"))},y(e(u).hideIntegral?e(W)(o.contributes,2):"***"),1))])]),t("div",{class:"address-box text-b1 font-normal text-xs absolute flex items-center justify-end h-[18px] leading-[18px] top-[16px] right-[20px]",onClick:x},[t("span",null,y(e(S)),1),Co]),t("div",Bo,[t("div",Uo,[t("div",Po,[Ao,t("div",zo,y(f.$t("common.wallet")),1)]),t("div",No,[o.mcoinLoading?(a(),M(g,{key:0,size:"14"})):(a(),d(J,{key:1},[nt(y(e(W)(o.mcoinBalance||0,3)),1)],64))])]),Do,t("div",{class:"balance-item",onClick:c[1]||(c[1]=k=>p("/balanceDetail"))},[t("div",Eo,[Fo,t("div",Oo,y(f.$t("assets.canWithdrawv2")),1)]),t("div",Mo,[o.pointLoading?(a(),M(g,{key:0,size:"14"})):(a(),d(J,{key:1},[nt(y(e(W)(o.pointBalance,3)),1)],64))])])])])])}}}),jo=E(Wo,[["__scopeId","data-v-0d1f03ca"]]),Ho={class:"flex justify-between gap-3"},Go={emits:["invest","withdraw"],setup(o){return(v,r)=>(a(),d("div",Ho,[t("div",{class:"send-btn w-full h-[50px] text-[#FF8812] text-lg text-center flex items-center justify-center",onClick:r[0]||(r[0]=u=>v.$emit("invest"))},y(v.$t("home.invest")),1),t("div",{class:"get-btn w-full h-[50px] text-b1 text-lg text-center flex items-center justify-center",onClick:r[1]||(r[1]=u=>v.$emit("withdraw"))},y(v.$t("home.withdraw")),1)]))}},qo=E(Go,[["__scopeId","data-v-8029a830"]]),Vo=""+new URL("../images/cat-house-BaIWGYDK.png",import.meta.url).href,Qo=""+new URL("../images/cat-shadow-naI2hTWi.svg",import.meta.url).href,Zo=""+new URL("../images/bowl-BUuEu_lz.png",import.meta.url).href,Yo=""+new URL("../images/arrow-right-s-line-DoZN1Qa9.png",import.meta.url).href,Xo=""+new URL("../images/cat-food-CqiIXtTs.png",import.meta.url).href,Jo=o=>(j("data-v-7ab7cf68"),o=o(),H(),o),Ko={class:"text-xs text-white font-semibold text-shadow text-center whitespace-nowrap"},en=Jo(()=>t("img",{src:Xo,alt:"",class:"h-[28px]"},null,-1)),tn={class:"font-semibold text-sm text-[#B67829] display-text-shadow"},sn={key:1},on=Q({props:{scale:{default:1},bubbleLoading:{type:Boolean,default:!1},text:{default:""}},emits:["releaseStart","releaseSuccess","releaseFail"],setup(o,{expose:v,emit:r}){const u=o,{t:l}=te(),{contributesStore:i}=ce(),{handleNaturePoints:$}=dt(),m=L(()=>u.bubbleLoading),x=L(()=>i.freeRelease||0);L(()=>i.releaseLoading),L(()=>i.releaseSecond);const S=_(!1),p=_(!1),f=()=>{if(u.bubbleLoading||S.value||W(x.value)<=0)return;S.value=!0,setTimeout(()=>{p.value=!0,S.value=!1;try{r("releaseStart"),$(c)}catch(I){console.error("release fail:",I),setTimeout(()=>{r("releaseFail"),p.value=!1},1e3)}},500);const c=(I=!0)=>{I?r("releaseSuccess"):(console.error("release fail"),setTimeout(()=>{r("releaseFail"),p.value=!1,console.log("animationFinished",p.value)},1e3))}};return v({handleRelease:f}),(c,I)=>{const g=ae("van-loading");return we((a(),d("div",{class:K(["release-bubble w-[140px] max-w-[140px] h-[140px] max-h-[140px] flex flex-col items-center justify-center",S.value?"release-loading":""]),style:P({width:`${90*o.scale}px`,height:`${90*o.scale}px`}),onClick:f},[t("div",Ko,y(o.text),1),en,t("div",tn,[e(m)?(a(),M(g,{key:0,size:"14",color:"#B67829"})):(a(),d("span",sn," +"+y(e(x)<1?e(W)(e(x),4):e(W)(e(x),2)),1))]),Ct(c.$slots,"default",{},void 0,!0)],6)),[[xe,!p.value]])}}}),nn=E(on,[["__scopeId","data-v-7ab7cf68"]]),mt=o=>(j("data-v-436b4b17"),o=o(),H(),o),an={class:"release-component"},ln={class:"progress-bar__wrap absolute z-10 left-[-16px] top-[50px]"},cn=mt(()=>t("div",{class:"progress_pattern"},null,-1)),rn=[cn],un={class:"progress_word absolute z-10 left-1/2 top-1/2 transform -translate-x-1/2 -translate-y-1/2"},dn=mt(()=>t("img",{class:"absolute z-10 right-[2px] top-1/2 transform -translate-y-1/2 w-[12px] h-[12px]",src:Yo,alt:""},null,-1)),mn={props:{bowlStyle:{type:Object,default:()=>({})},text:{type:String,required:!0},releaseSecond:{type:Number,default:0},bubbleLoading:{type:Boolean,default:!1}},emits:["releaseStart","releaseSuccess","releaseFail"],setup(o,{expose:v,emit:r}){const u=le(),{contributesStore:l}=ce(),i=_(!1),$=L(()=>l.releaseData||{}),m=_(!1),x=L(()=>{const g=+$.value.monthTotal||0,k=+$.value.remainTotal||0;return g>0?k/g:0}),S=()=>{m.value=!0,r("releaseStart")},p=()=>{I(),r("releaseSuccess"),setTimeout(async()=>{await l.fetchUserRelase(),setTimeout(()=>{m.value=!1},1e3)},12e3)},f=()=>{m.value=!1,r("releaseFail")},c=_(null),I=async()=>{i.value=!0,await l.getNaturalReleaseTimes(),i.value=!1};return v({releaseBubbleRef:c}),ie(()=>{I()}),(g,k)=>(a(),d("div",an,[t("img",{src:Zo,class:"cat-food w-[60px] h-[44px] absolute z-[1]",style:P(o.bowlStyle),role:"img",alt:"猫粮盆"},null,4),e(W)(+e(l).freeRelease)>0?(a(),M(nn,{key:0,ref:(h,C)=>{C.releaseBubbleRef=h,c.value=h},class:"absolute left-[-16px] top-[-96px] z-50",style:P([{transition:"opacity 0.2s ease-in"},{opacity:m.value?0:1}]),text:o.text,bubbleLoading:m.value,onReleaseSuccess:p,onReleaseStart:S,onReleaseFail:f},null,8,["style","text","bubbleLoading"])):ee("",!0),t("div",ln,[t("div",{class:"progress_bar relative flex items-center",onClick:k[0]||(k[0]=h=>e(u).push("/releaseTimeDetail"))},[t("div",{class:"progress_act",style:P(`width: calc(${e(x)} * 177px / 2)`)},rn,4),t("div",un,y(e($).remainTotal||0)+"/"+y(e($).monthTotal||0),1),dn])])]))}},pn=E(mn,[["__scopeId","data-v-436b4b17"]]),fn={class:"multi-lottie-container relative"},hn={props:{animation:{type:String,default:"wink",validator:o=>["eat2","eat1","wink"].includes(o)},lottieClass:{type:String,default:""},lottieStyle:{type:Object,default:()=>({})}},emits:["complete"],setup(o,{expose:v,emit:r}){const u=o,l={eat2:{path:"lottie/eat_v2.json",loop:!0},eat1:{path:"lottie/eat.json",loop:!1},wink:{path:"lottie/wink.json",loop:!0}},i=_(u.animation),$=_(null),m=_(null),x=_(null),S=L(()=>{switch(i.value){case"eat2":return $.value;case"eat1":return m.value;case"wink":return x.value;default:return x.value}});ct(()=>u.animation,h=>{h!==i.value&&["eat2","eat1","wink"].includes(h)&&(i.value=h,ve(()=>{p()}))});const p=()=>{const h=S.value;if(h)try{i.value==="wink"?h.handlePlay():h.handleGoToAndPlay(0)}catch(C){console.warn("Failed to play animation:",C)}},f=()=>{i.value!=="wink"&&(i.value="wink",ve(()=>{p()})),r("complete",i.value)};return v({setAnimation:h=>{["eat2","eat1","wink"].includes(h)?(i.value=h,ve(()=>{p()})):console.warn(`Invalid animation key: ${h}`)},play:()=>{p()},pause:()=>{const h=S.value;if(h&&typeof h.pause=="function")try{h.handlePause()}catch(C){console.warn("Failed to pause animation:",C)}},stop:()=>{const h=S.value;if(h&&typeof h.stop=="function")try{h.handleStop()}catch(C){console.warn("Failed to stop animation:",C)}},getCurrentLottieRef:S}),ve(()=>{p()}),(h,C)=>(a(),d("div",fn,[we(T(Ne,{class:K(["lottie-item eat-2",o.lottieClass]),style:P(o.lottieStyle),path:l.eat2.path,loop:l.eat2.loop,ref:(z,F)=>{F.eat2Ref=z,$.value=z},autoplay:!1,onComplete:f},null,8,["class","style","path","loop"]),[[xe,i.value==="eat2"]]),we(T(Ne,{class:K(["lottie-item",o.lottieClass]),style:P(o.lottieStyle),path:l.eat1.path,loop:l.eat1.loop,ref:(z,F)=>{F.eat1Ref=z,m.value=z},autoplay:!1,onComplete:f},null,8,["class","style","path","loop"]),[[xe,i.value==="eat1"]]),we(T(Ne,{class:K(["lottie-item",o.lottieClass]),style:P(o.lottieStyle),path:l.wink.path,loop:l.wink.loop,autoplay:!0,ref:(z,F)=>{F.winkRef=z,x.value=z},onComplete:f},null,8,["class","style","path","loop"]),[[xe,i.value==="wink"]])]))}},vn=E(hn,[["__scopeId","data-v-7a50b9a2"]]),gn=""+new URL("../images/roadSigns-DPiZ1yw1.png",import.meta.url).href,_n={},wn={class:"p-3 flex justify-center items-center"},xn=t("img",{src:gn,alt:"road-sign",class:"w-[78px]"},null,-1),bn=[xn];function yn(o,v){return a(),d("div",wn,bn)}const $n=E(_n,[["render",yn]]),Sn=""+new URL("../images/cat-house-min-D9fPn9IA.webp",import.meta.url).href,pt=o=>(j("data-v-1322bf64"),o=o(),H(),o),In={class:"mascot-cat__container relative"},kn=pt(()=>t("div",{class:"pre-bg"},null,-1)),Tn=["lowsrc"],Rn=["src"],Ln=pt(()=>t("img",{src:Qo,class:"w-[100px]",alt:"猫影子"},null,-1)),Cn=[Ln],Bn={props:{vsageUserInfo:{type:Object,default:()=>({})}},emits:["releaseStart","releaseSuccess","releaseFail"],setup(o,{expose:v,emit:r}){const u=o,l=le(),{t:i}=te(),{contributesStore:$}=ce();dt();const m=L(()=>{var B,A;return console.log("nftId",(B=u.vsageUserInfo)==null?void 0:B.nftTokenId),(A=u.vsageUserInfo)==null?void 0:A.nftTokenId}),x=_(1),S=_(0),p=()=>{let A=0;window.innerWidth>=640?A=375:A=window.innerWidth,S.value=Number(A),x.value=A/375},f=L(()=>({transform:` scale(${x.value})`,transformOrigin:"top left",top:`${.6784*S.value+5}px`,left:`${50*x.value}px`,zIndex:10})),c=L(()=>({transform:`scale(${x.value})`,transformOrigin:"top right",top:`${.6784*S.value+6}px`,right:`${12*x.value-10}px`})),I=L(()=>({width:"140px",top:`${.6784*S.value+-60}px`,zIndex:2})),g=L(()=>({width:"100px",top:`${.6784*S.value+79}px`,zIndex:1})),k=_(null),h=_("wink"),C=B=>{h.value=B,k.value&&k.value.setAnimation(B)},z=()=>{r("releaseStart"),C("eat2")},F=()=>{C("eat2"),setTimeout(()=>{r("releaseSuccess")},3e3),setTimeout(()=>{C("wink")},4e3)},re=()=>{r("releaseFail"),C("wink")},$e=()=>{console.log("handleToPlaza"),l.push({path:"/plaza",query:{from:"home"}})};return ie(()=>{window.addEventListener("resize",p),p()}),De(()=>{window.removeEventListener("resize",p)}),v({setLottie:C}),(B,A)=>(ae("van-button"),a(),d("div",In,[kn,t("img",{lowsrc:e(Sn),src:Vo,class:"cat-house w-[257px] h-[252px] absolute top-[31px] left-0 z-0",style:P({transform:` scale(${x.value})`,transformOrigin:"top left"}),role:"img",decoding:"async",alt:"猫爬架"},null,12,Tn),T(pn,{ref:(Y,se)=>{se.releaseComponentRef=Y},text:B.$t("integral.nature"),"release-second":e($).releaseSecond,onReleaseStart:z,onReleaseSuccess:F,onReleaseFail:re,style:P(e(f))},null,8,["text","release-second","style"]),e(m)===-1||e(m)===null||e(m)===void 0?(a(),M(vn,{key:0,class:"pointer-events-none mx-auto absolute w-[140px] left-0 right-0",style:P(e(I)),animation:h.value,ref:(Y,se)=>{se.multiLottieRef=Y,k.value=Y}},null,8,["style","animation"])):(a(),d("div",{key:1,class:"absolute ip-box-img left-0 right-0 mx-auto flex justify-center items-center",style:P(e(I))},[t("img",{src:e(Gt)(`nft/nft-${e(m)}.png`)},null,8,Rn)],4)),e(m)===-1||e(m)===null||e(m)===void 0?(a(),d("div",{key:2,class:"cat-shadow pointer-events-none mx-auto absolute w-[100px] left-0 right-0 bottom-0",style:P(e(g))},Cn,4)):ee("",!0),T($n,{class:"absolute",style:P(e(c)),onClick:Bt($e,["self"])},null,8,["style","onClick"]),ee("",!0)]))}},Un=E(Bn,[["__scopeId","data-v-1322bf64"]]),Pn=o=>(j("data-v-979ecdba"),o=o(),H(),o),An={class:"relative home-app w-full overflow-hidden font-Puhui"},zn={class:"home__container h-auto pb-20 w-full"},Nn={class:"top-ui__wrap relative z-20"},Dn={class:"bottom-ui__wrap flex flex-col justify-end px-3 pb-[90px] w-full z-10 pointer-events-none"},En={class:"flex items-end justify-between pointer-events-none"},Fn={class:"mt-3 pointer-events-auto"},On={class:"mt-3 pointer-events-auto"},Mn={key:0,class:"fixed top-0 bottom-0 left-0 right-0 z-50 min-h-screen min-w-screen"},Wn=Pn(()=>t("div",{style:{color:"red"},class:"frame"},null,-1)),jn=Q({name:"Home"});function Hn(o){var tt,st;qt();const{activeStatus:v,activeAmounts:r}=ss(),{getCurrentAccount:u}=Ee(),{contributesStore:l}=ce(),{pointBalances:i,pointWithdraw:$}=be(),m=Vt(),x=Qt(),{trade:S}=be(),{tradeWithUsdt:p}=Zt(),{t:f}=te(),c=le(),[I,g]=D(!1),[k,h]=D(!1),[C,z]=D(!1),[F,re]=D(!1),[$e,B]=D(!1),[A,Y]=D(!0),[se,ft]=D(!0),[Me,ue]=D(!1),[ht,G]=D(!1),[We,Se]=D(!1),[vt,Ie]=D(!1),je=_(null),{userInfo:q,changeUserInfo:gt}=rt(),{getOneBalance:de}=Yt(),oe=_(["MCOIN","MUSD","MAI"]),w=Ut({nftActive:!1,userInfo:{address:"",userName:""},contributesOld:0,userContributes:{contributes:0,consumes:0,payments:0,releaseSecond:0},vsageUserInfo:{nickName:((tt=q==null?void 0:q.vsageUserInfo)==null?void 0:tt.nickName)||"",nftTokenId:((st=q==null?void 0:q.vsageUserInfo)==null?void 0:st.nftTokenId)||-1},nftId:-1,coinPoint:0,userActiveStatus:0,userActiveTime:null,pointBalance:null,mcoinBalance:null,usdtBalance:null,allowance:0}),ke=async()=>{w.pointBalance=await i(),Y(!1)},me=async()=>{w.mcoinBalance=await(await m).balanceOf(),ft(!1)},Te=async()=>{try{w.usdtBalance=await(await x).balanceOf(u())}catch{w.usdtBalance=0}},He=async()=>{const s=await(await m).allowance(Jt.flashMall);w.allowance=s.result},Ge=s=>{if(typeof s=="string"&&s.indexOf("address")!==-1&&(s.indexOf("offlineSubmit")!==-1||s.indexOf("pay")!==-1)){g(!1);const n=V(s,"address"),R=V(s,"ratio"),U=V(s,"caddr"),b=V(s,"cname"),N=V(s,"amount"),X=V(s,"orderType"),ne=V(s,"key");c.push({path:"/offlineSubmit",query:{address:n,ratio:R,caddr:U,cname:b,amount:N,orderType:X,key:ne}})}if(typeof s=="string"&&s.indexOf("goodsDetail")!==-1&&s.indexOf("id")!==-1&&(g(!1),c.push({path:"/goodsDetail",query:{id:s.split("=")[1]}})),typeof s=="string"&&s.indexOf("offlineGoodsDetail")!==-1&&s.indexOf("goodsId")!==-1&&(g(!1),c.push({path:"/offlineGoodsDetail",query:{goodsId:s.split("=")[1]}})),typeof s=="string"&&s.indexOf("shop")!==-1&&s.indexOf("shopId")!==-1&&(g(!1),c.push({path:"/shop",query:{shopId:s.split("=")[1]}})),typeof s=="string"&&s.indexOf("category")!==-1&&s.indexOf("shopId")!==-1){const n=_t(s,"shopId");g(!1),c.push({path:"/category",query:{deliveryType:1,init:1,shopId:n}})}};function _t(s,n){const R=s.substring(s.indexOf("#")+1),U=R.indexOf("?"),b=U!==-1?R.substring(U+1):"";return new URLSearchParams(b).get(n)}const wt=s=>{s.catch(()=>{_e(f("common.scanError")),g(!1)})},qe=()=>{h(!1),z(!0)},Re=s=>{c.push(s)},Ve=async()=>{const s=await ns(u());!s.success||!s.data||(w.contributesOld=w.userContributes.contributes||0,w.userInfo=s.data)},Qe=_(),xt=L(()=>Qe.value&&Qe.value.memberLevel||0),bt=async()=>{if(!lt.isConnected()||!as.versions.android)return g(!0);lt.invokeQRScanner().then(s=>{Ge(s)}).catch(s=>{_e(s)})},Le=async()=>{const s=await os();!s.success||!s.data||(w.vsageUserInfo=s.data,gt({...q,vsageUserInfo:w.vsageUserInfo}))},yt=async(s,n,R)=>{if(R==="USDT")$t(s,n);else{G(!0);try{const U=await S(u(),s,n);if(!U.success)return G(!1);await U.result.wait(),G(!1),ue(!1),Ce("eat1"),Be(),setTimeout(()=>{l.getNaturalReleaseTimes()},3e3)}finally{G(!1)}}},$t=async(s,n)=>{G(!0);try{const R=await p(u(),s,n);if(!R.success)return;await R.result.wait(),G(!1),ue(!1),Ce("eat1"),Be(),setTimeout(()=>{l.getNaturalReleaseTimes()},3e3)}finally{G(!1)}},St=s=>{s==="USDT"?Te():me()},It=async(s,n)=>{Ie(!0);try{const R=await $(s,n);if(Ie(!1),!R.success)return;_e(f("maiPledge.Extraction successful")),Se(!1),Ce("eat1"),Be(),setTimeout(()=>{l.getNaturalReleaseTimes()},3e3),je.value.amount=null}finally{Ie(!1)}},Ze=async()=>{var U,b,N;const s=await r();w.coinPoint=+s||0;const n=await v();if(!n.success)return;w.userActiveStatus=Number(((U=n.result)==null?void 0:U.status)||0);const R=Xt(((b=n.result)==null?void 0:b.time)*1e3);w.userActiveTime={dateTime:R,cutdownTimestamp:+((N=n.result)==null?void 0:N.time)*1e3,m:R.split("-")[1].padStart(2,"0"),d:R.split("-")[2].split(" ")[0].padStart(2,"0"),h:R.split("-")[2].split(" ")[1].split(":")[0].padStart(2,"0")}},Ye=_(null),Ce=s=>{Ye.value.setLottie(s)},Be=async()=>{Ve(),l.fetchContributes(),Le(),Ze(),ke(),me(),Te(),He(),oe.value.forEach(s=>de(s)),setTimeout(()=>{document.title="首页"},500)},Ue=_(!1),Pe=()=>{Ve(),Le(),He(),setTimeout(()=>{document.title="首页"},500)},O=at(()=>{Ue.value&&(localStorage.getItem("isRegister")?(localStorage.removeItem("isRegister"),setTimeout(()=>{l.fetchContributes(),l.fetchRelaseByScan()},3e3)):(l.fetchContributes(),l.fetchRelaseByScan()),Ze(),ke(),me(),Te())},3e4,{immediateCallback:!0});let pe,Ae;const kt=()=>{O.pause()},Tt=()=>{O.resume(),Ae=0,pe=at(()=>{Ae<3?(console.log("getPointBalance/getMcoinBalance"),ke(),me(),oe.value.forEach(s=>de(s))):pe.pause(),Ae++},3e3)},Rt=()=>{O.resume()},Xe=_(375),Je=_(0),ze=()=>{Xe.value=window.innerWidth,Je.value=window.innerHeight,setTimeout(()=>{fe()},100)};L(()=>Math.min(640,Xe.value)/Je.value);const Ke=_(0),et=_(0),fe=()=>{const s=document.querySelector(".top-ui__wrap"),n=document.querySelector(".bottom-ui__wrap"),R=document.querySelector(".main-ui__wrap");if(s&&n){const U=s.getBoundingClientRect(),b=n.getBoundingClientRect(),N=R.getBoundingClientRect(),X=U.bottom,ne=b.top,Lt=N.top,ot=X+(ne-X)/2;return Ke.value=ot-235||0,et.value=Math.max(Lt+40,88),{topUiBottom:X,bottomUiTop:ne,centerPoint:ot,distance:ne-X}}else return null};return ie(()=>{Pe(),ze(),window.addEventListener("resize",ze),l.releaseSecond=0,l.releaseSecondFlag=!1,l.freeRelease=0,setTimeout(()=>{fe()},100),document.addEventListener("visibilitychange",function(){document.hidden||(Pe(),oe.value.forEach(s=>de(s)),setTimeout(()=>{l.getNaturalReleaseTimes()},3e3),setTimeout(()=>{fe()},100),O.pause(),setTimeout(()=>{Ue.value=!0,O.resume()},500),console.log("fm-home show"))})}),Pt(()=>{Pe(),oe.value.forEach(s=>de(s)),setTimeout(()=>{l.getNaturalReleaseTimes()},3e3),setTimeout(()=>{fe()},100),O.pause(),setTimeout(()=>{Ue.value=!0,O.resume()},500)}),De(()=>{window.removeEventListener("resize",ze),O&&O.pause(),pe&&pe.pause()}),(s,n)=>{var U;const R=ae("van-icon");return a(),d("div",An,[t("div",zn,[t("div",Nn,[t("div",{class:"bg-test absolute left-0 top-0 w-full",style:P({height:et.value+"px"})},null,4),T(_s,{tokens:oe.value,info:e(w).userInfo,vsageUserInfo:e(w).vsageUserInfo,onSetLevelShow:n[0]||(n[0]=b=>e(h)(!0)),onSetEditNameShow:n[1]||(n[1]=b=>e(re)(!0))},null,8,["tokens","info","vsageUserInfo"]),T(Ps,{onHandleTo:Re,onScan:bt,onInvite:qe})]),t("div",{class:"main-ui__wrap w-full absolute top-0",style:P({transform:`translateY(${Ke.value}px)`})},[T(Un,{ref:(b,N)=>{N.gameGrassRef=b,Ye.value=b},vsageUserInfo:e(w).vsageUserInfo,onReleaseStart:kt,onReleaseSuccess:Tt,onReleaseFail:Rt},null,8,["vsageUserInfo"])],4),t("div",Dn,[t("div",En,[T(no,{class:"point-times__wrap pointer-events-auto",contributes:e(l).contributes,coinPoint:e(w).coinPoint,userActiveStatus:e(w).userActiveStatus,userActiveTime:e(w).userActiveTime,onHandleOpen:n[2]||(n[2]=b=>e(B)(!0))},null,8,["contributes","coinPoint","userActiveStatus","userActiveTime"]),T(ho,{onHandleTo:Re,class:"pointer-events-auto"})]),t("div",Fn,[T(jo,{contributes:e(l).contributes,contributesLoading:e(l).loading,pointBalance:e(w).pointBalance,mcoinBalance:e(w).mcoinBalance,pointLoading:e(A),mcoinLoading:e(se)},null,8,["contributes","contributesLoading","pointBalance","mcoinBalance","pointLoading","mcoinLoading"])]),t("div",On,[T(qo,{onInvest:n[3]||(n[3]=b=>e(ue)(!0)),onWithdraw:n[4]||(n[4]=b=>e(Se)(!0))})])])]),T(zt,{show:e(k),userInfo:e(w).userInfo,memberLevel:e(xt),onClose:n[5]||(n[5]=b=>e(h)(!1)),onInvite:qe,onHandleTo:Re},null,8,["show","userInfo","memberLevel"]),T(Nt,{show:e(C),onClose:n[6]||(n[6]=b=>e(z)(!1))},null,8,["show"]),e(I)?(a(),d("div",Mn,[t("div",{class:"absolute z-50 text-white top-2 left-2",onClick:n[7]||(n[7]=b=>e(g)(!1))},[T(R,{name:"arrow-left"})]),T(e(At.QrStream),{onDecode:Ge,onInit:wt},{default:it(()=>[Wn]),_:1})])):ee("",!0),T(Ft,{show:e(F),userName:(U=e(w).vsageUserInfo)==null?void 0:U.nickName,onClose:n[8]||(n[8]=b=>e(re)(!1)),onSuccess:n[9]||(n[9]=b=>Le())},null,8,["show","userName"]),T(Ot,{show:e($e),onClose:n[10]||(n[10]=b=>e(B)(!1))},null,8,["show"]),e(Me)?(a(),M(es,{key:1,show:e(Me),MCOINBalance:+e(w).mcoinBalance+ +e(w).pointBalance,pointBalance:+e(w).pointBalance,USDTBalance:+e(w).usdtBalance,loading:e(ht),owner:e(u)(),onClose:n[11]||(n[11]=b=>e(ue)(!1)),onHanldeInvest:yt,onChangeBalance:St},null,8,["show","MCOINBalance","pointBalance","USDTBalance","loading","owner"])):ee("",!0),e(We)?(a(),M(ts,{key:2,ref:(b,N)=>{N.withdrawRef=b,je.value=b},show:e(We),balance:e(w).pointBalance,loading:e(vt),onClose:n[12]||(n[12]=b=>e(Se)(!1)),onHandleWithdraw:It},null,8,["show","balance","loading"])):ee("",!0)])}}const Gn=Q({...jn,setup:Hn}),ha=E(Gn,[["__scopeId","data-v-979ecdba"]]);export{ha as default};
