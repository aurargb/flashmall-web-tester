import{B as z}from"./BackIcon-8hcEjDKb.js";import{_ as H}from"./TimeFilter-mm4FPbc4.js";import{_ as N,y as k,w as F,r as l,x as A,l as j,D as L,F as S,G as g,O as _,N as B,H as t,Q as i,P as D,a2 as q,E as U,Z as V,$ as Z,I as J,J as K,K as Q}from"./vendor-BlU_hoYl.js";import{_ as W}from"./OfflineConsumer--49O5Du4.js";import{_ as Y}from"./OfflineGoods-NsfElKHP.js";import{a as C,O as X}from"./offlineGoods-DvT2Go6q.js";import{f as ee,u as te,b as se,bW as oe,bR as ae,c as re}from"./index-Wb-6_0W_.js";import"./avatarRing-DtI_kRg6.js";import"./MCOIN-BOqZVkND.js";import"./ImgBoutiqueLable-BIio6fYG.js";import"./shop-CeqcS6K2.js";const le={class:"list__item w-full rounded-xl bg-white p-3"},ne={class:"text-b3"},de=k({props:["order"],setup(e){const{t:u}=F(),v=l(null);A(()=>1/v.value);const h=async()=>{const{mcoinRate:a}=ee();v.value=await a()},w=j(),y=A(()=>[{label:u("order.wait"),value:C.PAYMENT_SUCCESS},{label:u("order.canceled"),value:C.CANCELLED},{label:u("order.completed"),value:C.COMPLETED},{label:u("common.all"),value:-1}]),m=a=>{var r;return(r=y.value.find(n=>+n.value==+a))==null?void 0:r.label},f=a=>{w.push(a)};return L(async()=>{await h()}),(a,r)=>(g(),S("div",le,[_(W,{order:e.order,"show-status":"",status:m(e.order.orderStatus)},null,8,["order","status"]),_(Y,{"show-order-type":"",class:"mt-3 h-[80px]",goods:{goodsName:e.order.relName,goodsIcons:e.order.relIcons,orderType:e.order.orderType,goodsPrice:e.order.orderRealAmount,storeName:e.order.storeName,areaExtName2:e.order.areaExtName2},onImageClick:r[0]||(r[0]=n=>e.order.orderType===D(X).GOODS?f("/offlineMerchantOrders/offlineGoodsDetail?goodsId="+e.order.relId+(e.order.storeId?`&storeId=${e.order.storeId}`:"")+"&child=1"):f("/shop?shopId="+e.order.relId))},{"bottom-left":B(()=>[t("div",ne,i(a.$t("common.total"))+"：",1)]),_:1},8,["goods"])]))}}),ce=N(de,[["__scopeId","data-v-520bf033"]]),ie=e=>(V("data-v-5e3c8ad6"),e=e(),Z(),e),ue={class:"w-full bg-[#F2F0EF]",style:{"background-image":"none"}},me={class:"header-bar sticky top-0 flex font-normal justify-center text-sm items-center h-[44px] px-2.5 z-50"},fe={class:"absolute left-2.5 flex items-center gap-1 -translate-y-1/2 top-1/2"},_e={class:"font-semibold"},ve={class:"list-content pt-2 px-4"},he={class:"total__wrap w-full flex flex-row justify-between gap-2"},pe={class:"total__item w-[50%] h-[74px] bg-white rounded-xl p-3"},xe={class:"text-xs font-normal text-default"},ge={class:"text-left mt-1"},we={class:"num-value text-2xl font-semibold text-left"},ye={class:"num-symbol text-xs font-normal text-[#a6a6a6] ml-1"},be={class:"total__item w-[50%] h-[74px] bg-white rounded-xl"},Ie={class:"total__item w-[50%] h-[74px] bg-white rounded-xl p-3"},Ce={class:"text-xs font-normal text-default"},Se={class:"text-left mt-1"},Oe={class:"num-value text-2xl font-semibold text-left"},Ee=ie(()=>t("span",{class:"num-symbol text-xs font-normal text-[#a6a6a6] ml-1"},"Mcoin",-1)),$e={class:"list__wrap mt-3 w-full h-[calc(100vh-174px)] z-50 overflow-y-auto scroll-smooth"},Te=k({setup(e){const{t:u}=F(),v=q(),{getCurrentStoreId:h}=te(),w=20,y=u("order.history_order_title"),m=l(v.query.address),f=l(`${se(m.value,"...",5,5)||""}${y}`);document.title=f.value;const a=l({}),r=l([]),n=l(!1),p=l(!1),x=l(0),b=l(null),I=l(null),R=()=>{x.value=0,r.value=[],p.value=!1},M=async()=>{var d;const s={orderCustomerAddress:m.value,shopId:(d=await h())==null?void 0:d.id},o=await oe(s);o.success&&(a.value=o.data||{})},P=async()=>{var d,c,E,$,T;const s={page:x.value,size:w,shopId:(d=await h())==null?void 0:d.id,orderStatus:4,orderCustomerAddress:m.value,startTime:b.value,endTime:I.value,sortBy:"desc|create_time"},o=await ae(s);if(n.value=!1,!o.success||!o.data||!((c=o.data)!=null&&c.total)){p.value=!0;return}r.value=x.value===1?(E=o.data)==null?void 0:E.records:[...r.value,...($=o.data)==null?void 0:$.records],p.value=r.value.length>=((T=o.data)==null?void 0:T.total)},O=async()=>{n.value=!0,x.value+=1,await P(),n.value=!1},G=s=>{s&&s[0]&&s[1]?[b.value,I.value]=s:(b.value=null,I.value=null),R(),O()};return L(()=>{M()}),(s,o)=>{const d=U("van-list");return g(),S("div",ue,[t("section",me,[t("div",fe,[_(z)]),t("div",_e,i(f.value),1)]),t("section",ve,[t("div",he,[t("div",pe,[t("p",xe,i(s.$t("order.history_order_count")),1),t("p",ge,[t("span",we,i(a.value.orderCompleteCount||0),1),t("span",ye,i(s.$t("common.order_count_suffix")),1)])]),t("div",be,[t("div",Ie,[t("p",Ce,i(s.$t("order.history_transaction_count")),1),t("p",Se,[t("span",Oe,i(D(re)(a.value.orderCompleteAmount||0)),1),Ee])])])]),_(H,{"allow-reverse":"",onChange:G}),t("div",$e,[_(d,{loading:n.value,"onUpdate:loading":o[0]||(o[0]=c=>n.value=c),finished:p.value,"finished-text":"没有更多了",onLoad:O},{default:B(()=>[(g(!0),S(J,null,K(r.value,c=>(g(),Q(ce,{key:c.id,order:c},null,8,["order"]))),128))]),_:1},8,["loading","finished"])])])])}}}),ze=N(Te,[["__scopeId","data-v-5e3c8ad6"]]);export{ze as default};
