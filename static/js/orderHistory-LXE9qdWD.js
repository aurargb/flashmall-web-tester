import{B as z}from"./BackIcon-DkqwcD_b.js";import{_ as G}from"./TimeFilter-QMfOjdZB.js";import{_ as R,y as E,r as u,x as q,l as Z,D as j,E as D,F as n,G as l,H as t,a3 as J,O as p,Q as e,P as r,I as L,J as B,a2 as F,B as C,a0 as T,w as Q,a1 as W,N as Y,Y as K,Z as X}from"./vendor-Ba70TIw4.js";import{u as tt,p as et}from"./useOrderStatus-eiwKm5Dv.js";import{b as st,e as ot}from"./useRefund-Dpqhghzq.js";import{P as at}from"./order-H59PKTFP.js";import{b as O,d as g,f as nt,u as lt,c as rt}from"./index-DGR86ePT.js";import{P}from"./flashSale-DDyqLyYN.js";import{A as it,l as dt}from"./order-DXFBu85c.js";const ct={class:"pb-0 bg-white rounded-xl"},ut={class:"flex justify-between"},mt={class:"flex-start"},ft={class:"ml-1 font-semibold text-base leading-[22px] text-[#2e2008]"},_t={class:"font-semibold text-sm leading-[20px] text-primary whitespace-nowrap"},ht={class:"flex w-full gap-2"},pt={class:"flex-1 flex flex-col min-h-[5rem] justify-between"},vt={class:"flex items-baseline justify-between w-full font-semibold"},xt={class:"w-full text-base line-clamp-2 leading-[22px] font-semibold flex flex-row justify-between items-center"},yt={class:"max-w-[140px] text-ellipsis overflow-hidden line-clamp-1"},wt={class:"flex justify-end text-sm font-normal text-[#a6a6a6]"},bt={key:0},gt={key:0},$t={key:1},St={key:1},At={key:0},It={key:1},kt=T(" ) "),Ct={class:"mt-1 text-sm min-w-fit font-normal text-[#a6a6a6]"},Tt={key:0,class:"flex justify-end opacity-60 text-[#FD5520] text-sm"},Nt=E({props:["order"],setup(s){const $=s,x=u(null);q(()=>1/x.value);const y=async()=>{const{mcoinRate:i}=nt();x.value=await i()};Z();const S=tt($.order),w=i=>{const v=new C(i.price).times(i.number).minus(i.goodsActivityReduceAmount||0).plus(i.goodsAdjustChangeAmount||0).toNumber();return g(v||0)};return j(async()=>{await y()}),(i,v)=>{const f=D("VanImage");return l(),n("div",ct,[t("div",ut,[t("div",mt,[p(f,{src:s.order.stores&&s.order.stores.logo,class:"store-logo w-[30px] h-[30px] overflow-hidden rounded-[50%]",alt:"",round:"",fit:"cover"},null,8,["src"]),t("div",ft,e(r(O)(s.order.userAddress.address,"...",5,5)),1)]),t("div",_t,e(r(S)[s.order.status+""]),1)]),(l(!0),n(L,null,B(s.order.orderGoods,o=>{var m,_;return l(),n("div",{class:"mt-2",key:o.goodsName},[t("div",ht,[p(f,{src:(o.icons||"").split(",")[0],class:"min-w-20 w-20 h-20 overflow-hidden rounded-lg",alt:o.goodsName,title:o.goodsName,fit:"cover"},null,8,["src","alt","title"]),t("div",pt,[t("div",null,[t("div",vt,[t("div",xt,[t("div",yt,e(o.goodsName),1),t("div",null,[t("div",wt,[+s.order.paySource!==r(at).USDT_WALLET?(l(),n("div",bt,[s.order.payType===r(P).STORE_CARD?(l(),n("span",gt,e(r(g)(+new r(C)(o.cardPrice).times(o.number??1)||0))+e((m=s.order.fmStoredCard)==null?void 0:m.symbol),1)):(l(),n("span",$t,e(w(o))+" Mcoin",1))])):(l(),n("div",St,[T(e(r(g)(s.order.totalUsdt))+"USDT(",1),s.order.payType===r(P).STORE_CARD?(l(),n("span",At,e(r(g)(+new r(C)(o.cardPrice).times(o.number??1)||0))+e((_=s.order.fmStoredCard)==null?void 0:_.symbol),1)):(l(),n("span",It,"("+e(w(o))+" Mcoin)",1)),kt]))])])])]),t("div",Ct,e(i.$t("order.quantity",{number:o.number||0})),1)]),r(st)(s.order)?(l(),n("div",Tt,e(r(ot)(s.order)),1)):F("",!0)])])])}),128)),J(i.$slots,"default",{},void 0,!0)])}}}),Pt=R(Nt,[["__scopeId","data-v-4ce1d0da"]]),Rt=s=>(K("data-v-7931f4d3"),s=s(),X(),s),Et={class:"w-full bg-[#F2F0EF]",style:{"background-image":"none"}},jt={class:"header-bar sticky top-0 flex font-normal justify-center text-sm items-center h-[44px] px-2.5 z-50"},Dt={class:"absolute left-2.5 flex items-center gap-1 -translate-y-1/2 top-1/2"},Lt={class:"font-semibold"},Bt={class:"list-content pt-2 px-4"},Ft={class:"total__wrap w-full flex flex-row justify-between gap-2"},Ot={class:"total__item w-[50%] h-[74px] bg-white rounded-xl p-3"},Mt={class:"text-xs font-normal text-default"},Ut={class:"text-left mt-1"},Vt={class:"num-value text-2xl font-semibold text-left"},Ht={class:"num-symbol text-xs font-normal text-[#a6a6a6] ml-1"},zt={class:"total__item w-[50%] h-[74px] bg-white rounded-xl"},Gt={class:"total__item w-[50%] h-[74px] bg-white rounded-xl p-3"},qt={class:"text-xs font-normal text-default"},Zt={class:"text-left mt-1"},Jt={class:"num-value text-2xl font-semibold text-left"},Qt=Rt(()=>t("span",{class:"num-symbol text-xs font-normal text-[#a6a6a6] ml-1"},"Mcoin",-1)),Wt={class:"list__wrap mt-3 w-full h-[calc(100vh-174px)] z-50 overflow-y-auto scroll-smooth"},Yt={class:"bottom__wrap mt-2 w-full flex flex-row justify-between items-center"},Kt={class:"text-sm font-normal text-[#a6a6a6]"},Xt={class:"text-newOrigin text-sm font-normal"},te={key:0},ee={key:0},se={key:1},oe=T(" Mcoin "),ae=E({setup(s){const{t:$}=Q(),x=W(),{getCurrentStoreId:y}=lt(),S=20,w=$("order.history_order_title"),i=u(x.query.address),v=u(`${O(i.value,"...",5,5)||""}${w}`);document.title=v.value;const f=u({orderAmount:0,orderCount:0}),o=u([]),m=u(!1),_=u(!1),b=u(0),A=u(null),I=u(null),M=()=>{b.value=0,o.value=[],_.value=!1},U=async()=>{var h,d,k;const c={status:4,type:1,historyAddress:i.value,storeId:(h=await y())==null?void 0:h.id},a=await it(c);a.success&&(f.value={orderAmount:((d=a==null?void 0:a.data)==null?void 0:d.orderAmount)||0,orderCount:((k=a==null?void 0:a.data)==null?void 0:k.orderCount)||0})},V=async()=>{var h;const c={page:b.value,size:S,type:1,status:4,historyAddress:i.value,storeId:(h=await y())==null?void 0:h.id,createStartTime:A.value,createEndTime:I.value},a=await dt(c);if(m.value=!1,!a.success||!a.data||!a.total){_.value=!0;return}o.value=b.value===1?a.data:[...o.value,...a.data],_.value=o.value.length>=a.total},N=async()=>{m.value=!0,b.value+=1,await V(),m.value=!1},H=c=>{c&&c[0]&&c[1]?[A.value,I.value]=c:(A.value=null,I.value=null),M(),N()};return j(()=>{U()}),(c,a)=>{const h=D("van-list");return l(),n("div",Et,[t("section",jt,[t("div",Dt,[p(z)]),t("div",Lt,e(v.value),1)]),t("section",Bt,[t("div",Ft,[t("div",Ot,[t("p",Mt,e(c.$t("order.history_order_count")),1),t("p",Ut,[t("span",Vt,e(f.value.orderCount),1),t("span",Ht,e(c.$t("common.order_count_suffix")),1)])]),t("div",zt,[t("div",Gt,[t("p",qt,e(c.$t("order.history_transaction_count")),1),t("p",Zt,[t("span",Jt,e(r(rt)(f.value.orderAmount)),1),Qt])])])]),p(G,{"allow-reverse":"",onChange:H}),t("div",Wt,[p(h,{loading:m.value,"onUpdate:loading":a[0]||(a[0]=d=>m.value=d),finished:_.value,"finished-text":"没有更多了",onLoad:N},{default:Y(()=>[(l(!0),n(L,null,B(o.value,(d,k)=>(l(),n("div",{key:d.id,class:"list__item w-full min-h-[132px] rounded-xl bg-white p-3"},[p(Pt,{order:d},null,8,["order"]),t("div",Yt,[t("p",Kt,e(r(et)(+d.paySource)),1),t("p",Xt,[d.totalUsdt?(l(),n("span",te,[t("span",null,e(d.totalUsdt)+"USDT",1),d.totalAmount?(l(),n("span",ee,"("+e(d.totalAmount)+" Mcoin)",1)):F("",!0)])):(l(),n("span",se,[t("span",null,e(d.totalAmount),1),oe]))])])]))),128))]),_:1},8,["loading","finished"])])])])}}}),_e=R(ae,[["__scopeId","data-v-7931f4d3"]]);export{_e as default};
