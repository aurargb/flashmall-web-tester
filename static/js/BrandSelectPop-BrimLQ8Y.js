import{_ as J,y as G,w as Q,be as K,r as y,D as j,E as p,K as V,G as g,N as u,H as e,O as f,a2 as N,a4 as L,bG as W,P as c,bF as Y,Q as _,a0 as Z,T as U,bs as X,Y as ee,Z as te,bf as T,z as se,F as O,bz as oe,J as ae,R as ne,I as le,n as ie}from"./vendor-Ba70TIw4.js";import{_ as re}from"./search-C4fLtTfY.js";import{_ as de}from"./checked-C8-rw1H8.js";import{W as R,a8 as ce,a9 as ue,a3 as me,q as pe,aU as ve,aT as xe}from"./index-DiRx6UeW.js";import{i as fe}from"./offlineGoods-DvT2Go6q.js";import{u as ge}from"./upload-JfLMTiM0.js";const _e=""+new URL("../images/deleteImg-D8x_oyov.svg",import.meta.url).href,I=h=>(ee("data-v-331bd1f8"),h=h(),te(),h),he={class:"w-full p-4 bg-b6 rounded-[10px] overflow-hidden font-Puhui"},be=I(()=>e("header",{class:"text-center felx-1 relative mx-1"},[e("div",{class:"text-base font-bold"},"添加品牌")],-1)),we={class:"title"},ye={class:"border-b4 border-b border-solid"},Be=I(()=>e("div",{class:"text-sm text-[#2E2008] font-semibold"},_("品牌名称"),-1)),Ce={class:"flex justify-between items-center py-4 border-b4 border-b border-solid"},ke=I(()=>e("div",{class:"text-sm text-[#2E2008] font-semibold"},_("品牌LOGO"),-1)),Fe={class:"van-uploader__wrapper gap-3"},Ve=["onClick"],Ie={class:"van-image van-uploader__preview-image",style:{width:"60px",height:"60px","border-radius":"6px"}},$e=["src"],Ne=["onClick"],Le=I(()=>e("img",{class:"w-[15px] h-[15px]",src:_e,alt:""},null,-1)),Se=[Le],De={class:"w-[60px] h-[60px] bg-b5 rounded-xl text-center flex flex-col justify-center items-center text-[#d9d9d9]"},Ae=["src"],Pe={class:"text-xs font-light text-center text-b1 opacity-30"},Ee={class:"py-4"},ze=I(()=>e("div",{class:"text-sm text-[#2E2008] font-semibold"},_("品牌描述"),-1)),Ue={class:"flex items-center gap-x-3"},Oe=Z(" 确认添加 "),Te=G({emits:["close","success"],setup(h,{emit:b}){const{t:w}=Q(),[S,B]=K(!1),D=y(!0),o=y({storeBrandName:null,storeBrandIcon:null,storeBrandDesc:null}),l=y([]),x=y(1),A=async i=>{if(l.value.length>=x.value)return;const a=ce(i.file);if(!a.valid)return m(a.tips);const v=ue(i.file);if(!v.valid)return m(v.tips);U.loading({message:w("common.uploading"),forbidClick:!0,duration:0});const t=await me(i,"goodsDesc"),s=await ge(t);if(U.clear(),!s.success)return m("图片上传失败");l.value.push({id:z(),url:pe.imgUrl+s.data})},P=i=>{l.value.splice(i,1)},E=i=>{X({images:l.value.map(a=>a.url),startPosition:i})},z=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(i){var a=Math.random()*16|0,v=i==="x"?a:a&3|8;return v.toString(16)}),m=(i="",a="toast-warn.svg")=>{U({message:i,icon:R(a),duration:2e3,overlay:!0,overlayClass:"toastOverlay",className:"toastCard",type:"html"})},k=async()=>{if(!o.value.storeBrandName)return m("请输入品牌名称");if(!l.value.length)return m("请上传品牌主图");B(!0);const i=l.value.map(t=>t.url);o.value.storeBrandIcon=i.join(",");const{success:a,data:v}=await ve(o.value);B(!1),a&&(m("添加成功","toast-success.svg"),setTimeout(()=>{b("success",{...o.value,id:null})},2e3))};return j(()=>{}),(i,a)=>{const v=p("van-field"),t=p("van-uploader"),s=p("VanButton"),d=p("VanPopup");return g(),V(d,{teleport:"body",show:D.value,position:"bottom",round:"","close-on-click-overlay":!1,onClickOverlay:a[3]||(a[3]=r=>i.$emit("close")),"overlay-class":"categoryOverlay",class:"sm:w-[375px] sm:left-[50%] sm:translate-x-[-50%]",style:{"min-height":"30%","border-radius":"16px 16px 0 0"}},{default:u(()=>[e("div",he,[be,e("div",we,[e("div",ye,[f(v,{"input-align":"right",maxlength:12,modelValue:o.value.storeBrandName,"onUpdate:modelValue":a[0]||(a[0]=r=>o.value.storeBrandName=r),placeholder:"请输入品牌名称",class:"no-bt"},{label:u(()=>[Be]),_:1},8,["modelValue"])]),e("div",Ce,[ke,e("div",Fe,[f(c(Y),W({class:"flex flex-wrap gap-3",modelValue:l.value,"onUpdate:modelValue":a[1]||(a[1]=r=>l.value=r),"item-key":"id"},{animation:200,group:"description",disabled:!1,ghostClass:"ghost"}),{item:u(({element:r,index:C})=>[e("div",{class:"van-uploader__preview",onClick:L(F=>E(C),["stop"])},[e("div",Ie,[e("img",{src:r.url,class:"van-image__img rounded-md",style:{"object-fit":"cover"}},null,8,$e)]),e("div",{class:"absolute top-[4.25px] right-[4px] z-[9]",onClick:L(F=>P(C),["stop"]),tabindex:"0"},Se,8,Ne)],8,Ve)]),_:1},16,["modelValue"]),l.value.length<x.value?(g(),V(t,{key:0,accept:c(fe),afterRead:A},{default:u(()=>[e("div",De,[e("img",{src:c(R)("image-default.svg"),class:"w-6 mx-auto",alt:""},null,8,Ae),e("div",Pe,_(i.$t("common.add img")),1)])]),_:1},8,["accept"])):N("",!0)])]),e("div",Ee,[ze,f(v,{modelValue:o.value.storeBrandDesc,"onUpdate:modelValue":a[2]||(a[2]=r=>o.value.storeBrandDesc=r),rows:"2",autosize:"",type:"textarea",placeholder:"请输入品牌描述",class:"no-bt",style:{"padding-top":"8px !important","padding-bottom":"0 !important"},maxlength:"150","show-word-limit":""},null,8,["modelValue"])])]),e("div",Ue,[f(s,{class:"submit-btn flex-1 bg-yellow text-b1 text-base font-semibold border-none h-[46px]",round:"",onClick:k,loading:c(S)},{default:u(()=>[Oe]),_:1},8,["loading"])])])]),_:1},8,["show"])}}}),Re=J(Te,[["__scopeId","data-v-331bd1f8"]]),Ge={class:"w-full py-4 p-3 bg-b6 rounded-[10px] overflow-hidden font-Puhui"},Ke={class:"text-center felx-1 relative mx-1"},je=["onClick"],Me={class:"text-base font-bold"},qe={class:"absolute right-0 top-0 pl-2"},He={key:0,class:"flex-1 bg-b5 rounded-3xl mx-1 mt-4 mb-2"},Je=e("div",null,[e("img",{src:re,class:"w-4 h-4"})],-1),Qe={class:"flex-1 flex items-center gap-1 text-sm"},We={class:"flex-1"},Ye={class:"text-b3 line-clamp-1"},Ze={key:0,class:"w-4 h-4",src:de,alt:""},nt=G({props:{id:null,name:null,level:null},emits:["close","select","confirm","add"],setup(h,{emit:b}){const w=h,[S,B]=K(!1),D=y(!0),o=T({total:0,loading:!1,finished:!1,list:[]}),l=T({page:0,size:100,storeBrandNameLike:void 0,showNotHaveStoresFlag:!0}),x=y([]),A=y(null),P=t=>{x.value=[t.storeBrandId],E()},E=()=>{var s;const t=(s=o.list||[])==null?void 0:s.find(d=>d.storeBrandId===x.value[0]);b("select",t==null?void 0:t.storeBrandId,t==null?void 0:t.storeBrandName),b("confirm",t),b("close")},z=t=>{const s=document.getElementById(t);s&&s.scrollIntoView({behavior:"smooth"})};se(()=>w.id,async t=>{t&&(await ie(),z(t))},{immediate:!0,deep:!0});const m=()=>{o.finished=!1,o.list=[],l.page=0,k()},k=async()=>{o.loading=!0,l.page+=1,await i(),o.loading=!1},i=async()=>{const{success:t,data:s}=await xe(l);if(!t){o.finished=!0;return}const{records:d,total:r,current:C,pages:F}=s;if(!r||!d||!(d!=null&&d.length)){o.finished=!0;return}o.total=r,o.list=l.page===1?d:o.list.concat(d),+C>=+F&&(o.finished=!0)},a=()=>{B(!0)},v=t=>{l.storeBrandNameLike=t.storeBrandName,m(),B(!1),b("add",t)};return j(()=>{w.id&&w.name&&(x.value=[w.id],l.storeBrandNameLike=w.name),k()}),(t,s)=>{const d=p("van-icon"),r=p("VanField"),C=p("VanImage"),F=p("van-checkbox"),M=p("van-checkbox-group"),q=p("VanList"),H=p("VanPopup");return g(),V(H,{teleport:"body",show:D.value,position:"bottom",round:"","close-on-click-overlay":!1,onClickOverlay:s[5]||(s[5]=n=>t.$emit("close")),"overlay-class":"categoryOverlay",class:"sm:w-[375px] sm:left-[50%] sm:translate-x-[-50%]",style:{"min-height":"50%","border-radius":"16px 16px 0 0"}},{default:u(()=>[e("div",Ge,[e("header",Ke,[e("div",{class:"absolute left-0 top-0 pr-2 text-sm text-newOrigin",onClick:L(a,["stop"])}," 添加品牌 ",8,je),e("div",Me,_(t.$t("offline.select_store_brand")),1),e("div",qe,[f(d,{name:"cross",size:"20",onClick:s[0]||(s[0]=L(()=>{b("close")},["stop"]))})])]),h.level?N("",!0):(g(),O("div",He,[f(r,{modelValue:c(l).storeBrandNameLike,"onUpdate:modelValue":s[1]||(s[1]=n=>c(l).storeBrandNameLike=n),placeholder:t.$t("offline.input_store_name"),class:"w-[100%-20px] text-center bg-transparent items-center",clearable:"",onClear:m,onKeyup:oe(m,["enter"])},{"left-icon":u(()=>[Je]),"right-icon":u(()=>[e("div",{class:"text-newOrigin pl-1 ml-2",onClick:m},_(t.$t("common.search")),1)]),_:1},8,["modelValue","placeholder","onKeyup"])])),f(q,{loading:c(o).loading,"onUpdate:loading":s[3]||(s[3]=n=>c(o).loading=n),finished:c(o).finished,"immediate-check":!1,"loading-text":t.$t("common.loading"),onLoad:k,class:"shopList mx-1 overflow-y-auto h-[calc(100vh-200px)]"},{default:u(()=>[f(M,{modelValue:x.value,"onUpdate:modelValue":s[2]||(s[2]=n=>x.value=n),ref:(n,$)=>{$.checkboxGroup=n,A.value=n},max:1},{default:u(()=>[(g(!0),O(le,null,ae(c(o).list,n=>(g(),V(F,{key:n.storeBrandId,name:n.storeBrandId,id:n.storeBrandId,"label-position":"left",class:"flex flex-1 justify-between py-4 border-b border-b-b4 last:border-none",onClick:$=>P(n)},{icon:u($=>[$.checked?(g(),O("img",Ze)):N("",!0)]),default:u(()=>[e("div",Qe,[f(C,{src:((n==null?void 0:n.storeBrandIcon)||"").split(",")[0],radius:"4px",width:"32px",height:"32px",fit:"cover"},null,8,["src"]),e("div",We,[e("div",{class:ne([{"text-newOrigin font-semibold":x.value.includes(n.storeBrandId)},"line-clamp-1"])},_(n.storeBrandName),3),e("div",Ye,_(n.storeBrandDesc),1)])])]),_:2},1032,["name","id","onClick"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["loading","finished","loading-text"])]),c(S)?(g(),V(Re,{key:0,onSuccess:v,onClose:s[4]||(s[4]=n=>c(B)(!1))})):N("",!0)]),_:1},8,["show"])}}});export{nt as _,_e as a};
