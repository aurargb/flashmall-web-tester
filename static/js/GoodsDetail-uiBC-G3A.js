import{_ as ue,a as re,G as pe,S as me,b as ve,c as ge,d as he,e as ye}from"./ShareGoodPopup-C5GKG8BY.js";import{y as O,bf as fe,x as k,z as _e,F as m,G as a,P as l,I as V,H as s,Q as d,a1 as Y,J as Te,K as _,bs as we,_ as j,X as p,Z,$ as J,be as M,r,w as $e,a2 as be,l as xe,bj as ke,by as Ie,D as Re,E as Se,O as x,R as Ce,N as U,T as A}from"./vendor-BlU_hoYl.js";import{b as Ge,G as Fe,_ as De}from"./GivePointsLable-_0scRjnA.js";import{k as Le}from"./order-pJoL_MtT.js";import{F as S}from"./enums-DlE-aiss.js";import{d as Be,f as Pe,a7 as Ae,r as Oe,_ as je,a8 as Ne,W as Ee}from"./index-Wb-6_0W_.js";import{P as qe}from"./flashSale-DDyqLyYN.js";import{D as ze}from"./goods-BVwS8oFG.js";import{R as He}from"./RemovedShelves-j33id_1b.js";import{q as Ve}from"./goods-WNmbNX2m.js";import"./avatarRing-DtI_kRg6.js";import"./shop-arrow-right-BueA_z4m.js";import"./BoutiqueLabelInLogo-BBB_wfVh.js";import"./shop-CeqcS6K2.js";import"./RatioBox-X84r5IHu.js";import"./kefu-B-s0jZtS.js";import"./convertToImage-onRGZMbC.js";import"./browser-DFlSdkZC.js";import"./upload-fNWojfp2.js";import"./active_empty-ofPcrP74.js";import"./HelpPop-BzOtLm9j.js";import"./MCOIN-BOqZVkND.js";import"./logo-JjZ15zkW.js";import"./BackIcon-8hcEjDKb.js";const Me={class:"relative mb-3 w-full flex justify-between items-center"},Ue={class:"text-base font-semibold text-b1 text-left"},Ye={class:"text-xs text-b3 font-normal flex justify-center items-center"},Ze=s("img",{src:re,class:"w-3 h-3",alt:""},null,-1),Je={key:1,class:"text-base font-semibold text-b1 text-left"},Ke=O({props:{goodsId:null},emits:["handleTo"],setup(e,{emit:v}){const T=e,i=fe({commentList:[],total:0}),w=k(()=>Number(i.total)>100?100:i.total),h=async()=>{const n=await Le({goodsId:T.goodsId,page:1,size:1});n.success&&(i.commentList=n.data,i.total=n.total)},y=k(()=>{if(i.commentList&&i.commentList.length>0){const n=[];for(let c=0;c<i.commentList.length;c++)i.commentList[c].commentImages&&i.commentList[c].commentImages.length>0&&n.push(...i.commentList[c].commentImages.split(","));return n}return[]}),G=n=>{const c=y.value.findIndex(g=>g===n);we({images:y.value,closeable:!0,showIndex:!0,startPosition:c})};return _e(()=>T.goodsId,n=>{h()},{immediate:!0}),(n,c)=>(a(),m("div",{class:"px-4 py-3 mt-2 bg-white text-base",onClick:c[0]||(c[0]=g=>v("handleTo",`/evaluate-good?goodsId=${e.goodsId}`))},[l(i).commentList.length>0?(a(),m(V,{key:0},[s("div",Me,[s("div",Ue,d(n.$t("evaluate.Buyer Reviews"))+"（"+d(l(w))+"） ",1),s("div",Ye,[Y(d(n.$t("common.all"))+" ",1),Ze])]),(a(!0),m(V,null,Te(l(i).commentList,(g,t)=>(a(),_(ue,{onImgPre:G,key:g.id,data:g},null,8,["data"]))),128))],64)):(a(),m("div",Je,d(n.$t("evaluate.Buyer Reviews none")),1))]))}}),Qe="/static/images/wyhlg-lNCG0Riy.svg",We="/static/images/g-d-flash-bg-D1sma3Dd.svg",Xe="/static/images/g-d-flash-f-C4Zpe-zO.svg",et={class:"tag text-xs flex justify-start items-center text-[#F25C11]"},tt={key:0},st={key:1},ot={key:2},at={key:3},it={props:{shippingTemplate:{type:Object,default:()=>{}}},setup(e){return(v,T)=>(a(),m("div",et,[s("span",null,[e.shippingTemplate.type===l(S).FREE&&e.shippingTemplate.threshold?(a(),m("span",tt,d(v.$t("shop.shippingTemplate.actualPayment"))+d(l(Be)(e.shippingTemplate.threshold))+"MC"+d(v.$t("shop.shippingTemplate.freeShipping")),1)):p("",!0),e.shippingTemplate.type===l(S).FREE&&e.shippingTemplate.threshold===0?(a(),m("span",st,d(v.$t("shop.shippingTemplate.freeShipping")),1)):p("",!0),e.shippingTemplate.type===l(S).NO_SHIPPING?(a(),m("span",ot,d(v.$t("shop.shippingTemplate.noShipping")),1)):p("",!0),e.shippingTemplate.type===l(S).CASH_ON_DELIVERY?(a(),m("span",at,d(v.$t("shop.shippingTemplate.cashOnDelivery")),1)):p("",!0)])]))}},lt=j(it,[["__scopeId","data-v-c8264250"]]),C=e=>(Z("data-v-807a4676"),e=e(),J(),e),nt={class:"act__wrap flex items-center justify-between p-3 pr-2.5"},ct={class:"left-box z-10"},dt={class:"act-price font-sans text-b6 text-[26px] font-normal"},ut={class:"leading-[26px] font-BebasNeue"},rt=C(()=>s("span",{class:"text-[12px] ml-1"},"MC",-1)),pt={class:"mt-1 flex flex-row justify-start items-center gap-1"},mt={key:1,class:"tag"},vt={key:2},gt={class:"right-box z-10"},ht=C(()=>s("div",{class:"happy-buying"},[s("img",{src:Qe,alt:"五一欢乐购"})],-1)),yt={class:"text-right mt-[2px] text-[#B27936] text-xs font-normal"},ft=C(()=>s("img",{class:"flash-item-2",src:We},null,-1)),_t=C(()=>s("img",{class:"flash-item-1",src:Xe,alt:""},null,-1)),Tt={props:{goods:{type:Object,default:()=>{}},activity:{type:Object,default:()=>{}},activityGoods:{type:Object,default:()=>{}},activityRule:{type:Object,default:()=>{}},shippingTemplate:{type:Object,default:()=>{}}},setup(e){const v=e,T=k(()=>{var y;if(!((y=v.activity)!=null&&y.endTime))return 0;const i=new Date(v.activity.endTime).getTime(),w=new Date().getTime(),h=(i-w)/(1e3*60*60*24);return h<=0?0:h<1?1:Math.ceil(h)});return(i,w)=>(a(),m("div",nt,[s("div",ct,[s("div",dt,[s("span",ut,d(e.activityGoods.activityPrice),1),rt]),s("div",pt,[e.shippingTemplate.id?(a(),_(lt,{key:0,shippingTemplate:e.shippingTemplate},null,8,["shippingTemplate"])):p("",!0),e.activityRule&&e.activityRule.fullAmount?(a(),m("div",mt,d(i.$t("active.man")+e.activityRule.fullAmount||0)+"-"+d(e.activityRule.reduceAmouint||e.activityRule.reduceAmount||0),1)):p("",!0),e.goods.deliveryType===l(ze).online?(a(),m("div",vt,[e.goods.payType!==l(qe).STORE_CARD?(a(),_(Ge,{key:0,class:"points-tag",showType:"balance",goods:e.goods,activityGoods:e.activityGoods},null,8,["goods","activityGoods"])):p("",!0)])):p("",!0)])]),s("div",gt,[ht,s("div",yt,[s("span",null,d(i.$t("active.last")),1),s("span",null,d(l(T)+i.$t("common.day")),1)])]),ft,_t]))}},wt=j(Tt,[["__scopeId","data-v-807a4676"]]),K=e=>(Z("data-v-2efa73b2"),e=e(),J(),e),$t={class:"relative w-full h-full !bg-[#F6F6F5] font-Puhui detail__wrap"},bt={key:0},xt=K(()=>s("img",{class:"w-8 h-8",src:he},null,-1)),kt=[xt],It=K(()=>s("img",{class:"w-8 h-8",src:ye},null,-1)),Rt=[It],St={class:"pb-[calc(76px+8px-12px)] -translate-y-3 bg-[#F6F6F5]"},Ct={class:"text-center text-black/80"},Gt={class:"p-3 text-base"},Ft=O({name:"GoodsDetail"});function Dt(e){const{mcoinRate:v}=Pe(),[T,i]=M(!1),w=r(!1),{loadingToggle:h}=Oe(),{t:y}=$e(),G=Ae(),n=be(),c=xe(),g=k(()=>document.getElementById("fm-page")),t=r(null),f=r(null),F=r(null),D=r(null),N=r(null),Q=r([]),L=r({}),W=r(),E=r(null),X=r(n.query.id),ee=async()=>{const u=X.value;if(u==null||u==="")return;const o=await Ve(u);W.value=o.data.categoryName,t.value=o.data.goods,w.value=o.data.isFollow,f.value=o.data.stores,Q.value=o.data.goodsList,E.value=o.data.fmStoredCard,L.value=o.data.fmShippingTemplate||{},F.value=o.data.fmGeneralActivity||null,D.value=o.data.fmGeneralActivityGoods||null,N.value=o.data.fmGeneralActivityRule||null},q=r(null),te=async()=>{q.value=await v()},se=k(()=>1/q.value),b=r(null),oe=u=>{const o=u===void 0?`/submitOrder?id=${t.value.id}`:`/submitOrder?id=${t.value.id}&${u}`;c.push(o)},[ae,z]=M(!1),ie=async()=>{if(t.value.stock===0&&t.value.goodsTypes!==2){A(y("order.Insufficient stock"));return}const u={needlogin:"true",...n.query};c.replace({path:n.path,query:u}),h(!0);const o=await Ne(t.value.id);h(!1),o.success&&(A(y("cart.addTips")),G.getCartCount())},B=u=>{c.push(u)},le=()=>{A({message:y("common.Saved successfully"),icon:Ee("toast-success.svg"),duration:3e3})},ne=()=>{try{window.history.state.back?c.back():window.history.length>2?window.history.back():c.replace({path:"/mall"})}catch{c.push("/")}},H=r(0);let I=r(!0);const P=Ie(()=>{H.value=g.value.scrollY||g.value.scrollTop,H.value<100?(I.value=!1,b.value&&b.value.resumeSwiper()):(I.value=!0,b.value&&b.value.pauseSwiper())},100),ce=()=>{g.value&&g.value.addEventListener("scroll",P),P()};return ke(()=>{g.value&&g.value.removeEventListener("scroll",P)}),Re(async()=>{ce(),h(!0),await te(),await ee(),h(!1)}),(u,o)=>{const de=Se("VanButton");return a(),m("div",$t,[t.value&&t.value.status===1&&f.value.status!==3&&f.value.status!==4&&f.value.status!==0?(a(),m("div",bt,[s("header",{class:Ce(["flex items-center sm:w-[375px] w-full justify-between top-0 z-50 h-[50px] px-3 py-[9px] fixed transition-all duration-200",{"bg-white":l(I)," bg-black/0":!l(I)}])},[s("div",{class:"flex flex-wrap items-center",onClick:ne},kt),s("div",{onClick:o[0]||(o[0]=$=>l(i)(!0))},Rt)],2),x(Fe,{ref:($,R)=>{R.goodsImgRef=$,b.value=$},imgs:(t.value.icons||"").split(","),stock:t.value.stock,goodsTypes:t.value.goodsTypes},null,8,["imgs","stock","goodsTypes"]),F.value&&D.value.activityStock>0?(a(),_(wt,{key:0,goods:t.value,activityRule:N.value,activity:F.value,activityGoods:D.value,shippingTemplate:L.value,class:"mt-[-6px] z-10"},null,8,["goods","activityRule","activity","activityGoods","shippingTemplate"])):p("",!0),x(pe,{tokenRate:l(se),shop:f.value,goods:t.value,discountRatio:t.value.discountRatio,card:E.value,shippingTemplate:L.value,class:"relative z-10"},null,8,["tokenRate","shop","goods","discountRatio","card","shippingTemplate"]),s("div",St,[x(Ke,{onHandleTo:B,goodsId:t.value.id},null,8,["goodsId"]),f.value.id?(a(),_(me,{key:0,shop:f.value,onHandleTo:B},null,8,["shop"])):p("",!0),t.value.goodsDesc||t.value.goodsPic?(a(),_(De,{key:1,text:t.value.goodsDesc,imgs:t.value.goodsPic?t.value.goodsPic.split(","):[]},null,8,["text","imgs"])):p("",!0)]),t.value.id?(a(),_(ve,{key:1,goods:t.value,goodsId:t.value.id,payType:t.value.payType||1,boutiqueFlag:t.value.boutiqueFlag||!1,isFollow:w.value,deliveryType:t.value.deliveryType,shop:f.value,stock:t.value.stock,goodsTypes:t.value.goodsTypes,onHandleBuy:oe,onHandleConnect:o[1]||(o[1]=$=>{var R;return B(`/shopInfo?address=${(R=f.value)==null?void 0:R.merchant}`)}),onHandleAddCart:ie},null,8,["goods","goodsId","payType","boutiqueFlag","isFollow","deliveryType","shop","stock","goodsTypes"])):p("",!0)])):t.value?(a(),_(He,{key:1,type:"good"})):p("",!0),l(T)?(a(),_(ge,{key:2,show:l(T),onOnSuceess:le,onClose:o[2]||(o[2]=$=>l(i)(!1)),goods:t.value},null,8,["show","goods"])):p("",!0),x(je,{show:l(ae),name:u.$t("common.tip"),onClose:o[4]||(o[4]=$=>l(z)(!1))},{default:U(()=>[s("div",Ct,[s("div",Gt,d(u.$t("goods.addcartip")),1),x(de,{class:"btn-orange text-white min-w-[120px] h-[40px]",onClick:o[3]||(o[3]=$=>l(z)(!1))},{default:U(()=>[Y(d(u.$t("common.I_see")),1)]),_:1})])]),_:1},8,["show","name"])])}}const Lt=O({...Ft,setup:Dt}),as=j(Lt,[["__scopeId","data-v-2efa73b2"]]);export{as as default};
