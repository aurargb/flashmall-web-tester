import{_ as v,y as b,r as f,D as x,a9 as _,F,G as D,O as i,E as B,P as t,N as T,a2 as A,H as s,Q as a,a4 as m}from"./vendor-BlU_hoYl.js";import{e as L,C as r}from"./index-UgIL2Smv.js";import{u as M}from"./useCityMap-CU72MCNW.js";const N={class:"router-view-container"},j={class:"-mb-6 font-Puhui"},k={class:"mb-6 text-sm font-semibold text-b1"},R={class:"flex flex-col items-center gap-3"},$=["onClick"],G={class:"text-base font-semibold text-b1"},P={class:"text-base font-normal text-b1"},S=b({setup(V){const p=A(),{cityMapStore:e}=L(),{getUserLocation:C}=M(),w=()=>{e.setCurrentCity(e.cityChangeTips.gpsCity,"manual"),e.hideCityChangeTips()},l=f(!1),E=f(""),c=async()=>{try{l.value=!0,E.value="",await C()}catch{}finally{l.value=!1}},u=async()=>{if(p.path.indexOf("/city/")===-1){window.removeEventListener("visibilitychange",u);return}document.hidden?console.log("cityMap hidden"):(console.log("cityMap show"),await c())};return x(async()=>{await c(),window.addEventListener("visibilitychange",u)}),_(()=>{window.removeEventListener("visibilitychange",u)}),(y,o)=>{const g=B("router-view");return D(),F("div",N,[i(g),i(r,{show:t(e).locationError.show,title:"位置获取失败",content:t(e).locationError.message,showConfirm:!0,showReject:!1,confirmText:"我知道了",noClose:"",onConfirm:o[0]||(o[0]=n=>t(e).hideLocationError())},null,8,["show","content"]),i(r,{show:t(e).noAuthError.show,title:"开启定位，发现身边好店",content:"需开启应用的位置权限允许获取您的当前地理位置",showConfirm:!0,showReject:!1,confirmText:"我知道了",noClose:"",onConfirm:o[1]||(o[1]=n=>t(e).hideNoAuthError())},null,8,["show"]),i(r,{show:t(e).msgError.show,title:t(e).msgError.title,content:t(e).msgError.message,showConfirm:!0,showReject:!1,confirmText:"我知道了",noClose:"",onConfirm:o[2]||(o[2]=n=>t(e).hideMsgError())},null,8,["show","title","content"]),i(r,{show:t(e).cityChangeTips.show,showConfirm:!1,showReject:!1,noClose:"",noHeader:""},{default:T(()=>{var n,d,h;return[s("div",j,[s("div",k," 定位显示您在"+a((n=t(e).cityChangeTips.gpsCity)==null?void 0:n.areaName),1),s("div",R,[s("div",{class:"w-full h-[44px] rounded-full bg-[#FED73A] border border-solid border-transparent flex justify-center items-center",onClick:m(w,["stop"])},[s("span",G," 切换到"+a((d=t(e).cityChangeTips.gpsCity)==null?void 0:d.areaName),1)],8,$),s("div",{class:"w-full h-[44px] rounded-full bg-[#fff] border border-solid border-b4 flex justify-center items-center",onClick:o[3]||(o[3]=m(H=>t(e).hideCityChangeTips(),["stop"]))},[s("span",P," 继续浏览"+a((h=t(e).cityChangeTips.saveCity)==null?void 0:h.areaName),1)])])])]}),_:1},8,["show"])])}}}),Q=v(S,[["__scopeId","data-v-c151a758"]]);export{Q as default};
