import{y as G,F as n,G as l,a2 as R,H as t,P as w,Q as _,r as d,D as ee,E as q,bt as ne,bc as H,K as N,O as b,I as V,J as U,a4 as ie,_ as te,N as E,Y as se,Z as ae,w as le,x as j,R as K,a0 as ce,l as re,bx as X,bf as ue,X as de,bd as Y}from"./vendor-Ba70TIw4.js";import{a as ve,_ as he}from"./GoodsList-KFQaczxr.js";import{_ as me}from"./MCOIN-Bodfn-v1.js";import{_ as fe}from"./ImgBoutiqueLable-BMjuak4g.js";import{g as O,e as pe}from"./index-Bsb9uxb4.js";import{R as ge}from"./RatioBox-Q-7JJrFz.js";import{M as ye,_ as xe}from"./MetaKeyTag-DSSf9cM_.js";import{R as Q}from"./rangking-soiwLY3n.js";import{c as J}from"./mall-BukQeouS.js";const we=""+new URL("../images/shop-more-CVTCr4GK.png",import.meta.url).href,ke=""+new URL("../images/good-hot-DcLXI72v.png",import.meta.url).href,_e=""+new URL("../images/card-DHSisX3c.png",import.meta.url).href,be={key:0,class:"flex items-center justify-center"},Te=["src"],$e={class:"bg-[#FFF1D6] rounded-2xl text-xxs font-bold py-0.5 px-2 pl-3.5"},Se=G({props:{rankNum:null,type:{default:Q.SR}},setup(e){return(g,h)=>(l(),n("div",null,[+e.rankNum>0?(l(),n("div",be,[t("img",{src:w(O)(`images/shop/rank${e.rankNum>3?4:e.rankNum}.png`),class:"inline-block w-[14px] h-[16px] -mr-2 z-10"},null,8,Te),t("div",$e,_(e.type===w(Q).EBR?g.$t("ranking.ecology boost",{num:e.rankNum}):g.$t("ranking.recently hot sales",{num:e.rankNum})),1)])):R("",!0)]))}}),Pe={class:"relative"},Re={class:"flex items-start w-full"},Ce={class:"relative w-[85px] h-[85px] flex-shrink-0 bg-black-100 overflow-hidden rounded-lg"},Ie={class:"object-cover w-full h-full aspect-square",fit:"cover"},Le={class:"flex flex-col items-start justify-between w-[calc(100%-85px-1rem)] ml-4 text-sm"},Fe={class:"flex items-center w-full text-sm font-semibold text-black-900"},Ae={class:"mr-2 truncate"},Be={class:"flex-shrink-0 ml-auto"},Ne={class:"flex w-full mt-1 text-xs text-primary"},Ve={class:"self-start mr-3 flex-center text-black-400"},ze={class:"ml-1"},De={class:"mt-2.5 min-h-[17px] flex items-center gap-2"},Ge={key:0,class:"flex flex-col gap-2.5 mt-3 w-full"},Me=["onClick"],qe=t("img",{src:ke,class:"flex-shrink-0 w-3 h-3"},null,-1),Ue={class:"truncate text-xs text-[#999] mx-1"},Ee={class:"flex-shrink-0 ml-auto"},He={key:0,class:"text-xs font-bold text-black flex-center-bw min-w-fit"},je=t("div",{class:"gray-ball font-normal mr-0.5"},[t("img",{class:"w-4 h-4",src:_e})],-1),Ke={class:""},Oe={key:1,class:"flex text-xs font-bold text-black min-w-fit"},Xe=t("div",{class:"mr-1 gray-ball"},[t("img",{class:"w-4 h-4",src:me})],-1),Ye=t("div",{class:"flex items-center h-2.5"},null,-1),Qe=G({props:{shop:null,goods:null},emits:["handleTo","click"],setup(e,{emit:g}){const h=e,o=d(0),p=async()=>{var f;o.value=((f=h.shop)==null?void 0:f.discountRatio)||0};return ee(()=>{p()}),(f,v)=>{var x,T;const s=q("van-rate"),y=ne("lazy");return l(),n(V,null,[t("div",{class:"rounded bg-white p-2.5",onClick:v[1]||(v[1]=r=>g("click"))},[t("section",Pe,[t("div",Re,[t("div",Ce,[H(t("img",Ie,null,512),[[y,e.shop.logo||w(O)("images/goods/defaultImg.png")]]),e.shop.type?(l(),N(fe,{key:0,type:e.shop.type},null,8,["type"])):R("",!0)]),t("div",Le,[t("div",Fe,[t("div",Ae,_(e.shop.storeName),1),t("div",Be,[b(ge,{tag:f.$t("common.rebate"),ratio:e.shop.discountRatio||0},null,8,["tag","ratio"])])]),t("div",Ne,[t("span",Ve,_(f.$t("mall.15th sale",{salesVolume:e.shop.volume15||0})),1),b(s,{class:"flex-shrink-0",readonly:"","allow-half":"",modelValue:e.shop.star,"onUpdate:modelValue":v[0]||(v[0]=r=>e.shop.star=r),size:16,gutter:"0",color:"#FEA021"},null,8,["modelValue"]),t("span",ze,_(e.shop.star),1)]),t("div",De,[(x=e.shop)!=null&&x.ranking?(l(),N(Se,{key:0,class:"shrink-0","rank-num":(T=e.shop)==null?void 0:T.ranking},null,8,["rank-num"])):R("",!0),e.shop.metakeyFlag?(l(),N(ye,{key:1})):R("",!0),b(xe,{type:e.shop.buyFlag?1:e.shop.watchFlag?2:e.shop.followFlag?3:0},null,8,["type"])]),e.goods&&e.goods.length>0?(l(),n("section",Ge,[(l(!0),n(V,null,U(e.goods,r=>(l(),n("div",{class:"flex items-center",key:r.id,onClick:ie(()=>g("handleTo",`/goodsDetail?id=${r.id}`),["stop","prevent"])},[qe,t("span",Ue,_(r.goodsName),1),t("div",Ee,[r.payType===2||r.payType===3?(l(),n("div",He,[je,t("div",Ke,_(r.cardPrice)+_(r.symbol),1)])):(l(),n("div",Oe,[Xe,t("div",null,_(r.price)+"Mcoin",1)]))])],8,Me))),128))])):R("",!0)])])])]),Ye],64)}}}),Je=e=>(se("data-v-56c7ba01"),e=e(),ae(),e),We={key:0,class:"relative lieanr-bg rounded-xl mb-2.5"},Ze=Je(()=>t("img",{src:we,class:"w-full h-full"},null,-1)),et=[Ze],tt={class:"pt-[45px] px-4"},st=["onClick"],at=["src"],lt={class:"absolute bottom-0 left-0 z-10 w-full flex-center bg-black-linear"},ot={class:"text-white text-sm font-bold text-center h-[20px] line-clamp-1 mt-1"},nt=G({props:{searchParam:{default:()=>({keyword:null,sortType:null,orderBy:null})},sortType:null,shopPath:{default:"/category"},isSearchPage:{type:Boolean,default:!1},activeInfo:null},emits:["handleTo"],setup(e,{expose:g,emit:h}){const o=e,p=d([]),f=d(!1),v=d(!1),s=d(0),y=d(10),x=d(0),T=d([]),r=d(0),I=async()=>{f.value=!0,s.value+=1,await C(),f.value=!1},C=async()=>{var m,A,z,D;const a=await J({page:s.value,size:y.value,...o.searchParam,sortType:o.sortType});if(f.value=!1,!a.success){v.value=!0;return}if(!a.data||!a.total){v.value=!0;return}if(x.value=a.total,T.value=a.data||[],s.value===2&&((m=o.activeInfo)!=null&&m.id)){const i={activeType:1,activePath:(A=o.activeInfo)==null?void 0:A.url,activeImg:((z=o.activeInfo)==null?void 0:z.activityListImgs)||null,activeImgGrid:((D=o.activeInfo)==null?void 0:D.activityWaterfallImgs)||null,...o.activeInfo};r.value+=1,T.value.unshift(i)}p.value=s.value===1?T.value:p.value.concat(T.value),p.value.length-r.value>=x.value&&(v.value=!0)},S=d([]),L=async()=>{const{success:a,data:m}=await J({page:1,size:12,sortType:null,orderBy:1,boutiqueFlag:!0});a&&(S.value=m||[])},F=async()=>{p.value=[],s.value=0,x.value=0,r.value=0,v.value=!1,await I()};return ee(()=>{L()}),g({handleSearch:F,list:p}),(a,m)=>{const A=q("van-swipe-item"),z=q("van-swipe"),D=q("VanList");return l(),n("div",null,[e.isSearchPage?R("",!0):(l(),n("div",We,[t("div",{class:"w-[49px] h-[21px] absolute top-[15px] right-[9px]",onClick:m[0]||(m[0]=i=>h("handleTo","/boutique-shop"))},et),t("div",tt,[b(z,{loop:!1,width:"95","show-indicators":!1},{default:E(()=>[(l(!0),n(V,null,U(S.value,i=>(l(),N(A,{key:i.id,class:""},{default:E(()=>[t("div",{onClick:M=>{var B;return h("handleTo",`/category?deliveryType=1&shopId=${(B=i.stores)==null?void 0:B.id}`)},class:"mr-[10px] rounded-xl border-[2px] w-[89px] h-[89px] border-white overflow-hidden relative"},[t("img",{class:"flex-shrink-0 object-cover w-full h-full aspect-square",src:i&&i.stores&&i.stores.logo||w(O)("images/activity/boutique/active_empty.png")},null,8,at),t("div",lt,[t("span",ot,_(i.stores.storeName||a.$t("avtivity.check")),1)])],8,st)]),_:2},1024))),128))]),_:1})])])),b(D,{loading:f.value,"onUpdate:loading":m[3]||(m[3]=i=>f.value=i),finished:v.value,"finished-text":a.$t("common.noMore"),"loading-text":a.$t("common.loading"),onLoad:I},{default:E(()=>[(l(!0),n(V,null,U(p.value,(i,M)=>(l(),n(V,{key:M},[i!=null&&i.activeType?(l(),N(ve,{key:0,info:i,onHandleTo:m[1]||(m[1]=B=>h("handleTo",B)),class:"mb-2.5"},null,8,["info"])):(l(),N(Qe,{key:1,shop:i.stores,goods:i.goods,onClick:()=>h("handleTo",`${e.shopPath}?shopId=${i.stores.id}&deliveryType=1`),onHandleTo:m[2]||(m[2]=B=>h("handleTo",B))},null,8,["shop","goods","onClick"]))],64))),128))]),_:1},8,["loading","finished","finished-text","loading-text"])])}}}),it=te(nt,[["__scopeId","data-v-56c7ba01"]]),ct={class:"flex items-center gap-[8px] font-normal overflow-x-scroll"},rt=["onClick"],W=G({props:{sortType:null,listActive:null},emits:["change"],setup(e,{emit:g}){const h=e,{t:o}=le(),p=j(()=>h.listActive?[{text:o("mall.Comprehensive recommendation"),value:null},{text:o("mall.Recently popular"),value:3},{text:o("mall.star"),value:2},{text:o("mall.saleNum"),value:1},{text:o("evaluate.Good reviews"),value:4}]:[{text:o("mall.Comprehensive recommendation"),value:null},{text:o("mall.Recently popular"),value:3},{text:o("goods.Selected-Optimal Priority"),value:5},{text:o("mall.saleNum"),value:1}]),f=j(()=>p.value.find(v=>v.value===h.sortType).value);return(v,s)=>(l(),n("div",ct,[(l(!0),n(V,null,U(w(p),y=>(l(),n("div",{key:y.value,onClick:x=>g("change",y),class:K(["px-2 py-1 text-black/80 bg-[#F3F3F3] rounded-md flex-shrink-0",{"font-bold text-black":y.value===w(f)}])},_(y.text),11,rt))),128))]))}}),ut=""+new URL("../images/wave-BS6nzmaQ.png",import.meta.url).href,dt=""+new URL("../images/list-icon-3aw8mu4E.svg",import.meta.url).href,vt=""+new URL("../images/grid-icon-Bf3eB47x.svg",import.meta.url).href,ht={class:"flex flex-1 items-center pt-2 pb-3.5 pr-4 font-light text-black-600"},mt={class:"flex items-center gap-6 text-base text-black/60"},ft=["onClick"],pt={key:0,src:ut,class:"absolute bottom-0 w-6 h-auto -translate-x-1/2 left-1/2"},gt={key:0,class:"w-6 h-6",src:dt},yt={key:1,class:"w-5 h-5",src:vt},Z=G({props:{listActived:null,viewFormat:null,isSearchPage:{type:Boolean}},emits:["changeActive","changeView"],setup(e,{emit:g}){const h=e,{t:o}=le(),p=j(()=>h.isSearchPage?[{id:0,name:o("mall.Good stuff")},{id:1,name:o("mall.Good shop")}]:[{id:1,name:o("mall.Good shop")},{id:0,name:o("mall.Good stuff")}]);return(f,v)=>(l(),n("div",ht,[t("div",mt,[(l(!0),n(V,null,U(w(p),s=>(l(),n("div",{class:K([{"active-tab text-xl text-black font-bold relative":e.listActived==s.id},"flex items-center pb-1"]),onClick:y=>g("changeActive",s.id),key:s.id},[e.listActived==s.id?(l(),n("img",pt)):R("",!0),ce(" "+_(s.name),1)],10,ft))),128))]),e.listActived==0?(l(),n("div",{key:0,class:"ml-auto",onClick:v[0]||(v[0]=s=>g("changeView"))},[e.viewFormat==0?(l(),n("img",gt)):(l(),n("img",yt))])):R("",!0)]))}}),oe=e=>(se("data-v-185bd2fe"),e=e(),ae(),e),xt={class:"text-white bg-[#f8f8f8] rounded-t-xl"},wt=oe(()=>t("div",{class:"h-2.5"},null,-1)),kt={class:"text-white bg-[#f8f8f8] px-2.5"},_t=oe(()=>t("div",{class:"h-2.5"},null,-1)),bt={class:"rounded-b-lg min-h-[60vh]"},Tt=G({props:{isSearchPage:{type:Boolean,default:!1},mode:{default:"vant"},activeInfo:null},setup(e,{expose:g}){const h=e,{scrollStore:o}=pe(),p=re(),f=X(it),v=X(he),s=d(h.isSearchPage?0:1),y=c=>{s.value=c,D(),s.value==0?a.sortType=F.value:s.value==1&&(a.sortType=L.value),(a.sortType===2||a.sortType===5||a.sortType===4)&&(s.value==0?(a.sortType=S.value,F.value=S.value):s.value==1&&(a.sortType=C.value,L.value=C.value),setTimeout(()=>{i()}))},x=d(0),T=()=>{x.value=1-x.value},r=d(null),I=d(null),C=d(null),S=d(3),L=d(C.value),F=d(S.value),a=ue({keyword:"",sortType:C.value,orderBy:1,classId:null});h.isSearchPage&&(a.sortType=S.value);const m=d(null),A=async c=>{a.sortType!==c.value&&(a.sortType=c.value,s.value==0?F.value=c.value:s.value==1&&(L.value=c.value),setTimeout(()=>{z(),i()}))},z=()=>{const c=document.getElementById("fm-page"),P=c.scrollY||c.scrollTop;let k=m.value.offsetParent,u=0;if(k.nodeName.toLowerCase()==="body")u+=m.value.offsetTop;else for(;k;)u+=k.offsetTop,k=k.offsetParent;P>u&&(o.setMallScroll("goods",u),o.setMallScroll("shop",u),c.scrollTo({top:u,behavior:"smooth"}))},D=()=>{const c=document.getElementById("fm-page"),P=c.scrollY||c.scrollTop;let k=s.value===1?"goods":"shop",u=s.value===1?"shop":"goods";o.setMallScroll(k,P);const $=o.getScroll(u)||0;c.scrollTo({top:$})},i=async()=>{var c,P,k,u,$;if(await I.value.handleSearch(),a.sortType!==5&&await r.value.handleSearch(),h.isSearchPage&&((c=r.value.list)==null?void 0:c.length)<=0&&s.value===1){y(0);return}(((P=I.value.list)==null?void 0:P.length)<=0&&((k=r.value.list)==null?void 0:k.length)>0&&s.value===0||((u=I.value.list)==null?void 0:u.length)>0&&(($=r.value.list)==null?void 0:$.length)<=0&&s.value===1)&&y(s.value)},M=c=>{p.push(c)};return g({setParam:({keyword:c,classId:P})=>{a.keyword=c||null,a.classId=P||null,i()},onRefresh:async()=>{a.keyword="",L.value=C.value,F.value=S.value,s.value==0?a.sortType=S.value:s.value==1&&(a.sortType=C.value),a.orderBy=1,a.classId=null,o.setMallScroll("goods",0),o.setMallScroll("shop",0),setTimeout(async()=>{await i()})}}),(c,P)=>{const k=q("van-sticky");return l(),n("div",{ref:(u,$)=>{$.listPageRef=u,m.value=u},class:"RecommendsPage"},[e.mode==="vant"?(l(),N(k,{key:0,"offset-top":e.isSearchPage?90:0},{default:E(()=>[t("div",xt,[b(Z,{isSearchPage:e.isSearchPage,listActived:s.value,viewFormat:x.value,onChangeActive:y,onChangeView:T},null,8,["isSearchPage","listActived","viewFormat"]),b(W,{sortType:w(a).sortType,listActive:s.value,onChange:A},null,8,["sortType","listActive"]),wt])]),_:1},8,["offset-top"])):e.mode==="div"?(l(),n("div",{key:1,class:"sticky__wrapper",style:de(e.isSearchPage?"top: 90px":"top: 0")},[t("div",kt,[b(Z,{isSearchPage:e.isSearchPage,listActived:s.value,viewFormat:x.value,onChangeActive:y,onChangeView:T},null,8,["isSearchPage","listActived","viewFormat"]),b(W,{sortType:w(a).sortType,listActive:s.value,onChange:A},null,8,["sortType","listActive"]),_t])],4)):R("",!0),t("div",{class:K(["relative z-10 pb-2 bg-[#f8f8f8] hardware-accelerated",{"min-h-[calc(100vh-126px)] pb-8 overflow-y-hidden":e.isSearchPage}])},[t("div",bt,[H(b(w(v),{viewFormat:x.value,searchParam:w(a),sortType:F.value,onHandleTo:M,ref:(u,$)=>{$.goodListRef=u,I.value=u},isSearchPage:e.isSearchPage,"active-info":e.activeInfo},null,8,["viewFormat","searchParam","sortType","isSearchPage","active-info"]),[[Y,s.value==0]]),H(b(w(f),{searchParam:w(a),sortType:L.value,onHandleTo:M,ref:(u,$)=>{$.shopListRef=u,r.value=u},isSearchPage:e.isSearchPage,"active-info":e.activeInfo},null,8,["searchParam","sortType","isSearchPage","active-info"]),[[Y,s.value==1]])])],2)],512)}}}),Nt=te(Tt,[["__scopeId","data-v-185bd2fe"]]);export{Nt as R};
