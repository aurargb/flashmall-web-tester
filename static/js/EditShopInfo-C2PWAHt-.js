import{_ as we,y as ye,r as w,z as je,E as b,K as be,G as U,N as m,H as a,Q as s,F as A,J as xe,R as N,a0 as V,a2 as re,I as _e,O as r,$ as X,w as Oe,be as B,x as ue,D as Qe,P as n,T as u,Y as Ge,Z as Je}from"./vendor-Ba70TIw4.js";import{U as Ke}from"./UpgradeStorePop-B-befPsW.js";import{C as We}from"./ChangeRegion-Dx4d_vn-.js";import{B as Ye}from"./BackIcon-DkqwcD_b.js";import{u as Ze,e as Xe,v as et,aj as ge,am as tt,a8 as J,a9 as K,a3 as W,q as Y,bu as at,bv as ot,T as lt}from"./index-DGR86ePT.js";import{u as Z}from"./upload-28Y_C7H9.js";import{q as st}from"./category-DuYiFafX.js";import{a as nt}from"./shop-CeqcS6K2.js";import{c as ut}from"./user-ruPHOakz.js";import"./BoutiqueLable-RObK-asU.js";import"./ChangeRegionPop-DLWl0zey.js";const rt="/static/images/defaultImg-DQiyvs75.png",ee="/static/images/info-arrow-CiFW705A.svg",it={class:"px-5"},dt={class:"mt-[18px] font-semibold text-base text-center"},ct={class:""},pt=["onClick"],vt={key:0,class:"text-white"},mt={class:"pt-8 pb-4 flex-center-bw"},ht=ye({props:{show:{type:Boolean,default:!1},menus:{default:()=>[]},value:{default:()=>[]}},emits:["close","onChange"],setup(k,{emit:R}){const M=k,h=w([]);je(()=>M.show,y=>{y&&(h.value=M.value??[])});const te=y=>{h.value.includes(y)?h.value=h.value.filter(x=>x!==y):h.value.push(y)},H=()=>{h.value=[]},p=()=>{R("onChange",h.value),R("close")};return(y,x)=>{const L=b("VanButton"),_=b("VanPopup");return U(),be(_,{teleport:"body",show:k.show,"onUpdate:show":x[0]||(x[0]=d=>X(show)?show.value=d:null),round:"",position:"bottom",closeable:"",style:{minHeight:"40%"},"close-on-click-overlay":"",onClickOverlay:x[1]||(x[1]=d=>R("close")),onClickCloseIcon:x[2]||(x[2]=d=>R("close"))},{default:m(()=>[a("div",it,[a("div",dt,s(y.$t("shop.Please select the sort menu")),1),a("div",ct,[(U(!0),A(_e,null,xe(k.menus,(d,z)=>(U(),A("div",{onClick:E=>te(d.value),key:d.value,class:N(["py-4 flex items-center border-b border-solid border-[#F6F6F5] text-sm",{"border-none":z===k.menus.length-1}])},[a("div",{class:N(["w-5 h-5 mr-2 border border-solid rounded-full flex-center",{"bg-[#FEA021] border-[#FEA021]":h.value.includes(d.value),"border-[#c8c9cc]":!h.value.includes(d.value)}])},[h.value.includes(d.value)?(U(),A("div",vt,s(h.value.findIndex(E=>E===d.value)+1),1)):re("",!0)],2),V(" "+s(d.text),1)],10,pt))),128))]),a("div",mt,[r(L,{class:"border-orange bg-[#fff] rounded-3xl text-[#FEA021] w-[150px] h-[40px]",onClick:H},{default:m(()=>[V(s(y.$t("common.reset")),1)]),_:1}),r(L,{class:"btn-orange rounded-3xl text-white w-[150px] h-[40px]",onClick:p},{default:m(()=>[V(s(y.$t("common.confirm")),1)]),_:1})])])]),_:1},8,["show"])}}}),ft=we(ht,[["__scopeId","data-v-3d9da0d8"]]),P=k=>(Ge("data-v-657b40f2"),k=k(),Je(),k),gt={class:"pb-4 text-sm text-default bg-[#f9f7f4]"},wt={class:"sticky top-0 z-50 gap-2 px-3 pt-2 flex-start bg-[#f9f7f4]"},yt={class:"bg-white px-2.5 py-4 mt-4"},bt={class:"flex-center-bw"},xt={class:"key"},_t=P(()=>a("div",{class:"w-[50px] h-[50px] rounded-xl bg-gray1 text-center text-lg text-[#d9d9d9] font-bold"},[a("img",{src:rt})],-1)),$t={class:"mt-4 flex-center-bw"},St={class:"key"},Ct={class:"mt-4 flex-center-bw"},Vt={class:"key"},kt={class:"value"},It={class:"mt-4 flex-center-bw"},Ft={class:"key"},Ut={class:"value"},Tt={class:"bg-white px-2.5 py-4 mt-4"},Lt={class:"flex-center-bw"},At={class:"key"},Rt=V("%"),Et={class:"mt-4 flex-center-bw"},Bt={class:"key"},Nt={class:"value"},zt={class:"mt-4 flex-center-bw"},qt={class:"key"},Dt={class:"gap-1 value flex-start van-cell"},Pt=P(()=>a("img",{src:ee,class:"w-[6px]",alt:""},null,-1)),Mt={class:"mt-4 flex-center-bw"},Ht={class:"key whitespace-nowrap"},jt={class:"bg-white px-2.5 py-4 mt-4"},Ot={class:"flex-center-bw"},Qt={class:"key"},Gt={class:"gap-1 value van-cell flex-start"},Jt=P(()=>a("img",{src:ee,class:"w-[6px]",alt:""},null,-1)),Kt={class:"mt-4 flex-center-bw"},Wt={class:"key"},Yt={class:"mt-4 flex-center-bw"},Zt={class:"key"},Xt={class:"gap-1 value flex-start van-cell"},ea=P(()=>a("img",{src:ee,class:"w-[6px]",alt:""},null,-1)),ta={class:"mt-4 flex-center-bw"},aa={class:"key"},oa=P(()=>a("img",{src:ee,class:"w-[6px]",alt:""},null,-1)),la={class:"mt-4 flex-center-bw"},sa={class:"key"},na={key:0,class:"flex-center gap-4 mt-2 px-2.5"},ua=ye({setup(k){const{getCurrentStoreId:R,getCurrentAccount:M}=Ze(),{regionStore:h,accountStore:te}=Xe(),{currentLocale:H}=et(),{t:p,messages:y}=Oe(),x=y.value[H.value][h.country==="CN"?"areaList":"jpAreaList"],L=w(!1),_=w(""),d=w(""),[z,E]=B(!1),[ae,oe]=B(!1),[le,se]=B(!1),l=w({logo:null,storeName:null,openingHours:null,discountRatio:null,classId:1,contact:null,location:null,scenery:null,qrCode:null,shareImg:null,contactAddress:null,type:null}),$=w([]),ie=w([]),$e=async()=>{const e=await st();e.success&&(ie.value=(e.data||[]).map(t=>({value:t.id,text:t[`${nt[H.value]}Name`]})))},Se=ue(()=>ge(l.value.merchant)===ge(M())&&(l.value.upgradableType&&l.value.upgradableType<l.value.type||l.value.type===0&&l.value.upgradableType>0)),[Ce,ne]=B(!1),[de,ce]=B(!1),Ve=async e=>{ce(!0);const{success:t}=await tt(e);ce(!1),t&&(ne(!1),me())},[q,pe]=B(!1),ve=ue(()=>{var e,t;return(e=l.value)!=null&&e.type?[{text:p("mall.mallhome"),value:1},{text:p(`common.shop_type_${(t=l.value)==null?void 0:t.type}`),value:2},{text:p("mall.tabBar[3].text"),value:4},{text:p("mall.tabBar[2].text"),value:3}]:[{text:p("mall.mallhome"),value:1},{text:p("mall.tabBar[3].text"),value:4},{text:p("mall.tabBar[2].text"),value:3}]}),f=w([]),ke=e=>{f.value=e},Ie=ue(()=>{var t;let e=[];try{for(let i=0;i<f.value.length;i++){const v=f.value[i],c=(t=ve.value.find(T=>T.value===v))==null?void 0:t.text;c&&e.push(c)}}catch{e=[]}return e}),Fe=e=>e>80?80:e,I=w(!1),S=w([]),g=w([]),C=w([]),j=()=>{u.loading({message:p("common.uploading"),forbidClick:!0,duration:0})},Ue=()=>(I.value=!0,j(),!0),Te=async e=>{const t=J(e.file);if(!t.valid)return S.value.length-=1,u(t.tips);const i=K(e.file);if(!i.valid)return S.value.length-=1,u(i.tips);const v=await W(e,"shopLogo"),c=await Z(v);if(I.value=!1,u.clear(),!c.success)return u("图片上传失败"),S.value.length-=1;S.value[S.value.length-1]={url:Y.imgUrl+c.data}},Le=()=>(I.value=!0,j(),!0),Ae=async e=>{const t=J(e.file);if(!t.valid)return g.value.length-=1,u(t.tips);const i=K(e.file);if(!i.valid)return g.value.length-=1,u(i.tips);const v=await W(e,"shopScenery"),c=await Z(v);if(I.value=!1,u.clear(),!c.success)return u("图片上传失败"),g.value.length-=1;g.value[g.value.length-1]={url:Y.imgUrl+c.data}},Re=()=>(I.value=!0,j(),!0),Ee=async e=>{const t=J(e.file);if(!t.valid)return C.value.length-=1,u(t.tips);const i=K(e.file);if(!i.valid)return C.value.length-=1,u(i.tips);const v=await W(e,"shopScenery"),c=await Z(v);if(I.value=!1,u.clear(),!c.success)return u("图片上传失败"),C.value.length-=1;C.value[C.value.length-1]={url:Y.imgUrl+c.data}},Be=()=>(I.value=!0,j(),!0),Ne=async e=>{const t=J(e.file);if(!t.valid)return $.value.length-=1,u(t.tips);const i=K(e.file);if(!i.valid)return $.value.length-=1,u(i.tips);const v=await W(e,"shopScenery"),c=await Z(v);if(I.value=!1,u.clear(),!c.success)return u("图片上传失败"),$.value.length-=1;$.value[$.value.length-1]={url:Y.imgUrl+c.data}},ze=e=>{if(!e[0].code||!e[1].code)return u(p("common.choose address"));l.value.location=[...new Set(e.map(t=>t.name))].join(""),E(!1)},qe=e=>{_.value=e,oe(!1)},De=e=>{d.value=e,se(!1)},Pe=async()=>{if(L.value||I.value)return;if(!S.value.length)return u(p("shop.emptyLogo"));if(!l.value.storeName)return u(p("shop.emptyName"));if(!_.value)return u(p("shop.emptyOpenTime"));if(!d.value)return u(p("shop.emptyEndTime"));if(!l.value.discountRatio||l.value.discountRatio<=0)return u(p("shop.emptyRadio"));if(!l.value.classId)return u(p("shop.emptyClass"));if(!g.value||g.value.length<=0)return u(p("shop.enterShopPhoto"));if(!f.value||f.value.length<=0)return u(p("shop.select menu configuration"));L.value=!0,l.value.logo=S.value[0].url,l.value.scenery=g.value.length?g.value.map(t=>t.url).join(","):"",l.value.qrCode=C.value.length?C.value[0].url:"",l.value.shareImg=$.value.length?$.value[0].url:"",l.value.openingHours=`${_.value} - ${d.value}`;const e=await at({...l.value,menus:f.value.join(",")??""});L.value=!1,e.success&&(ut(),ot.back())},Me=async()=>{var t,i,v,c,T,D,O,Q,G;const e=await lt((t=await R())==null?void 0:t.merchant);if(!(!e.success||!e.data)){if(l.value=e.data,e.data.openingHours){const F=e.data.openingHours.split("-");_.value=F[0].trim(),d.value=F[1].trim()}(i=e.data)!=null&&i.logo&&(S.value[0]={url:e.data.logo}),(v=e.data)!=null&&v.scenery&&(g.value=e.data.scenery?(c=e.data.scenery.split(","))==null?void 0:c.map(F=>({url:F})):[]),(T=e.data)!=null&&T.qrCode&&(C.value[0]={url:e.data.qrCode}),(D=e.data)!=null&&D.shareImg&&($.value[0]={url:e.data.shareImg}),(O=e.data)!=null&&O.menus?(f.value=(G=(Q=e.data)==null?void 0:Q.menus)==null?void 0:G.split(","),f.value=f.value.map(F=>+F)):e.data.type>0?f.value=[1,2,3,4]:f.value=[1,3,4]}},me=()=>{$e(),Me()};return Qe(()=>{me()}),(e,t)=>{var he,fe;const i=b("van-uploader"),v=b("VanField"),c=b("van-datetime-picker"),T=b("van-popup"),D=b("van-field"),O=b("van-dropdown-item"),Q=b("van-dropdown-menu"),G=b("van-area"),F=b("VanButton");return U(),A("div",gt,[a("div",wt,[r(Ye),a("div",null,s(e.$t("order.shopInfo")),1),r(We,{showIcon:!0,showDownIcon:!1,class:"ml-auto bg-gray1 px-2 rounded-[20px] border-2 border-solid border-white",style:{"box-shadow":"0px 0px 15px 0px rgba(51, 47, 42, 0.3) inset"}})]),a("div",yt,[a("div",bt,[a("div",xt,s(e.$t("shop.shopLogo")),1),r(i,{modelValue:S.value,"onUpdate:modelValue":t[0]||(t[0]=o=>S.value=o),accept:"image/*","max-count":1,"preview-size":"50","before-read":Ue,afterRead:Te},{default:m(()=>[_t]),_:1},8,["modelValue"])]),a("div",$t,[a("div",St,s(e.$t("shop.shopName")),1),r(v,{class:"value","input-align":"right",maxlength:12,modelValue:l.value.storeName,"onUpdate:modelValue":t[1]||(t[1]=o=>l.value.storeName=o),placeholder:e.$t("shop.pleaseInput")},null,8,["modelValue","placeholder"])]),a("div",Ct,[a("div",Vt,s(e.$t("shop.openTime")),1),a("div",kt,[a("div",{class:N(["px-[16px] py-[5px] text-right text-[#c8c9cc]",{"active-text":_.value}]),onClick:t[2]||(t[2]=o=>n(oe)(!0))},s(_.value||e.$t("shop.pleaseSelect")),3)]),r(T,{round:"",show:n(ae),"onUpdate:show":t[5]||(t[5]=o=>X(ae)?ae.value=o:null),position:"bottom",style:{height:"40%"}},{default:m(()=>[r(c,{modelValue:_.value,"onUpdate:modelValue":t[3]||(t[3]=o=>_.value=o),type:"time",title:e.$t("shop.openTime"),"min-hour":0,"max-hour":24,onConfirm:qe,onCancel:t[4]||(t[4]=o=>n(oe)(!1))},null,8,["modelValue","title"])]),_:1},8,["show"])]),a("div",It,[a("div",Ft,s(e.$t("shop.endTime")),1),a("div",Ut,[a("div",{class:N(["px-[16px] py-[5px] text-right text-[#c8c9cc]",{"active-text":d.value}]),onClick:t[6]||(t[6]=o=>n(se)(!0))},s(d.value||e.$t("shop.pleaseSelect")),3)]),r(T,{round:"",show:n(le),"onUpdate:show":t[9]||(t[9]=o=>X(le)?le.value=o:null),position:"bottom",style:{height:"40%"}},{default:m(()=>[r(c,{modelValue:d.value,"onUpdate:modelValue":t[7]||(t[7]=o=>d.value=o),type:"time",title:e.$t("shop.endTime"),"min-hour":0,"max-hour":24,onConfirm:De,onCancel:t[8]||(t[8]=o=>n(se)(!1))},null,8,["modelValue","title"])]),_:1},8,["show"])])]),a("div",Tt,[a("div",Lt,[a("div",At,s(e.$t("shop.shopRateSetting")),1),r(D,{class:"value","input-align":"right",modelValue:l.value.discountRatio,"onUpdate:modelValue":t[10]||(t[10]=o=>l.value.discountRatio=o),type:"digit",placeholder:e.$t("shop.pleaseInput")+"1-80",formatter:Fe},{"right-icon":m(()=>[Rt]),_:1},8,["modelValue","placeholder"])]),a("div",Et,[a("div",Bt,s(e.$t("shop.shopCategory")),1),a("div",Nt,[r(D,{"input-align":"right",autocomplete:"off"},{input:m(()=>[r(Q,{"active-color":"#FEA021"},{default:m(()=>[r(O,{modelValue:l.value.classId,"onUpdate:modelValue":t[11]||(t[11]=o=>l.value.classId=o),options:ie.value},null,8,["modelValue","options"])]),_:1})]),_:1})])]),a("div",zt,[a("div",qt,s(e.$t("shop.shopPhoto")),1),r(i,{modelValue:g.value,"onUpdate:modelValue":t[12]||(t[12]=o=>g.value=o),accept:"image/*","max-count":3,"preview-size":"50","before-read":Le,afterRead:Ae},{default:m(()=>[a("div",Dt,[V(s(e.$t("shop.upload"))+" ",1),Pt])]),_:1},8,["modelValue"])]),a("div",Mt,[a("div",Ht,s(e.$t("shop.Menu Management")),1),a("div",{class:N(["flex-end value px-[16px] flex items-center gap-2 overflow-x-hidden",{"text-primary":n(q)}]),onClick:t[13]||(t[13]=o=>n(pe)(!n(q)))},[(U(!0),A(_e,null,xe(n(Ie),(o,He)=>(U(),A("div",{key:He,class:"text-sm px-1.5 leading-6 bg-[#FFF0DA] rounded whitespace-nowrap overflow-x-scroll"},s(o),1))),128)),a("div",{class:N({triangle_down:!n(q),triangle_up:n(q)})},null,2)],2)])]),a("div",jt,[a("div",Ot,[a("div",Qt,s(e.$t("shop.shop share img")),1),r(i,{modelValue:$.value,"onUpdate:modelValue":t[14]||(t[14]=o=>$.value=o),accept:"image/*","max-count":1,"preview-size":"50","before-read":Be,afterRead:Ne},{default:m(()=>[a("div",Gt,[V(s(e.$t("shop.upload"))+" ",1),Jt])]),_:1},8,["modelValue"])]),a("div",Kt,[a("div",Wt,s(e.$t("shop.contact")),1),r(v,{class:"value","input-align":"right",modelValue:l.value.contact,"onUpdate:modelValue":t[15]||(t[15]=o=>l.value.contact=o),placeholder:e.$t("shop.pleaseInput")},null,8,["modelValue","placeholder"])]),a("div",Yt,[a("div",Zt,s(e.$t("shop.qrCode")),1),r(i,{modelValue:C.value,"onUpdate:modelValue":t[16]||(t[16]=o=>C.value=o),accept:"image/*","max-count":1,"preview-size":"50","before-read":Re,afterRead:Ee},{default:m(()=>[a("div",Xt,[V(s(e.$t("shop.upload"))+" ",1),ea])]),_:1},8,["modelValue"])]),a("div",null,[a("div",ta,[a("div",aa,s(e.$t("shop.shopAddress")),1),a("div",{class:"gap-1 value van-cell flex-end",onClick:t[17]||(t[17]=o=>n(E)(!0))},[V(s(e.$t("shop.edit"))+" ",1),oa]),r(T,{round:"",show:n(z),"onUpdate:show":t[19]||(t[19]=o=>X(z)?z.value=o:null),position:"bottom",style:{height:"40%"}},{default:m(()=>[r(G,{title:"","area-list":n(x),"columns-placeholder":[e.$t("shop.pleaseSelect"),e.$t("shop.pleaseSelect"),e.$t("shop.pleaseSelect")],"columns-num":"2",onConfirm:ze,onCancel:t[18]||(t[18]=o=>n(E)(!1))},null,8,["area-list","columns-placeholder"])]),_:1},8,["show"])]),r(v,{class:"rounded bg-[#f2f0ef] px-1 py-2 mt-2",readonly:"",modelValue:l.value.location,"onUpdate:modelValue":t[20]||(t[20]=o=>l.value.location=o),placeholder:e.$t("shop.pleaseSelect")},null,8,["modelValue","placeholder"])]),a("div",null,[a("div",la,[a("div",sa,s(e.$t("shop.shopSpecificAddress")),1)]),r(v,{class:"rounded bg-[#f2f0ef] px-1 py-2 mt-2",type:"textarea",rows:"2",modelValue:l.value.contactAddress,"onUpdate:modelValue":t[21]||(t[21]=o=>l.value.contactAddress=o),placeholder:e.$t("shop.pleaseInput")},null,8,["modelValue","placeholder"])])]),n(te).isOnlyView?re("",!0):(U(),A("div",na,[n(Se)?(U(),be(F,{key:0,class:"btn-orange btn-shadow min-w-[130px] block",loading:n(de),onClick:t[22]||(t[22]=o=>n(ne)(!0))},{default:m(()=>[V(s(e.$t("profile.Upgrade your store")),1)]),_:1},8,["loading"])):re("",!0),r(F,{class:"btn-orange btn-shadow min-w-[130px] block",loading:L.value,onClick:Pe},{default:m(()=>[V(s(e.$t("common.confirm")),1)]),_:1},8,["loading"])])),r(ft,{show:n(q),onClose:t[23]||(t[23]=o=>n(pe)(!1)),onOnChange:ke,menus:n(ve),value:f.value},null,8,["show","menus","value"]),r(Ke,{upgradeInfo:{type:(he=l.value)==null?void 0:he.type,upgradableType:(fe=l.value)==null?void 0:fe.upgradableType},show:n(Ce),onClose:t[24]||(t[24]=o=>n(ne)(!1)),onConfirm:Ve,loading:n(de)},null,8,["upgradeInfo","show","loading"])])}}}),ya=we(ua,[["__scopeId","data-v-657b40f2"]]);export{ya as default};
