import{_ as Z}from"./kefu-DRX49rvc.js";import{_ as K,y as N,F as B,G as u,H as a,R as d,Q as f,w as W,l as Y,a2 as ee,r as n,z as te,x as ae,D as oe,E as X,K as C,X as S,O as L,N as G,I as se,J as ne,Z as re,$ as le,T as J}from"./vendor-BlU_hoYl.js";import{B as ue}from"./BoutiqueGoodItemv2-YL31um0I.js";import{B as ie}from"./BackIcon-8hcEjDKb.js";import{a7 as de,X as ce,r as pe,a8 as ve,a9 as me}from"./index-Clz0Qna-.js";import{M as fe}from"./MallTabBar-CIYGM8Fg.js";import{b as ye}from"./mall-tuLNpwbe.js";import{_ as he}from"./DefaultPage-DQXPcwhv.js";import"./RatioBox-CfBlBgLi.js";import"./GoodsPrice-BNTIqb2J.js";import"./MCOIN-Bodfn-v1.js";import"./ShopMaskTips-CxJi-SfW.js";import"./goods-BVwS8oFG.js";const ge={class:"bg-origin5 w-full"},be={class:"bg-white rounded-t-[12px] flex items-center gap-3 text-sm text-gray-500 p-2.5 overflow-x-auto"},xe={class:"flex flex-col justify-between ml-1 h-3"},we=N({props:{orderBy:null},emits:["change"],setup(o,{emit:r}){const y=o,c=()=>{y.orderBy!==4&&y.orderBy!==5||y.orderBy===4?r("change",5):r("change",4)};return(p,t)=>(u(),B("div",ge,[a("div",be,[a("div",{class:d(["min-w-1/4 flex items-center justify-center rounded-[6px] bg-[#F4F4F4] whitespace-nowrap",["px-4 py-1 cursor-pointer",{"text-black font-medium":o.orderBy===1}]]),onClick:t[0]||(t[0]=v=>r("change",1))},f(p.$t("goods.comprehensive")),3),a("div",{class:d(["min-w-1/4 flex items-center justify-center rounded-[6px] bg-[#F4F4F4] whitespace-nowrap",["px-4 py-1 cursor-pointer",{"text-black font-medium":o.orderBy===2}]]),onClick:t[1]||(t[1]=v=>r("change",2))},f(p.$t("mall.saleNum")),3),a("div",{class:d(["min-w-1/4 flex items-center justify-center rounded-[6px] bg-[#F4F4F4] whitespace-nowrap",["px-4 py-1 cursor-pointer",{"text-black font-medium":o.orderBy===3}]]),onClick:t[2]||(t[2]=v=>r("change",3))},f(p.$t("flashSale.newGood")),3),a("div",{class:d(["min-w-1/4 flex items-center justify-center rounded-[6px] px-4 py-1 bg-[#F4F4F4] whitespace-nowrap",{"text-black font-medium":o.orderBy===4||o.orderBy===5}]),onClick:c},[a("span",null,f(p.$t("goods.price")),1),a("div",xe,[a("div",{class:d(["w-0 h-0 border-x-[4px] border-x-transparent border-b-[4px]",o.orderBy===5?"border-b-black":"border-b-gray-400"])},null,2),a("div",{class:d(["w-0 h-0 border-x-[4px] border-x-transparent border-t-[4px]",o.orderBy===4?"border-t-black":"border-t-gray-400"])},null,2)])],2)])]))}}),ke=K(we,[["__scopeId","data-v-3e699e18"]]),Be=o=>(re("data-v-607e6ed8"),o=o(),le(),o),_e={class:"sticky top-0 flex font-normal justify-center text-sm items-center h-[44px] px-2.5 z-50 bg-origin5"},$e={class:"absolute left-2.5 flex items-center gap-1 -translate-y-1/2 top-1/2"},Ie={key:0,class:"font-semibold"},Ce=Be(()=>a("img",{class:"w-5 h-5",src:Z},null,-1)),Te=[Ce],Fe={class:"overflow-hidden"},qe={class:"mall-header-bg mall-header-bg-box"},Se={class:"bg-white h-full"},Le=N({name:"BoutiqueGood"});function Ge(o){var A,M;const{t:r}=W(),y=Y(),c=ee(),p=de(),t=n(null),v=n(null);t.value=((A=c.query)==null?void 0:A.shopId)||null,v.value=((M=c.query)==null?void 0:M.shopId)||null,te(()=>{var e;return(e=c.query)==null?void 0:e.shopId},e=>{c.path==="/boutique-goods"&&(t.value=e||null,v.value!==t.value&&(v.value=t.value,s.value=null,t.value||T(),j()))},{deep:!0});const s=n(null),j=async()=>{if(!t.value)return;const e=await ce(t.value);!e.success||!e.data||(s.value=e.data,T())},h=n(1),O=e=>{h.value!==e&&(h.value=e,T())},g=n([]),b=n(!1),x=n(!1),w=n(0),z=n(10),_=n(0),i=n([]),P=ae(()=>{let e={sortType:3,orderBy:1};switch(h.value){case 1:break;case 2:e.sortType=1;break;case 3:e.sortType=4;break;case 4:e.sortType=2;break;case 5:e.sortType=2,e.orderBy=2;break}return e}),Q=async()=>{var l,$;let e={};if(t.value?e=await ye({page:w.value,size:z.value,status:1,merchant:(l=s.value)==null?void 0:l.merchant,type:s.value.type,...P.value}):e=await me({page:w.value,size:z.value,status:1,sortType:h.value,merchantAddress:($=s.value)==null?void 0:$.merchant}),!e.success||!e.data||!+e.total){x.value=!0,b.value=!1;return}_.value=e.total,i.value=e.data,t.value&&(i.value=i.value.map(I=>{var k;return{...I.goods,storeName:(k=I.stores)==null?void 0:k.storeName}})),g.value=w.value===1?i.value.length>0?i.value:[]:g.value.concat(i.value),g.value.length>=_.value&&(x.value=!0)},R=async()=>{!s.value&&t.value||(b.value=!0,w.value+=1,await Q(),setTimeout(()=>{b.value=!1},1e3))},{loadingToggle:V}=pe(),U=async e=>{if(e.stock===0&&e.goodsTypes!=2){J(r("order.Insufficient stock"));return}V(!0);const l=await ve(e.id);V(!1),l.success&&(J(r("cart.addTips")),p.getCartCount())},T=()=>{i.value=[],g.value=[],w.value=0,_.value=0,x.value=!1,R()},F=e=>{y.push(e)};return oe(async()=>{await j()}),(e,l)=>{var k,D,H,E;const $=X("van-sticky"),I=X("VanList");return u(),B("div",{class:d([{"safe-bottom-page":t.value},"overflow-y-auto bg-white"])},[a("section",_e,[a("div",$e,[L(ie,null,{default:G(()=>[a("span",null,f(e.$t("common.return")),1)]),_:1})]),(k=s.value)!=null&&k.type?(u(),B("div",Ie,f(e.$t("mall.Fine goods",{type:e.$t(`common.shop_type_${(D=s.value)==null?void 0:D.type}`)})),1)):S("",!0),(H=s.value)!=null&&H.merchant?(u(),B("div",{key:1,onClick:l[0]||(l[0]=m=>{var q;return F(`/shopInfo?address=${(q=s.value)==null?void 0:q.merchant}`)}),class:"absolute right-2.5 flex items-center gap-1 -translate-y-1/2 top-1/2"},Te)):S("",!0)]),a("div",Fe,[L($,{"offset-top":44},{default:G(()=>[a("div",qe,[L(ke,{orderBy:h.value,onChange:O},null,8,["orderBy"])])]),_:1}),a("div",Se,[x.value&&_.value===0?(u(),C(he,{key:0,title:e.$t("common.No products")},null,8,["title"])):(u(),C(I,{key:1,class:"pt-2 pb-5 px-2.5",loading:b.value,"onUpdate:loading":l[1]||(l[1]=m=>b.value=m),finished:x.value,"finished-text":e.$t("common.noMore"),"loading-text":e.$t("common.loading"),onLoad:R},{default:G(()=>[(u(!0),B(se,null,ne(g.value,m=>(u(),C(ue,{key:m.id,data:m,onClick:q=>F(`/goodsDetail?id=${m.id}`),onHandleAddCart:U,onHandleTo:F},null,8,["data","onClick"]))),128))]),_:1},8,["loading","finished","finished-text","loading-text"]))])]),t.value?(u(),C(fe,{key:0,shopId:t.value,shopType:(E=s.value)==null?void 0:E.type},null,8,["shopId","shopType"])):S("",!0)],2)}}const Ne=N({...Le,setup:Ge}),Pe=K(Ne,[["__scopeId","data-v-607e6ed8"]]);export{Pe as default};
